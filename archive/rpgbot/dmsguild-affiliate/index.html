<!DOCTYPE html public "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="LTR" lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <title>
   Dungeon Masters Guild -
  </title>
  <link href="../themes/dmg/favicon.ico" rel="icon" type="image/x-icon"/>
  <link href="../themes/dmg/favicon.ico" rel="shortcut icon" type="image/x-icon"/>
  <meta content="" name="description"/>
  <meta content="Dungeon Masters Guild, Wizards of the Coast, D&amp;D Adventurers League, Beadle &amp; Grimms, dnd pdf, D&amp;D pdf, download D&amp;D, wizards, wotc, tsr" name="keywords"/>
  <!-- <base href="https://www.dmsguild.com/"> -->
  <link href="https://www.dmsguild.com/rss_bestsellers.php" rel="alternate" title="Dungeon Masters Guild - Hottest Sellers [RSS]" type="application/rss+xml"/>
  <link href="https://www.dmsguild.com/rss.php" rel="alternate" title="Dungeon Masters Guild - Newest Titles [RSS]" type="application/rss+xml"/>
  <!-- include XAJAX -->
  <script charset="UTF-8" type="text/javascript">
   /* <![CDATA[ */
try { if (undefined == xajax.config) xajax.config = {}; } catch (e) { xajax = {}; xajax.config = {}; };
xajax.config.requestURI = "index.php";
xajax.config.statusMessages = false;
xajax.config.waitCursor = true;
xajax.config.version = "xajax 0.5";
xajax.config.legacy = false;
xajax.config.defaultMode = "asynchronous";
xajax.config.defaultMethod = "POST";
/* ]]> */
  </script>
  <script charset="UTF-8" src="../includes/ajax/xajax_js/xajax_core.js" type="text/javascript">
  </script>
  <script charset="UTF-8" type="text/javascript">
   /* <![CDATA[ */
window.setTimeout(
 function() {
  var scriptExists = false;
  try { if (xajax.isLoaded) scriptExists = true; }
  catch (e) {}
  if (!scriptExists) {
   alert("Error: the xajax Javascript component could not be included. Perhaps the URL is incorrect?\nURL: includes/ajax/xajax_js/xajax_core.js");
  }
 }, 2000);
/* ]]> */
  </script>
  <script charset="UTF-8" type="text/javascript">
   /* <![CDATA[ */
xajax_updatefav = function() { return xajax.request( { xjxfun: 'updatefav' }, { parameters: arguments } ); };
xajax_updatefav_interval = function() { return xajax.request( { xjxfun: 'updatefav_interval' }, { parameters: arguments } ); };
xajax_update_notifications = function() { return xajax.request( { xjxfun: 'update_notifications' }, { parameters: arguments } ); };
xajax_update_e_and_p = function() { return xajax.request( { xjxfun: 'update_e_and_p' }, { parameters: arguments } ); };
xajax_record_help_box_dismiss = function() { return xajax.request( { xjxfun: 'record_help_box_dismiss' }, { parameters: arguments } ); };
/* ]]> */
  </script>
  <!-- Non-minified files -->
  <link href="../default.css" rel="stylesheet" type="text/css">
   <link href="../web-font-stacks.css" rel="stylesheet" type="text/css">
    <link href="../includes/responsive.css" rel="stylesheet" type="text/css"/>
    <link href="../includes/javascript/fancybox/jquery.fancybox-1.3.4.css" rel="stylesheet" type="text/css"/>
    <link crossorigin="anonymous" href="https://cdnjs.cloudflare.com/ajax/libs/qtip2/3.0.3/jquery.qtip.min.css" integrity="sha512-ZsHJliDVkFVbmwvOjSlsp9NhO+8Lu+qDAg0JVuXGQmh9RBgf8z1IT6tytgYVl8b6hAHUNkuhbqLFuXOkZ0VNvw==" rel="stylesheet"/>
    <link href="../includes/javascript/iscroll/iscroll.css" rel="stylesheet" type="text/css"/>
    <link href="https://cdn.datatables.net/1.10.24/css/jquery.dataTables.min.css" rel="stylesheet" type="text/css"/>
    <link href="../includes/javascript/jqueryui/jquery.ui.autocomplete.custom.css" rel="stylesheet" type="text/css"/>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" type="text/javascript">
    </script>
    <script src="https://code.jquery.com/jquery-migrate-3.3.2.js">
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-tools/1.2.7/jquery.tools.min.js">
    </script>
    <script src="../includes/javascript/jquery/jquery.text-overflow.min.js" type="text/javascript">
    </script>
    <script src="../includes/javascript/jquery/jquery.dd.min.js" type="text/javascript">
    </script>
    <script src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js" type="text/javascript">
    </script>
    <script src="../includes/javascript/jquery/jquery.impromptu.min.js" type="text/javascript">
    </script>
    <script src="../includes/javascript/jquery/jquery.fileDownload.js" type="text/javascript">
    </script>
    <script src="../includes/javascript/jquery/jquery.cookie.js" type="text/javascript">
    </script>
    <script crossorigin="anonymous" integrity="sha512-BxJRFdTKV85fhFUw+olPr0B+UEzk8FTLxRB7dAdhoQ7SXmwMECj1I4BlSmZfeoSfy0OVA8xFLTDyObu3Nv1FoQ==" src="https://cdnjs.cloudflare.com/ajax/libs/qtip2/3.0.3/jquery.qtip.min.js">
    </script>
    <script crossorigin="anonymous" integrity="sha512-rCjfoab9CVKOH/w/T6GbBxnAH5Azhy4+q1EXW5XEURefHbIkRbQ++ZR+GBClo3/d3q583X/gO4FKmOFuhkKrdA==" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.13/jquery.mousewheel.min.js">
    </script>
    <script src="../includes/javascript/fancybox/jquery.fancybox-1.3.4.pack.js" type="text/javascript">
    </script>
    <script src="../includes/languages/english/javascript/jquery.validationEngine-locale.js" type="text/javascript">
    </script>
    <script src="../includes/javascript/jquery/jquery.validationEngine.js" type="text/javascript">
    </script>
    <script src="../includes/javascript/site-standard.js" type="text/javascript">
    </script>
    <script src="../includes/javascript/jquery/jquery.ellipsis.min.js" type="text/javascript">
    </script>
    <script src="../includes/javascript/jquery/jquery.appear.js" type="text/javascript">
    </script>
    <script src="../includes/javascript/jquery.obsCommon.js" type="text/javascript">
    </script>
    <script src="../includes/javascript/jquery.obsProducts.js" type="text/javascript">
    </script>
    <script src="../includes/javascript/jquery.obsPublisher.js" type="text/javascript">
    </script>
    <script src="../includes/javascript/jquery.obsBrowseAcs.js" type="text/javascript">
    </script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js" type="text/javascript">
    </script>
    <script src="../includes/javascript/jqueryui/jquery.ui.autocomplete.html.js" type="text/javascript">
    </script>
    <script type="text/javascript">
     jQuery.curCSS = function(element, prop, val) {
				return jQuery(element).css(prop, val);
			};

			// "a.browser is undefined"
			var matched, browser;

			jQuery.uaMatch = function( ua ) {
				ua = ua.toLowerCase();

				var match = /(chrome)[ \/]([\w.]+)/.exec( ua ) ||
					/(webkit)[ \/]([\w.]+)/.exec( ua ) ||
					/(opera)(?:.*version|)[ \/]([\w.]+)/.exec( ua ) ||
					/(msie)[\s?]([\w.]+)/.exec( ua ) ||       
					/(trident)(?:.*? rv:([\w.]+)|)/.exec( ua ) ||
					ua.indexOf("compatible") < 0 && /(mozilla)(?:.*? rv:([\w.]+)|)/.exec( ua ) ||
					[];

				return {
					browser: match[ 1 ] || "",
					version: match[ 2 ] || "0"
				};
			};

			matched = jQuery.uaMatch( navigator.userAgent );
			//IE 11+ fix (Trident) 
			matched.browser = matched.browser == 'trident' ? 'msie' : matched.browser;
			browser = {};

			if ( matched.browser ) {
				browser[ matched.browser ] = true;
				browser.version = matched.version;
			}

			// Chrome is Webkit, but Webkit is also Safari.
			if ( browser.chrome ) {
				browser.webkit = true;
			} else if ( browser.webkit ) {
				browser.safari = true;
			}

			jQuery.browser = browser;
    </script>
    <!-- Primary CSS declarations; in minified groups -->
    <link href="../themes/dtrpg/960_12_10_10.css" media="all" rel="stylesheet" type="text/css"/>
    <link href="https://www.dmsguild.com/includes/drivethru.css.php?v=1721394413&amp;site=" media="all" rel="stylesheet" type="text/css"/>
    <link href="../themes/dtrpg/images/edge/ui-lightness/jquery-ui-1.8.16.custom.css" media="screen" rel="stylesheet" type="text/css"/>
    <link href="../themes/dtrpg/dd.css" rel="stylesheet" type="text/css"/>
    <link href="../themes/dtrpg/smoothDivScroll.css" rel="Stylesheet" type="text/css"/>
    <!-- CSS: awesome font support -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"/>
    <!-- Primrary JS declarations; in minified groups -->
    <script src="../includes/javascript/spin.js" type="text/javascript">
    </script>
    <script src="../includes/javascript/jquery/jquery.spin.js" type="text/javascript">
    </script>
    <script src="../includes/javascript/jquery.obsPlugin.filteredComboBox.js" type="text/javascript">
    </script>
    <!-- Attach site-wide ready events -->
    <script type="text/javascript">
     addLoadEvent(function() {
	$("#filter_prices_form").validationEngine('attach', {
		autoHidePrompt: true, 
		autoHideDelay: 5000
	});
    $('.pwyw-input').on('focus',function() {
        $(this).val('');
        $(this).removeClass('pwyw-default-text');
    });
    $('.pwyw-input').closest("form").on('submit',function() {
        var pwyw_inputs = $('.pwyw-input');
        var submit_pwyw = true;
        var processed_value;
        var options = document.getElementsByName('option_selection');
        var selected_value;
        var mfr_cost = 0;
        for(var i = 0; i < options.length; i++){
            if(options[i].checked){
                selected_value = options[i].value.split("|",1);
                //For multiple products, get the cumulative mfr_cost.
                if (selected_value[0].indexOf("_") > -1){
                    selected_value = selected_value[0].split("_");
                    for(var j = 0; j < selected_value.length; j++){
                        mfr_cost += parseFloat($('div.pwyw_minimum'+selected_value[j]).attr('pwyw_minimum'));
                    }
                } else {
                    mfr_cost = parseFloat($('div.pwyw_minimum'+selected_value).attr('pwyw_minimum'));
                }

            }
        }
                mfr_cost = mfr_cost * 1.00000000;
		mfr_cost = mfr_cost.toFixed(2);
        pwyw_inputs.each(function() {
            var user_entered_value = $(this).val();
            processed_value = user_entered_value.replace(/[,]([0-9]{2})$/,".$1")
                                                    .replace(/,/,"")
                                                    .replace(/-/,"")
                                                    .replace(/^([0-9]{1,3})([\.])([0-9]{3})/,"$1$3");
            if(isNaN(parseFloat($(this).val()))) {
                submit_pwyw = false;
            } else {
                $(this).val(processed_value);
            }
        });
        if(submit_pwyw == false) {
            obsAlert('Please enter a valid amount');
        } else if (processed_value < mfr_cost) {
            obsAlert('This product has a minimum price necessary to cover the cost of materials. Please enter a price of at least $' + mfr_cost);  
            submit_pwyw = false;
        }
        return submit_pwyw;
    });
});
    </script>
    <!--[if IE]>
<script type="text/javascript" src="/includes/javascript/ie-shim.js"></script>
<![endif]-->
    <!-- prevent IE 9 from using IE5 quirks mode -->
    <!--[if IE 9]>
<meta http-equiv="X-UA-Compatible" content="IE=9"><script type="text/javascript">(window.NREUM||(NREUM={})).init={ajax:{deny_list:["bam.nr-data.net"]}};(window.NREUM||(NREUM={})).loader_config={licenseKey:"NRBR-a792f2982fda854fffd",applicationID:"700862248"};;/*! For license information please see nr-loader-rum-1.292.0.min.js.LICENSE.txt */
(()=>{var e,t,r={122:(e,t,r)=>{"use strict";r.d(t,{a:()=>i});var n=r(944);function i(e,t){try{if(!e||"object"!=typeof e)return(0,n.R)(3);if(!t||"object"!=typeof t)return(0,n.R)(4);const r=Object.create(Object.getPrototypeOf(t),Object.getOwnPropertyDescriptors(t)),a=0===Object.keys(r).length?e:r;for(let o in a)if(void 0!==e[o])try{if(null===e[o]){r[o]=null;continue}Array.isArray(e[o])&&Array.isArray(t[o])?r[o]=Array.from(new Set([...e[o],...t[o]])):"object"==typeof e[o]&&"object"==typeof t[o]?r[o]=i(e[o],t[o]):r[o]=e[o]}catch(e){r[o]||(0,n.R)(1,e)}return r}catch(e){(0,n.R)(2,e)}}},555:(e,t,r)=>{"use strict";r.d(t,{D:()=>s,f:()=>o});var n=r(384),i=r(122);const a={beacon:n.NT.beacon,errorBeacon:n.NT.errorBeacon,licenseKey:void 0,applicationID:void 0,sa:void 0,queueTime:void 0,applicationTime:void 0,ttGuid:void 0,user:void 0,account:void 0,product:void 0,extra:void 0,jsAttributes:{},userAttributes:void 0,atts:void 0,transactionName:void 0,tNamePlain:void 0};function o(e){try{return!!e.licenseKey&&!!e.errorBeacon&&!!e.applicationID}catch(e){return!1}}const s=e=>(0,i.a)(e,a)},324:(e,t,r)=>{"use strict";r.d(t,{F3:()=>i,Xs:()=>a,xv:()=>n});const n="1.292.0",i="PROD",a="CDN"},154:(e,t,r)=>{"use strict";r.d(t,{OF:()=>c,RI:()=>i,WN:()=>d,bv:()=>a,gm:()=>o,mw:()=>s,sb:()=>u});var n=r(863);const i="undefined"!=typeof window&&!!window.document,a="undefined"!=typeof WorkerGlobalScope&&("undefined"!=typeof self&&self instanceof WorkerGlobalScope&&self.navigator instanceof WorkerNavigator||"undefined"!=typeof globalThis&&globalThis instanceof WorkerGlobalScope&&globalThis.navigator instanceof WorkerNavigator),o=i?window:"undefined"!=typeof WorkerGlobalScope&&("undefined"!=typeof self&&self instanceof WorkerGlobalScope&&self||"undefined"!=typeof globalThis&&globalThis instanceof WorkerGlobalScope&&globalThis),s=Boolean("hidden"===o?.document?.visibilityState),c=/iPad|iPhone|iPod/.test(o.navigator?.userAgent),u=c&&"undefined"==typeof SharedWorker,d=((()=>{const e=o.navigator?.userAgent?.match(/Firefox[/\s](\d+\.\d+)/);Array.isArray(e)&&e.length>=2&&e[1]})(),Date.now()-(0,n.t)())},241:(e,t,r)=>{"use strict";r.d(t,{W:()=>a});var n=r(154);const i="newrelic";function a(e={}){try{n.gm.dispatchEvent(new CustomEvent(i,{detail:e}))}catch(e){}}},687:(e,t,r)=>{"use strict";r.d(t,{Ak:()=>u,Ze:()=>f,x3:()=>d});var n=r(241),i=r(836),a=r(606),o=r(860),s=r(646);const c={};function u(e,t){const r={staged:!1,priority:o.P3[t]||0};l(e),c[e].get(t)||c[e].set(t,r)}function d(e,t){e&&c[e]&&(c[e].get(t)&&c[e].delete(t),p(e,t,!1),c[e].size&&g(e))}function l(e){if(!e)throw new Error("agentIdentifier required");c[e]||(c[e]=new Map)}function f(e="",t="feature",r=!1){if(l(e),!e||!c[e].get(t)||r)return p(e,t);c[e].get(t).staged=!0,g(e)}function g(e){const t=Array.from(c[e]);t.every((([e,t])=>t.staged))&&(t.sort(((e,t)=>e[1].priority-t[1].priority)),t.forEach((([t])=>{c[e].delete(t),p(e,t)})))}function p(e,t,r=!0){const o=e?i.ee.get(e):i.ee,c=a.i.handlers;if(!o.aborted&&o.backlog&&c){if((0,n.W)({agentIdentifier:e,type:"lifecycle",name:"drain",feature:t}),r){const e=o.backlog[t],r=c[t];if(r){for(let t=0;e&&t<e.length;++t)m(e[t],r);Object.entries(r).forEach((([e,t])=>{Object.values(t||{}).forEach((t=>{t[0]?.on&&t[0]?.context()instanceof s.y&&t[0].on(e,t[1])}))}))}}o.isolatedBacklog||delete c[t],o.backlog[t]=null,o.emit("drain-"+t,[])}}function m(e,t){var r=e[1];Object.values(t[r]||{}).forEach((t=>{var r=e[0];if(t[0]===r){var n=t[1],i=e[3],a=e[2];n.apply(i,a)}}))}},836:(e,t,r)=>{"use strict";r.d(t,{P:()=>s,ee:()=>c});var n=r(384),i=r(990),a=r(646),o=r(607);const s="nr@context:".concat(o.W),c=function e(t,r){var n={},o={},d={},l=!1;try{l=16===r.length&&u.initializedAgents?.[r]?.runtime.isolatedBacklog}catch(e){}var f={on:p,addEventListener:p,removeEventListener:function(e,t){var r=n[e];if(!r)return;for(var i=0;i<r.length;i++)r[i]===t&&r.splice(i,1)},emit:function(e,r,n,i,a){!1!==a&&(a=!0);if(c.aborted&&!i)return;t&&a&&t.emit(e,r,n);for(var s=g(n),u=m(e),d=u.length,l=0;l<d;l++)u[l].apply(s,r);var p=v()[o[e]];p&&p.push([f,e,r,s]);return s},get:h,listeners:m,context:g,buffer:function(e,t){const r=v();if(t=t||"feature",f.aborted)return;Object.entries(e||{}).forEach((([e,n])=>{o[n]=t,t in r||(r[t]=[])}))},abort:function(){f._aborted=!0,Object.keys(f.backlog).forEach((e=>{delete f.backlog[e]}))},isBuffering:function(e){return!!v()[o[e]]},debugId:r,backlog:l?{}:t&&"object"==typeof t.backlog?t.backlog:{},isolatedBacklog:l};return Object.defineProperty(f,"aborted",{get:()=>{let e=f._aborted||!1;return e||(t&&(e=t.aborted),e)}}),f;function g(e){return e&&e instanceof a.y?e:e?(0,i.I)(e,s,(()=>new a.y(s))):new a.y(s)}function p(e,t){n[e]=m(e).concat(t)}function m(e){return n[e]||[]}function h(t){return d[t]=d[t]||e(f,t)}function v(){return f.backlog}}(void 0,"globalEE"),u=(0,n.Zm)();u.ee||(u.ee=c)},646:(e,t,r)=>{"use strict";r.d(t,{y:()=>n});class n{constructor(e){this.contextId=e}}},908:(e,t,r)=>{"use strict";r.d(t,{d:()=>n,p:()=>i});var n=r(836).ee.get("handle");function i(e,t,r,i,a){a?(a.buffer([e],i),a.emit(e,t,r)):(n.buffer([e],i),n.emit(e,t,r))}},606:(e,t,r)=>{"use strict";r.d(t,{i:()=>a});var n=r(908);a.on=o;var i=a.handlers={};function a(e,t,r,a){o(a||n.d,i,e,t,r)}function o(e,t,r,i,a){a||(a="feature"),e||(e=n.d);var o=t[a]=t[a]||{};(o[r]=o[r]||[]).push([e,i])}},878:(e,t,r)=>{"use strict";function n(e,t){return{capture:e,passive:!1,signal:t}}function i(e,t,r=!1,i){window.addEventListener(e,t,n(r,i))}function a(e,t,r=!1,i){document.addEventListener(e,t,n(r,i))}r.d(t,{DD:()=>a,jT:()=>n,sp:()=>i})},607:(e,t,r)=>{"use strict";r.d(t,{W:()=>n});const n=(0,r(566).bz)()},566:(e,t,r)=>{"use strict";r.d(t,{LA:()=>s,bz:()=>o});var n=r(154);const i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";function a(e,t){return e?15&e[t]:16*Math.random()|0}function o(){const e=n.gm?.crypto||n.gm?.msCrypto;let t,r=0;return e&&e.getRandomValues&&(t=e.getRandomValues(new Uint8Array(30))),i.split("").map((e=>"x"===e?a(t,r++).toString(16):"y"===e?(3&a()|8).toString(16):e)).join("")}function s(e){const t=n.gm?.crypto||n.gm?.msCrypto;let r,i=0;t&&t.getRandomValues&&(r=t.getRandomValues(new Uint8Array(e)));const o=[];for(var s=0;s<e;s++)o.push(a(r,i++).toString(16));return o.join("")}},614:(e,t,r)=>{"use strict";r.d(t,{BB:()=>o,H3:()=>n,g:()=>u,iL:()=>c,tS:()=>s,uh:()=>i,wk:()=>a});const n="NRBA",i="SESSION",a=144e5,o=18e5,s={STARTED:"session-started",PAUSE:"session-pause",RESET:"session-reset",RESUME:"session-resume",UPDATE:"session-update"},c={SAME_TAB:"same-tab",CROSS_TAB:"cross-tab"},u={OFF:0,FULL:1,ERROR:2}},863:(e,t,r)=>{"use strict";function n(){return Math.floor(performance.now())}r.d(t,{t:()=>n})},944:(e,t,r)=>{"use strict";r.d(t,{R:()=>i});var n=r(241);function i(e,t){"function"==typeof console.debug&&(console.debug("New Relic Warning: https://github.com/newrelic/newrelic-browser-agent/blob/main/docs/warning-codes.md#".concat(e),t),(0,n.W)({agentIdentifier:null,drained:null,type:"data",name:"warn",feature:"warn",data:{code:e,secondary:t}}))}},701:(e,t,r)=>{"use strict";r.d(t,{B:()=>a,t:()=>o});var n=r(241);const i=new Set,a={};function o(e,t){const r=t.agentIdentifier;a[r]??={},e&&"object"==typeof e&&(i.has(r)||(t.ee.emit("rumresp",[e]),a[r]=e,i.add(r),(0,n.W)({agentIdentifier:r,loaded:!0,drained:!0,type:"lifecycle",name:"load",feature:void 0,data:e})))}},990:(e,t,r)=>{"use strict";r.d(t,{I:()=>i});var n=Object.prototype.hasOwnProperty;function i(e,t,r){if(n.call(e,t))return e[t];var i=r();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,t,{value:i,writable:!0,enumerable:!1}),i}catch(e){}return e[t]=i,i}},389:(e,t,r)=>{"use strict";function n(e,t=500,r={}){const n=r?.leading||!1;let i;return(...r)=>{n&&void 0===i&&(e.apply(this,r),i=setTimeout((()=>{i=clearTimeout(i)}),t)),n||(clearTimeout(i),i=setTimeout((()=>{e.apply(this,r)}),t))}}function i(e){let t=!1;return(...r)=>{t||(t=!0,e.apply(this,r))}}r.d(t,{J:()=>i,s:()=>n})},289:(e,t,r)=>{"use strict";r.d(t,{GG:()=>a,Qr:()=>s,sB:()=>o});var n=r(878);function i(){return"undefined"==typeof document||"complete"===document.readyState}function a(e,t){if(i())return e();(0,n.sp)("load",e,t)}function o(e){if(i())return e();(0,n.DD)("DOMContentLoaded",e)}function s(e){if(i())return e();(0,n.sp)("popstate",e)}},384:(e,t,r)=>{"use strict";r.d(t,{NT:()=>a,US:()=>u,Zm:()=>o,bQ:()=>c,dV:()=>s,pV:()=>d});var n=r(154),i=r(863);const a={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net"};function o(){return n.gm.NREUM||(n.gm.NREUM={}),void 0===n.gm.newrelic&&(n.gm.newrelic=n.gm.NREUM),n.gm.NREUM}function s(){let e=o();return e.o||(e.o={ST:n.gm.setTimeout,SI:n.gm.setImmediate,CT:n.gm.clearTimeout,XHR:n.gm.XMLHttpRequest,REQ:n.gm.Request,EV:n.gm.Event,PR:n.gm.Promise,MO:n.gm.MutationObserver,FETCH:n.gm.fetch,WS:n.gm.WebSocket}),e}function c(e,t){let r=o();r.initializedAgents??={},t.initializedAt={ms:(0,i.t)(),date:new Date},r.initializedAgents[e]=t}function u(e,t){o()[e]=t}function d(){return function(){let e=o();const t=e.info||{};e.info={beacon:a.beacon,errorBeacon:a.errorBeacon,...t}}(),function(){let e=o();const t=e.init||{};e.init={...t}}(),s(),function(){let e=o();const t=e.loader_config||{};e.loader_config={...t}}(),o()}},843:(e,t,r)=>{"use strict";r.d(t,{u:()=>i});var n=r(878);function i(e,t=!1,r,i){(0,n.DD)("visibilitychange",(function(){if(t)return void("hidden"===document.visibilityState&&e());e(document.visibilityState)}),r,i)}},773:(e,t,r)=>{"use strict";r.d(t,{z_:()=>a,XG:()=>s,TZ:()=>n,rs:()=>i,xV:()=>o});r(154),r(566),r(384);const n=r(860).K7.metrics,i="sm",a="cm",o="storeSupportabilityMetrics",s="storeEventMetrics"},630:(e,t,r)=>{"use strict";r.d(t,{T:()=>n});const n=r(860).K7.pageViewEvent},782:(e,t,r)=>{"use strict";r.d(t,{T:()=>n});const n=r(860).K7.pageViewTiming},234:(e,t,r)=>{"use strict";r.d(t,{W:()=>a});var n=r(836),i=r(687);class a{constructor(e,t){this.agentIdentifier=e,this.ee=n.ee.get(e),this.featureName=t,this.blocked=!1}deregisterDrain(){(0,i.x3)(this.agentIdentifier,this.featureName)}}},741:(e,t,r)=>{"use strict";r.d(t,{W:()=>a});var n=r(944),i=r(261);class a{#e(e,...t){if(this[e]!==a.prototype[e])return this[e](...t);(0,n.R)(35,e)}addPageAction(e,t){return this.#e(i.hG,e,t)}register(e){return this.#e(i.eY,e)}recordCustomEvent(e,t){return this.#e(i.fF,e,t)}setPageViewName(e,t){return this.#e(i.Fw,e,t)}setCustomAttribute(e,t,r){return this.#e(i.cD,e,t,r)}noticeError(e,t){return this.#e(i.o5,e,t)}setUserId(e){return this.#e(i.Dl,e)}setApplicationVersion(e){return this.#e(i.nb,e)}setErrorHandler(e){return this.#e(i.bt,e)}addRelease(e,t){return this.#e(i.k6,e,t)}log(e,t){return this.#e(i.$9,e,t)}start(){return this.#e(i.d3)}finished(e){return this.#e(i.BL,e)}recordReplay(){return this.#e(i.CH)}pauseReplay(){return this.#e(i.Tb)}addToTrace(e){return this.#e(i.U2,e)}setCurrentRouteName(e){return this.#e(i.PA,e)}interaction(){return this.#e(i.dT)}wrapLogger(e,t,r){return this.#e(i.Wb,e,t,r)}measure(e,t){return this.#e(i.V1,e,t)}}},261:(e,t,r)=>{"use strict";r.d(t,{$9:()=>u,BL:()=>s,CH:()=>g,Dl:()=>_,Fw:()=>y,PA:()=>h,Pl:()=>n,Tb:()=>l,U2:()=>a,V1:()=>k,Wb:()=>x,bt:()=>b,cD:()=>v,d3:()=>w,dT:()=>c,eY:()=>p,fF:()=>f,hG:()=>i,k6:()=>o,nb:()=>m,o5:()=>d});const n="api-",i="addPageAction",a="addToTrace",o="addRelease",s="finished",c="interaction",u="log",d="noticeError",l="pauseReplay",f="recordCustomEvent",g="recordReplay",p="register",m="setApplicationVersion",h="setCurrentRouteName",v="setCustomAttribute",b="setErrorHandler",y="setPageViewName",_="setUserId",w="start",x="wrapLogger",k="measure"},163:(e,t,r)=>{"use strict";r.d(t,{j:()=>E});var n=r(384),i=r(741);var a=r(555);r(860).K7.genericEvents;const o="experimental.marks",s="experimental.measures",c="experimental.resources",u=e=>{if(!e||"string"!=typeof e)return!1;try{document.createDocumentFragment().querySelector(e)}catch{return!1}return!0};var d=r(614),l=r(944),f=r(122);const g="[data-nr-mask]",p=e=>(0,f.a)(e,(()=>{const e={feature_flags:[],experimental:{marks:!1,measures:!1,resources:!1},mask_selector:"*",block_selector:"[data-nr-block]",mask_input_options:{color:!1,date:!1,"datetime-local":!1,email:!1,month:!1,number:!1,range:!1,search:!1,tel:!1,text:!1,time:!1,url:!1,week:!1,textarea:!1,select:!1,password:!0}};return{ajax:{deny_list:void 0,block_internal:!0,enabled:!0,autoStart:!0},api:{allow_registered_children:!0,duplicate_registered_data:!1},distributed_tracing:{enabled:void 0,exclude_newrelic_header:void 0,cors_use_newrelic_header:void 0,cors_use_tracecontext_headers:void 0,allowed_origins:void 0},get feature_flags(){return e.feature_flags},set feature_flags(t){e.feature_flags=t},generic_events:{enabled:!0,autoStart:!0},harvest:{interval:30},jserrors:{enabled:!0,autoStart:!0},logging:{enabled:!0,autoStart:!0},metrics:{enabled:!0,autoStart:!0},obfuscate:void 0,page_action:{enabled:!0},page_view_event:{enabled:!0,autoStart:!0},page_view_timing:{enabled:!0,autoStart:!0},performance:{get capture_marks(){return e.feature_flags.includes(o)||e.experimental.marks},set capture_marks(t){e.experimental.marks=t},get capture_measures(){return e.feature_flags.includes(s)||e.experimental.measures},set capture_measures(t){e.experimental.measures=t},capture_detail:!0,resources:{get enabled(){return e.feature_flags.includes(c)||e.experimental.resources},set enabled(t){e.experimental.resources=t},asset_types:[],first_party_domains:[],ignore_newrelic:!0}},privacy:{cookies_enabled:!0},proxy:{assets:void 0,beacon:void 0},session:{expiresMs:d.wk,inactiveMs:d.BB},session_replay:{autoStart:!0,enabled:!1,preload:!1,sampling_rate:10,error_sampling_rate:100,collect_fonts:!1,inline_images:!1,fix_stylesheets:!0,mask_all_inputs:!0,get mask_text_selector(){return e.mask_selector},set mask_text_selector(t){u(t)?e.mask_selector="".concat(t,",").concat(g):""===t||null===t?e.mask_selector=g:(0,l.R)(5,t)},get block_class(){return"nr-block"},get ignore_class(){return"nr-ignore"},get mask_text_class(){return"nr-mask"},get block_selector(){return e.block_selector},set block_selector(t){u(t)?e.block_selector+=",".concat(t):""!==t&&(0,l.R)(6,t)},get mask_input_options(){return e.mask_input_options},set mask_input_options(t){t&&"object"==typeof t?e.mask_input_options={...t,password:!0}:(0,l.R)(7,t)}},session_trace:{enabled:!0,autoStart:!0},soft_navigations:{enabled:!0,autoStart:!0},spa:{enabled:!0,autoStart:!0},ssl:void 0,user_actions:{enabled:!0,elementAttributes:["id","className","tagName","type"]}}})());var m=r(154),h=r(324);let v=0;const b={buildEnv:h.F3,distMethod:h.Xs,version:h.xv,originTime:m.WN},y={appMetadata:{},customTransaction:void 0,denyList:void 0,disabled:!1,entityManager:void 0,harvester:void 0,isolatedBacklog:!1,isRecording:!1,loaderType:void 0,maxBytes:3e4,obfuscator:void 0,onerror:void 0,ptid:void 0,releaseIds:{},session:void 0,timeKeeper:void 0,get harvestCount(){return++v}},_=e=>{const t=(0,f.a)(e,y),r=Object.keys(b).reduce(((e,t)=>(e[t]={value:b[t],writable:!1,configurable:!0,enumerable:!0},e)),{});return Object.defineProperties(t,r)};var w=r(701);const x=e=>{const t=e.startsWith("http");e+="/",r.p=t?e:"https://"+e};var k=r(836),A=r(241);const S={accountID:void 0,trustKey:void 0,agentID:void 0,licenseKey:void 0,applicationID:void 0,xpid:void 0},T=e=>(0,f.a)(e,S),R=new Set;function E(e,t={},r,o){let{init:s,info:c,loader_config:u,runtime:d={},exposed:l=!0}=t;if(!c){const e=(0,n.pV)();s=e.init,c=e.info,u=e.loader_config}e.init=p(s||{}),e.loader_config=T(u||{}),c.jsAttributes??={},m.bv&&(c.jsAttributes.isWorker=!0),e.info=(0,a.D)(c);const f=e.init,g=[c.beacon,c.errorBeacon];R.has(e.agentIdentifier)||(f.proxy.assets&&(x(f.proxy.assets),g.push(f.proxy.assets)),f.proxy.beacon&&g.push(f.proxy.beacon),function(e){const t=(0,n.pV)();Object.getOwnPropertyNames(i.W.prototype).forEach((r=>{const n=i.W.prototype[r];if("function"!=typeof n||"constructor"===n)return;let a=t[r];e[r]&&!1!==e.exposed&&"micro-agent"!==e.runtime?.loaderType&&(t[r]=(...t)=>{const n=e[r](...t);return a?a(...t):n})}))}(e),(0,n.US)("activatedFeatures",w.B),e.runSoftNavOverSpa&&=!0===f.soft_navigations.enabled&&f.feature_flags.includes("soft_nav")),d.denyList=[...f.ajax.deny_list||[],...f.ajax.block_internal?g:[]],d.ptid=e.agentIdentifier,d.loaderType=r,e.runtime=_(d),R.has(e.agentIdentifier)||(e.ee=k.ee.get(e.agentIdentifier),e.exposed=l,(0,A.W)({agentIdentifier:e.agentIdentifier,drained:!!w.B?.[e.agentIdentifier],type:"lifecycle",name:"initialize",feature:void 0,data:e.config})),R.add(e.agentIdentifier)}},374:(e,t,r)=>{r.nc=(()=>{try{return document?.currentScript?.nonce}catch(e){}return""})()},860:(e,t,r)=>{"use strict";r.d(t,{$J:()=>d,K7:()=>c,P3:()=>u,XX:()=>i,Yy:()=>s,df:()=>a,qY:()=>n,v4:()=>o});const n="events",i="jserrors",a="browser/blobs",o="rum",s="browser/logs",c={ajax:"ajax",genericEvents:"generic_events",jserrors:i,logging:"logging",metrics:"metrics",pageAction:"page_action",pageViewEvent:"page_view_event",pageViewTiming:"page_view_timing",sessionReplay:"session_replay",sessionTrace:"session_trace",softNav:"soft_navigations",spa:"spa"},u={[c.pageViewEvent]:1,[c.pageViewTiming]:2,[c.metrics]:3,[c.jserrors]:4,[c.spa]:5,[c.ajax]:6,[c.sessionTrace]:7,[c.softNav]:8,[c.sessionReplay]:9,[c.logging]:10,[c.genericEvents]:11},d={[c.pageViewEvent]:o,[c.pageViewTiming]:n,[c.ajax]:n,[c.spa]:n,[c.softNav]:n,[c.metrics]:i,[c.jserrors]:i,[c.sessionTrace]:a,[c.sessionReplay]:a,[c.logging]:s,[c.genericEvents]:"ins"}}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var a=n[e]={exports:{}};return r[e](a,a.exports,i),a.exports}i.m=r,i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,r)=>(i.f[r](e,t),t)),[])),i.u=e=>"nr-rum-1.292.0.min.js",i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="NRBA-1.292.0.PROD:",i.l=(r,n,a,o)=>{if(e[r])e[r].push(n);else{var s,c;if(void 0!==a)for(var u=document.getElementsByTagName("script"),d=0;d<u.length;d++){var l=u[d];if(l.getAttribute("src")==r||l.getAttribute("data-webpack")==t+a){s=l;break}}if(!s){c=!0;var f={296:"sha512-vV6XfBYRKdW1mnqFJICmxO127P1af8JBWoP0dBYfzpZBHBDM/opWrZh1SphTpUuf8Sw+aTcyEDjMvkVQA9lHgQ=="};(s=document.createElement("script")).charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.setAttribute("data-webpack",t+a),s.src=r,0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous"),f[o]&&(s.integrity=f[o])}e[r]=[n];var g=(t,n)=>{s.onerror=s.onload=null,clearTimeout(p);var i=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((e=>e(n))),t)return t(n)},p=setTimeout(g.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=g.bind(null,s.onerror),s.onload=g.bind(null,s.onload),c&&document.head.appendChild(s)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="https://js-agent.newrelic.com/",(()=>{var e={374:0,840:0};i.f.j=(t,r)=>{var n=i.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var a=new Promise(((r,i)=>n=e[t]=[r,i]));r.push(n[2]=a);var o=i.p+i.u(t),s=new Error;i.l(o,(r=>{if(i.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var a=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+a+": "+o+")",s.name="ChunkLoadError",s.type=a,s.request=o,n[1](s)}}),"chunk-"+t,t)}};var t=(t,r)=>{var n,a,[o,s,c]=r,u=0;if(o.some((t=>0!==e[t]))){for(n in s)i.o(s,n)&&(i.m[n]=s[n]);if(c)c(i)}for(t&&t(r);u<o.length;u++)a=o[u],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0},r=self["webpackChunk:NRBA-1.292.0.PROD"]=self["webpackChunk:NRBA-1.292.0.PROD"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";i(374);var e=i(566),t=i(741);class r extends t.W{agentIdentifier=(0,e.LA)(16)}var n=i(860);const a=Object.values(n.K7);var o=i(163);var s=i(908),c=i(863),u=i(261),d=i(241),l=i(944),f=i(701),g=i(773);function p(e,t,i,a){const o=a||i;!o||o[e]&&o[e]!==r.prototype[e]||(o[e]=function(){(0,s.p)(g.xV,["API/"+e+"/called"],void 0,n.K7.metrics,i.ee),(0,d.W)({agentIdentifier:i.agentIdentifier,drained:!!f.B?.[i.agentIdentifier],type:"data",name:"api",feature:u.Pl+e,data:{}});try{return t.apply(this,arguments)}catch(e){(0,l.R)(23,e)}})}function m(e,t,r,n,i){const a=e.info;null===r?delete a.jsAttributes[t]:a.jsAttributes[t]=r,(i||null===r)&&(0,s.p)(u.Pl+n,[(0,c.t)(),t,r],void 0,"session",e.ee)}var h=i(687),v=i(234),b=i(289),y=i(154),_=i(384);const w=e=>y.RI&&!0===e?.privacy.cookies_enabled;function x(e){return!!(0,_.dV)().o.MO&&w(e)&&!0===e?.session_trace.enabled}var k=i(389);class A extends v.W{constructor(e,t){super(e.agentIdentifier,t),this.abortHandler=void 0,this.featAggregate=void 0,this.onAggregateImported=void 0,this.deferred=Promise.resolve(),!1===e.init[this.featureName].autoStart?this.deferred=new Promise(((t,r)=>{this.ee.on("manual-start-all",(0,k.J)((()=>{(0,h.Ak)(e.agentIdentifier,this.featureName),t()})))})):(0,h.Ak)(e.agentIdentifier,t)}importAggregator(e,t,r={}){if(this.featAggregate)return;let a;this.onAggregateImported=new Promise((e=>{a=e}));const o=async()=>{let o;await this.deferred;try{if(w(e.init)){const{setupAgentSession:t}=await i.e(296).then(i.bind(i,663));o=t(e)}}catch(e){(0,l.R)(20,e),this.ee.emit("internal-error",[e]),this.featureName===n.K7.sessionReplay&&this.abortHandler?.()}try{if(!this.#t(this.featureName,o,e.init))return(0,h.Ze)(this.agentIdentifier,this.featureName),void a(!1);const{Aggregate:n}=await t();this.featAggregate=new n(e,r),e.runtime.harvester.initializedAggregates.push(this.featAggregate),a(!0)}catch(e){(0,l.R)(34,e),this.abortHandler?.(),(0,h.Ze)(this.agentIdentifier,this.featureName,!0),a(!1),this.ee&&this.ee.abort()}};y.RI?(0,b.GG)((()=>o()),!0):o()}#t(e,t,r){switch(e){case n.K7.sessionReplay:return x(r)&&!!t;case n.K7.sessionTrace:return!!t;default:return!0}}}var S=i(630),T=i(614);class R extends A{static featureName=S.T;constructor(e){var t;super(e,S.T),this.setupInspectionEvents(e.agentIdentifier),t=e,p(u.Fw,(function(e,r){"string"==typeof e&&("/"!==e.charAt(0)&&(e="/"+e),t.runtime.customTransaction=(r||"http://custom.transaction")+e,(0,s.p)(u.Pl+u.Fw,[(0,c.t)()],void 0,void 0,t.ee))}),t),this.ee.on("api-send-rum",((e,t)=>(0,s.p)("send-rum",[e,t],void 0,this.featureName,this.ee))),this.importAggregator(e,(()=>i.e(296).then(i.bind(i,108))))}setupInspectionEvents(e){const t=(t,r)=>{t&&(0,d.W)({agentIdentifier:e,timeStamp:t.timeStamp,loaded:"complete"===t.target.readyState,type:"window",name:r,data:t.target.location+""})};(0,b.sB)((e=>{t(e,"DOMContentLoaded")})),(0,b.GG)((e=>{t(e,"load")})),(0,b.Qr)((e=>{t(e,"navigate")})),this.ee.on(T.tS.UPDATE,((t,r)=>{(0,d.W)({agentIdentifier:e,type:"lifecycle",name:"session",data:r})}))}}var E=i(843),N=i(878),j=i(782);class I extends A{static featureName=j.T;constructor(e){super(e,j.T),y.RI&&((0,E.u)((()=>(0,s.p)("docHidden",[(0,c.t)()],void 0,j.T,this.ee)),!0),(0,N.sp)("pagehide",(()=>(0,s.p)("winPagehide",[(0,c.t)()],void 0,j.T,this.ee))),this.importAggregator(e,(()=>i.e(296).then(i.bind(i,350)))))}}class O extends A{static featureName=g.TZ;constructor(e){super(e,g.TZ),y.RI&&document.addEventListener("securitypolicyviolation",(e=>{(0,s.p)(g.xV,["Generic/CSPViolation/Detected"],void 0,this.featureName,this.ee)})),this.importAggregator(e,(()=>i.e(296).then(i.bind(i,373))))}}new class extends r{constructor(e){var t;(super(),y.gm)?(this.features={},(0,_.bQ)(this.agentIdentifier,this),this.desiredFeatures=new Set(e.features||[]),this.desiredFeatures.add(R),this.runSoftNavOverSpa=[...this.desiredFeatures].some((e=>e.featureName===n.K7.softNav)),(0,o.j)(this,e,e.loaderType||"agent"),t=this,p(u.cD,(function(e,r,n=!1){if("string"==typeof e){if(["string","number","boolean"].includes(typeof r)||null===r)return m(t,e,r,u.cD,n);(0,l.R)(40,typeof r)}else(0,l.R)(39,typeof e)}),t),function(e){p(u.Dl,(function(t){if("string"==typeof t||null===t)return m(e,"enduser.id",t,u.Dl,!0);(0,l.R)(41,typeof t)}),e)}(this),function(e){p(u.nb,(function(t){if("string"==typeof t||null===t)return m(e,"application.version",t,u.nb,!1);(0,l.R)(42,typeof t)}),e)}(this),function(e){p(u.d3,(function(){e.ee.emit("manual-start-all")}),e)}(this),this.run()):(0,l.R)(21)}get config(){return{info:this.info,init:this.init,loader_config:this.loader_config,runtime:this.runtime}}get api(){return this}run(){try{const e=function(e){const t={};return a.forEach((r=>{t[r]=!!e[r]?.enabled})),t}(this.init),t=[...this.desiredFeatures];t.sort(((e,t)=>n.P3[e.featureName]-n.P3[t.featureName])),t.forEach((t=>{if(!e[t.featureName]&&t.featureName!==n.K7.pageViewEvent)return;if(this.runSoftNavOverSpa&&t.featureName===n.K7.spa)return;if(!this.runSoftNavOverSpa&&t.featureName===n.K7.softNav)return;const r=function(e){switch(e){case n.K7.ajax:return[n.K7.jserrors];case n.K7.sessionTrace:return[n.K7.ajax,n.K7.pageViewEvent];case n.K7.sessionReplay:return[n.K7.sessionTrace];case n.K7.pageViewTiming:return[n.K7.pageViewEvent];default:return[]}}(t.featureName).filter((e=>!(e in this.features)));r.length>0&&(0,l.R)(36,{targetFeature:t.featureName,missingDependencies:r}),this.features[t.featureName]=new t(this)}))}catch(e){(0,l.R)(22,e);for(const e in this.features)this.features[e].abortHandler?.();const t=(0,_.Zm)();delete t.initializedAgents[this.agentIdentifier]?.features,delete this.sharedAggregator;return t.ee.get(this.agentIdentifier).abort(),!1}}}({features:[R,I,O],loaderType:"lite"})})()})();</script>
<![endif]-->
    <script type="text/javascript">
     // Detect if cookies are enabled, and forward user to "cookies required" page if not
var cookieEnabled = (navigator.cookieEnabled) ? true : false;
if (typeof navigator.cookieEnabled == "undefined" && !cookieEnabled) { 
	document.cookie="testcookie";
	cookieEnabled = (document.cookie.indexOf("testcookie") != -1) ? true : false;
}
if (!cookieEnabled && document.URL.indexOf("cookie_usage.php")==-1) {
	window.location = '/cookie_usage.php';
}
    </script>
    <!-- Hotjar Tracking Code for https://legacy.drivethrurpg.com/ -->
    <script>
     (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:1245059,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
    </script>
    <script type="text/javascript">
     (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "hvmgl7ktbk");
    </script>
    <script>
     // TAP-10323 - COVID notice
			function catchDismissClick(idToClose) {
				$("#"+idToClose).toggle("blind");
				$.ajax('/includes/ajax/dismiss_forever.php?action=dismiss',
					{
						type: 'POST',
						data: { id: idToClose },
						success: function (data) {
							var jsonData = JSON.parse(data);
							if (jsonData.success != 1) {
								$("#message").text("Error");
							}
						},
						error: function() {
							alert('Something went wrong.');
						}
				});
            }
    </script>
   </link>
  </link>
 </head>
 <body bottommargin="0" class="index-body" leftmargin="0" marginheight="0" marginwidth="0" rightmargin="0" topmargin="0">
  <!-- header -->
  <div class="standardbg overflow-y-hidden" id="header">
   <div class="header-img-container">
    <a href="../index.html">
     <img alt="DMsGuild Logo" class="header-logo" src="../themes/dmg/images/DMsGuild-Logo.png" title="DMsGuild Logo"/>
    </a>
    <img alt="" class="headerbg-left" src="../themes/dmg/images/PLS-DMG-Header.jpg"/>
    <img alt="" class="headerbg-right" src="../themes/dmg/images/Header-Right.png"/>
   </div>
   <div id="header-nav">
    <div id="actionswrapper">
     <ul class="nav-bar-wrapper">
      <li class="nav-bar-item">
       <span class="social" style="float:left">
        <!--set hrefs to proper twitter and facebook links -->
        <a href="https://twitter.com/dms_guild" target="_blank" title="Twitter">
         <img alt="Our Twitter page" src="../shared_images/icon_twitter_hea.png"/>
        </a>
        <a href="https://www.facebook.com/DungeonMastersGuild" target="_blank" title="Facebook">
         <img alt="Our Facebook page" src="../shared_images/icon_facebook_hea.png"/>
        </a>
       </span>
      </li>
      <img alt="" class="nav-bar-separator" src="../themes/dmg/images/divider.png"/>
      <li class="nav-bar-item">
       <a class="nav-bar-link create_account_window" href="https://www.dmsguild.com/login.php">
        Login
       </a>
      </li>
      <img alt="" class="nav-bar-separator" src="../themes/dmg/images/divider.png"/>
      <li class="nav-bar-item">
       <a class="nav-bar-link" href="https://www.dmsguild.com/my_library.php">
        My Library
       </a>
      </li>
      <img alt="" class="nav-bar-separator" src="../themes/dmg/images/divider.png"/>
      <li class="nav-bar-item">
       <a class="nav-bar-link" href="https://www.dmsguild.com/wishlist.php">
        Wishlists
       </a>
      </li>
      <img alt="" class="nav-bar-separator" src="../themes/dmg/images/divider.png"/>
     </ul>
    </div>
   </div>
   <div array="" class="grid hidden" id="header-cart-widget">
    <a href="https://www.dmsguild.com/shopping_cart.php">
     <span class="site-button rounded-corners-button site-button-nitems">
      <span class="rounded-corners-button-text" style="white-space:nowrap;">
       Cart
      </span>
      <div class="site-button site-button-nitems">
       <i class="fa fa-shopping-cart" style="margin: 0 3 0 3; position:relative; top:-3px;">
       </i>
      </div>
      <div class="site-button site-button-nitems" id="cart-widget-qty">
       0
      </div>
     </span>
    </a>
   </div>
  </div>
  <div class="login-popup-forms">
   <script type="text/javascript">
    var show_login_create_popup = true;
var show_login_create_message = '';
$(document).ready(function() {
	$.getScript('/includes/javascript/mailcheck.min.js');
	$("#create_account").validationEngine('detach');
	$("#create_account").validationEngine('detach');
	$("#create_account").validationEngine('attach', {
		promptPosition: "bottomRight",
		scroll: false,
		binded: false,
		autoHidePrompt: true,
		autoHideDelay: 5000,
		onValidationComplete: function(form, status) {
			if (status == true) {
				$("#createaccountbutton").css('cursor', 'auto' );
				$("#createaccountbutton").val("Please Wait");
				$('#createaccountbutton').unbind('click');
				$('#createaccountbutton').unbind('mouseover');
				$('#createaccountbutton').removeClass('site-button-hover');

				$("#create_account").validationEngine('detach');
			}
			return status;
		}
	});

	$('a.create_account_window').click(function() {
		// Only login a new customer if we started on a shopping cart page.
		var this_location = "" + window.location; // Cast to a string.
		var found = this_location.indexOf('shopping_cart.php');
		// If not found, indexOf() will return a -1.
		if (found == -1) {
			login_new_customer('0');
		} else {
			login_new_customer('1');
		}
		return false;
	});

	$("#create_account_hide_password").click(function() {
		var password = $("#create_account_password");
		var password_hidden = $("#create_account_password_hidden");
		var tabindex = 0;

		if ($(this).get(0).checked) {
			$("#password_hidden-wrapper").show();
			$("#password-wrapper").hide();
			tabindex = parseInt(password.attr('tabindex'));
			password.attr("tabindex", -1);
			password.css("display", "none");
			password_hidden.css("display", "");
			password_hidden.attr("tabindex", tabindex);
			password_hidden.get(0).value = password.get(0).value;
		} else {
			$("#password_hidden-wrapper").hide();
			$("#password-wrapper").show();
			tabindex = parseInt(password_hidden.attr('tabindex'));
			password_hidden.attr("tabindex", -1);
			password_hidden.css("display", "none");
			password.css("display", "");
			password.attr("tabindex", tabindex);
		}
	});

	$("#create_account_password_hidden").keyup(function() {
		$("#create_account_password").get(0).value = $(this).get(0).value;
	});

	// When un-checking the "newsletters" checkbox, show the info
	$("#create_account_default_newsletters").click(function() {
		if (this.checked) {
			$("#create_account_default_newsletters_info").fadeOut(300);
		} else {
			$("#create_account_default_newsletters_info").fadeIn(300);
		}
	});

	// click on the close button or the login mask layer to close the popup
	$('a.close').on('click' ,function(){
		$('#create_account_mask , .create_account_popup').fadeOut(300 , function() {
			$('#create_account_mask').remove();
		});
	});
	$(document.body).on('click', '#create_account_mask' ,function(){
		$('#create_account_mask , .create_account_popup').fadeOut(300 , function() {
			$('#create_account_mask').remove();
		});
	});

	var recaptchaLoginWidget;

	// CSS button for submit
	$('#createaccountbutton').on('click', function(e) {
		if ($('form#create_account').validationEngine('validate')) {
			grecaptcha.execute(recaptchaLoginWidget);
		}
		e.preventDefault();
		return false;
	});

	$('#createaccountbutton').on('mouseover', function() {
		$('#createaccountbutton').addClass('site-button-hover');
	});

	$('#createaccountbutton').on('mouseout', function() {
		$('#createaccountbutton').removeClass('site-button-hover');
	});

	// Bind this keypress function to the inputs
	$("#create_account_firstname,#create_account_lastname,#create_account_email_address,#create_account_password,#create_account_password_hidden").keypress(function (evt) {
		// Determine where our character code is coming from within the event
		var charCode = evt.charCode || evt.keyCode;
		if (charCode  == 13) {
			// Enter key's keycode
			if ($('form#create_account').validationEngine('validate')) {
				grecaptcha.execute(recaptchaLoginWidget);
			}
			evt.preventDefault();
			return false;
		}
	});

	$('#create_account_box .btn-facebook').click(function(e) {
		e.preventDefault();
		var href = $(this).attr('href');
		var newsletter = $('#create_account_default_newsletters').is(':checked');
		$.ajax({
				url: 'https://www.dmsguild.com/includes/ajax/create_newsletter_session.php',
				data: {newsletter: newsletter},
				type: 'post'
			}
		).success(function(){
				window.location = href;
			});


	});

	$("#mail_misspelling_suggestions").css("display", "none");
	$('#email_address').on('blur', function() {
		$(this).mailcheck({
			suggested: function(element, suggestion) {
				// callback code

				$("#suggestion_message").html('Did you mean "' + suggestion.full + '"?');
				$("#mail_misspelling_suggestions").slideDown(400);
			},
			empty: function(element) {
				// callback code
				$("#mail_misspelling_suggestions").slideUp(300);
			}
		});
	});
});

function login_new_customer(checkout_after_login) {
	if (typeof checkout_after_login === 'undefined') {
		checkout_value = '0';
	} else if (typeof checkout_after_login === 'string') {
		checkout_value = checkout_after_login;
	} else {
		checkout_value = checkout_after_login.toString();
	}

	if (document.forms["login"].elements["email_address"].value != '') {
		new_email_value = document.forms["login"].elements["email_address"].value;
		document.forms["create_account"].elements["email_address"].value = new_email_value;
	}

	if (document.forms["login"].elements["login_password"].value != '') {
		new_pwd_value = document.forms["login"].elements["login_password"].value;
		document.forms["create_account"].elements["create_account_password_hidden"].value = new_pwd_value;
		document.forms["create_account"].elements["create_account_password"].value = new_pwd_value;
	}

	if (document.getElementById("login_mask") != null) {
		$('#login_mask, .login_popup').fadeOut(300 , function() {
			$('#login_mask').remove();
		});
	}

	var loginBox = "#login_box";
	var createAccountBox = "#create_account_box";

	//Fade in the Popup
	$(createAccountBox).fadeIn(300);
	if (!show_login_create_popup) {
		$(loginBox).hide();
		$('.login-page .login-message').html(show_login_create_message);
	}

	if (show_login_create_popup) {
		// Set the center alignment padding + border see css style
		var popMargTop = ($(createAccountBox).height() + 24) / 2;
		var popMargLeft = ($(createAccountBox).width() + 24) / 2;
		$(createAccountBox).css({
			'margin-left' : -popMargLeft
		});
		// hack for iPad
		if (navigator.userAgent.match(/iPad/i)) {
			$(createAccountBox).css({
				'margin-left' : 0,
				'left' : 0
			});
		}
		// Add the create account mask to body
		$('body').append('<div id="create_account_mask"></div>');
		$('#create_account_mask').fadeIn(300);
	}

	$('#create_account_firstname').focus();
	document.forms["login"].elements["checkout_after_login"].value = checkout_value;
	document.forms["create_account"].elements["checkout_after_login"].value = checkout_value;

	
	return false;
}

// This method is called if email is not available, meaning this account already exists.
// Validation requirement is removed from the name fields, then the form is submitted.
function login_from_new_account_box() {

	new_email_value = document.forms["create_account"].elements["email_address"].value;
	document.forms["login"].elements["email_address"].value = new_email_value;
	new_pwd_value = document.forms["create_account"].elements["create_account_password_hidden"].value;
	if (new_pwd_value == '') {
		new_pwd_value = document.forms["create_account"].elements["create_account_password"].value;
	}
	document.forms["login"].elements["login_password"].value = new_pwd_value;

	$('#from_new_account_popup_text').show();
	if ($('#from_new_account_popup_text').html() == '') {
		$('#from_new_account_popup_text').append('<br /><br />Email already in use. Attempting to log you into existing account.');
	}

	$('#login_error_box').html('Error: Incorrect password.');

	login_returning_customer();

	$('#login').submit();

	return false;
}

/**
 * Queries the server to see if this email is available. The script
 * actually checks to see if the email is in use and then inverts
 * the logic. This is the first of two checks for this, because
 * while this check is synchronous, it doesn't return the
 * alertTextOk message with the proper formatting. So the validation
 * checks this first to prevent the form from being submitted, and
 * then if this passes successfully the form makes an ajax call
 * directly to return the properly formatted alertTextOk message.
 *
 * @param	{jqObject}		field	the field where the validation applies
 * @param	{Array[String]}	rules	validation rules for this field
 * @param	{int}			i		rule index
 * @param	{Map}			options	form options
 * @return an error string if validation failed
 */
function is_email_available(field, rules, i, options) {
    var email_available = null;
    $.ajaxSetup({async: false});
    $.post(
        'https://www.dmsguild.com/validate_email.php',
        {
            fieldId: 'email',
            fieldValue: field.val()
        },
        function(data) {
            email_available = (data[1]);
        },
        'json'
    );
    $.ajaxSetup({async: true});

	if (email_available == false) {
		return options.allrules.ajaxIsEmailAvailable.alertText;
	}
}
   </script>
   <script type="text/javascript">
    $(function() {
		$.getScript('https://www.google.com/recaptcha/api.js?render=explicit&onload=renderLoginRecaptcha');
	});

	function onSubmit_createAccount(token) {
		$("#g-recaptcha-token").val(token);
		$("#create_account").validationEngine('detach');
		$("#create_account").submit();
	}

	function renderLoginRecaptcha() {
		recaptchaLoginWidget = grecaptcha.render('login-recaptcha');
	}
   </script>
   <div class="create_account_popup customer-popup" id="create_account_box">
    <a class="close" href="#">
     <img alt="Close" class="btn_close" src="../shared_images/popup_close_button.png" title="Close Window"/>
    </a>
    <div class="g-recaptcha" data-callback="onSubmit_createAccount" data-sitekey="6LfuT7IUAAAAAE3SHa5ucwB-p_iUzlHmGyQqLpNn" data-size="invisible" id="login-recaptcha">
    </div>
    <style type="text/css">
     #hide_password-wrapper{
			height:35px;
			vertical-align:middle;
		}
		#mail_misspelling_suggestions {
			margin: -10px 0 10px 0;
			height: 15px;
			padding: 5px;
		}
    </style>
    <div class="popup-header">
     <span class="title">
      New Account
      <span class="subtitle boxText">
       (or
       <a class="login_window" href="#login_box" onclick="return false;" tabindex="8">
        Log In
       </a>
       )
      </span>
      <span class="subtitle boxText" id="from_login_popup_text">
      </span>
     </span>
    </div>
    <div class="popup-content-wrapper">
     <div class="popup-content boxText popup-content-left">
      <link href="../includes/classes/obs/resources/form/css/form.css" rel="stylesheet" type="text/css">
       <script charset="UTF-8" src="../includes/libraries/jQuery/1.11.1-min/plugins/jquery.once.js" type="text/javascript">
       </script>
       <script charset="UTF-8" src="../includes/libraries/jQuery/1.11.1-min/plugins/jquery.form.js" type="text/javascript">
       </script>
       <script charset="UTF-8" src="../includes/classes/obs/resources/form/js/form.js" type="text/javascript">
       </script>
       <script charset="UTF-8" src="../includes/classes/obs/resources/form/js/collapse.js" type="text/javascript">
       </script>
       <script type="text/javascript">
       </script>
       <form accept-charset="UTF-8" action="https://www.dmsguild.com/create_account.php" class="form-wrapper form-form form-create_account" enctype="multipart/form-data" id="create_account" method="POST" name="create_account">
        <span>
         <input class="form-parent-create_account form-hidden form-action" id="action" name="action" type="hidden" value="process"/>
         <input class="form-parent-create_account form-hidden form-origin" id="origin" name="origin" type="hidden" value="new_customer_popup"/>
         <input class="form-parent-create_account form-hidden form-checkout_after_login" id="checkout_after_login" name="checkout_after_login" type="hidden" value="0"/>
         <input class="form-parent-create_account form-hidden form-redirect_url" id="redirect_url" name="redirect_url" type="hidden" value="/?affiliate_id=389627?utm_content=zid-zid"/>
         <input class="form-parent-create_account form-hidden form-g-recaptcha-token" id="g-recaptcha-token" name="g-recaptcha-token" type="hidden" value=""/>
         <input class="form-parent-create_account form-hidden form-customers_referral" id="customers_referral" name="customers_referral" type="hidden" value=""/>
         <fieldset class="form-parent-create_account form-wrapper form-fieldset form-field-name container-inline form-wrapper form-collapsible" id="field-name" name="field-name">
          <div class="fieldset-wrapper">
           <div class="wrapper form-element-wrapper" id="firstname-wrapper">
            <input class="form-parent-field-name form-element form-text form-firstname boxText validate[required]" id="firstname" name="firstname" placeholder="First Name" size="60" tabindex="1" title="First Name" type="text" value=""/>
           </div>
           <div class="wrapper form-element-wrapper" id="lastname-wrapper">
            <input class="form-parent-field-name form-element form-text form-lastname boxText validate[required]" id="lastname" name="lastname" placeholder="Last Name" size="60" tabindex="2" title="Last Name" type="text" value=""/>
           </div>
          </div>
         </fieldset>
         <div class="wrapper form-element-wrapper" id="email_address-wrapper">
          <input class="form-parent-create_account form-element form-text form-email_address boxText validate[required,custom[email],funcCall[is_email_available]]" id="email_address" name="email_address" placeholder="Email" size="60" tabindex="3" title="Email" type="text" value=""/>
         </div>
         <div class="alert-warning" id="mail_misspelling_suggestions">
          <i class="fa fa-warning">
          </i>
          <span id="suggestion_message">
          </span>
         </div>
         <fieldset class="form-parent-create_account form-wrapper form-fieldset form-field-pass-wrapper container-inline form-wrapper form-collapsible" id="field-pass-wrapper" name="field-pass-wrapper">
          <div class="fieldset-wrapper">
           <div class="wrapper form-element-wrapper" id="password_hidden-wrapper">
            <span class="form-pass-wrapper form-pass-span">
             <input autcomplete="off" class="form-parent-field-pass-wrapper form-element form-password form-password_hidden boxText validate[required,minSize[5]]" id="create_account_password_hidden" name="password_hidden" placeholder="Password" tabindex="-1" title="Password" type="password" value=""/>
            </span>
           </div>
           <div class="wrapper form-element-wrapper" id="password-wrapper">
            <input autocomplete="off" class="form-parent-field-pass-wrapper form-element form-text form-password boxText validate[required,minSize[5]] pass" id="create_account_password" name="password" placeholder="Password" size="60" style="display: none;" tabindex="4" title="Password" type="text" value=""/>
           </div>
           <div class="wrapper form-element-wrapper" id="hide_password-wrapper">
            <input checked="checked" class="form-parent-field-pass-wrapper form-element form-checkbox form-hide_password form-checkbox" id="create_account_hide_password" name="hide_password" tabindex="5" type="checkbox" value=""/>
            <label class="label-r" for="create_account_hide_password">
             Hide my password
            </label>
           </div>
           <style>
            #hide_password-wrapper{white-space:nowrap;}
           </style>
          </div>
         </fieldset>
         <div class="wrapper form-element-wrapper" id="default_newsletters-wrapper">
          <input class="form-parent-create_account form-element form-checkbox form-default_newsletters form-checkbox" id="create_account_default_newsletters" name="default_newsletters" tabindex="6" type="checkbox" value=""/>
          <label class="label-r" for="create_account_default_newsletters">
           Get the newsletter
          </label>
         </div>
         <div class="alert alert-danger warningText" id="create_account_default_newsletters_info">
          <i class="fa fa-warning">
          </i>
          <span class="warning">
           Subscribe to get the free product of the week!
           One-click unsubscribe later if you don't enjoy the newsletter.
          </span>
         </div>
         <input class="form-parent-create_account form-hidden form-field-form-id" id="field-form-id" name="field-form-id" type="hidden" value="create_account"/>
         <input class="form-parent-create_account form-hidden form-field-form-time" id="field-form-time" name="field-form-time" type="hidden" value="1751112853"/>
         <input class="form-parent-create_account form-hidden form-field-form-token" id="field-form-token" name="field-form-token" type="hidden" value="create_account"/>
        </span>
       </form>
       <div class="submit_button create-account-button alpha omega last">
        <div class="form-button-wrapper form-button-div site-button rounded-corners-button" id="createaccountbutton-wrapper" onmouseup="$(this).find('input').click();" ontouchend="$(this).find('input').click();" style="">
         <input class="site-button rounded-corners-button-text" id="createaccountbutton" name="clicked_element" tabindex="7" type="submit" value="Create Account"/>
        </div>
       </div>
      </link>
     </div>
     <div class="popup-content standardText popup-content-right">
      <div class="last social-buttons-wrapper">
       <a class="site-button btn-facebook" href="https://www.facebook.com/v2.10/dialog/oauth?client_id=1178097535547895&amp;state=4e85d483368b4df5d32aca3125c9d49c&amp;response_type=code&amp;sdk=php-sdk-5.6.1&amp;redirect_uri=https%3A%2F%2Fwww.dmsguild.com%2Ffacebook%2Ffacebook_sign_up_action.php&amp;scope=email%2Cpublic_profile%2Cuser_friends">
        <i class="fa fa-2x fa-facebook">
        </i>
        Log In with Facebook
       </a>
      </div>
     </div>
    </div>
   </div>
   <script type="text/javascript">
    var show_login_return_popup = true;
var show_login_return_message = '';
var _login_validated = false;

// Get ready with the rest of the login.
$(document).ready(function() {
	// Hide login error.
	$('#login_failure_warning').hide();
	// Setup the validation engine. Detach b/c repeated readys.
	$("#login").validationEngine('detach');
	$("#login").validationEngine('detach');
	$("#login").validationEngine('attach', {
		promptPosition: "bottomRight", 
		scroll: false,
		binded: false,
		autoHidePrompt: true, 
		autoHideDelay: 15000,
		ajaxFormValidation: true,
		ajaxFormValidationURL: 'https://www.dmsguild.com/validate_login_credentials.php',
		ajaxFormValidationMethod: 'post',
		onBeforeAjaxFormValidation: beforeAjaxValidationCallback,
		onAjaxFormComplete: afterAjaxValidationCallback
	});

	// This function is triggered at form submission BUT runs repeatedly.
	// Ajax form validation runs for EVERY value and the final form.
	// So here we limit the # of times we call to validate credits.
	function beforeAjaxValidationCallback(form, options) {
		$('#login_failure_warning').hide();
		$('#login').validationEngine('hideAll');
		if (!_login_validated) {
			// Add that we've called to validate the form here.
			_login_validated = true;
			return true;
		}
		// Prevent another call until returned submit.
		return false;
	}

// Called once the server replies to the ajax form validation request
// This is called multiple times, one for each validation round.
// We do NOT want to validate more than once, or submit more than once.
function afterAjaxValidationCallback(status, form, json, options) {
	// Reset the validation state.
	_login_validated = false;
	// Get the error state from the callback.
	var error_state = json[1];
	if (!error_state) {
		var error_message = json[2];
		if (error_message == 'Locked') {
			$('#login_failure_warning .common-error').show();
			$('#login_failure_warning .special-error').hide();
		}
		else {
			$('#login_failure_warning .special-error').html(error_message);
			$('#login_failure_warning .special-error').show();
		}
		$('#login_failure_warning').show();
		setTimeout(function() { $('#from_new_account_popup_text').fadeOut('slow'); }, 5000);
		setTimeout(function() { $('#from_new_account_popup_text').html(''); }, 7000);
		// Return early to avoid submission.
		return;
	}
	// Unbinds, we're about to submit this form.
	$("#loginbutton").css('cursor', 'auto' );
	$("#loginbutton").val("Please Wait");
	$('#loginbutton').off('click');
	$('#loginbutton').off('mouseover');
	$('#loginbutton').removeClass('site-button-hover');
    form.validationEngine('detach');
    $( "#login" )[0].submit();
}

	// When we click on the facebook link a blur event
	// is called on any input we were previously in.
	// This blur is what kicks off validation and err display.
	// So since we want to focus the user on initial page load,
	// we then need to intercept the blur IIF facebook login clicked.
	// Catching it on .click() still gives a split second of the err showing.
	var clicked_element;
    $(document).mousedown(function(event) {
        clicked_element = $(event.target);
    });
    $(document).mouseup(function(event) {
        clicked_element = null;
    });
	$('#login input').blur(function(blur_event) {
		blur_event.stopPropagation();
		// And try to interrupt the blur before it can cause validation.
		$(clicked_element).parents('#fb_login_button').each(function() {
			// So we hide the error display here before continuing.
			// Why inject a style? Because this occurs before blur completes,
			// the error divs aren't in place yet. Since they're non-existent
			// I can't use jquery to select for them to use .hide().
			// So even if the error is triggered, it's automatically hidden.
			var new_style = '<style>div.formError{display:none;}</style>';
			$('#login').before(new_style);
		});
	});
	// End Facebook login JS for errors.

	$('a.login_window').click(function() {
		// Only login a new customer if we started on a shopping cart page.
		var this_location = "" + window.location; // Cast to a string.
		var found = this_location.indexOf('shopping_cart.php');
		// If not found, indexOf() will return a -1.
		if (found == -1) {
			login_returning_customer('0');
		} else {
			login_returning_customer('1');
		}
		return false;
	});

	// click on the close button or the login mask layer to close the popup
	$('a.close').on('click', function() {
		$('#login_mask , .login_popup').fadeOut(300 , function() {
			$('#login_mask').remove();  
		});
	});
	$(document.body).on('click', '#login_mask' ,function(){
		$('#login_mask , .login_popup').fadeOut(300 , function() {
			$('#login_mask').remove();
		});
	});

	// CSS button for submit
	$('#loginbutton').on('click', function(e) {
		$('#login').submit();
	});

	$('#login').submit(function(e){
		if( $(this).hasClass('form-submitted') ){
			e.preventDefault();
			return;
		}
		$(this).addClass('form-submitted');
	});

	$('#loginbutton').on('mouseover', function() {
		$(this).addClass('site-button-hover');
	});

	$('#loginbutton').on('mouseout', function() {
		$(this).removeClass('site-button-hover');
	});

	// Bind this key-press function to the inputs
	$("#login_email_address,#login_password").keypress(function (evt) {
		// Determine where our character code is coming from within the event
		var charCode = evt.charCode || evt.keyCode;
		if (charCode  == 13) {
			// Enter key keycode
			$('#login').submit();
		}
	});
});

function login_returning_customer(checkout_after_login) {
	if (typeof checkout_after_login === 'undefined') {
		checkout_value = '0';
	} else if (typeof checkout_after_login === 'string') {
		checkout_value = checkout_after_login;
	} else {
		checkout_value = checkout_after_login.toString();
	}

	if (document.getElementById("create_account_mask") != null) {
		$('#create_account_mask, .create_account_popup').fadeOut(300 , function() {
			$('#create_account_mask').remove();
		});
	}

	var loginBox = "#login_box";
	var createAccountBox = "#create_account_box";

	//Fade in the Popup
	$(loginBox).fadeIn(300);
	if (!show_login_return_popup) {
		$(createAccountBox).hide();
		$('.login-page .login-message').html(show_login_return_message);
	}

	if (show_login_return_popup) {
		// Set the center alignment padding + border see css style
		var popMargLeft = ($(loginBox).width() + 24) / 2; 
		$(loginBox).css({ 
			'margin-left' : -popMargLeft
		});
		// hack for iPad
		if (navigator.userAgent.match(/iPad/i)) {
			$(loginBox).css({ 
				'margin-left' : 0,
				'left' : 0
			});
		}
		// Add the login mask to body
		$('body').append('<div id="login_mask"></div>');
		$('#login_mask').fadeIn(300);
	}

	if ($("#login_email_address").val().length > 0) {
		$('#login_password').focus();
	} else {
		$('#login_email_address').focus();
	}

	$('form [name="login"] [name="checkout_after_login"]').val(checkout_value);
	$('form [name="create_account"] [name="checkout_after_login"]').val(checkout_value);

	return false;
}

// This method is called if email validation fails.
// It switches the display from the login box to the new customer box
// while maintaining customer input
function switch_to_new_customer() {

	$('.formError').fadeTo(0, 0);

	new_email_value = document.forms["login"].elements["email_address"].value;
	document.forms["create_account"].elements["email_address"].value = new_email_value;
	new_pwd_value = document.forms["login"].elements["login_password"].value;
	document.forms["create_account"].elements["create_account_password_hidden"].value = new_pwd_value;
	document.forms["create_account"].elements["create_account_password"].value = new_pwd_value;

	if ($('#from_login_popup_text').html() == '') {
		$('#from_login_popup_text').append('<br /><br />We could not find an account with that email. Please enter your name to create a new account.');
	}

	login_new_customer();

	return false;
}

function setRedirect(href_link) {
	$('input[name=redirect_url]').val(href_link);
}
   </script>
   <div class="login_popup customer-popup" id="login_box">
    <a class="close" href="#">
     <img alt="Close" class="btn_close" src="../shared_images/popup_close_button.png" title="Close Window"/>
    </a>
    <div class="popup-header">
     <span class="title">
      Log In
      <span class="subtitle boxText">
       (
       <a class="boxText create_account_window" href="#create_account_box" onclick="return false;" tabindex="6">
        I am new here
       </a>
       )
      </span>
     </span>
     <span class="subtitle boxText" id="from_new_account_popup_text">
     </span>
    </div>
    <div class="popup-content-wrapper">
     <div class="popup-content standardText popup-content-left">
      <form accept-charset="UTF-8" action="https://www.dmsguild.com/login.php" class="form-wrapper form-form form-login" enctype="multipart/form-data" id="login" method="POST" name="login">
       <span>
        <input class="form-parent-login form-hidden form-action" id="action" name="action" type="hidden" value="process"/>
        <input class="form-parent-login form-hidden form-origin" id="origin" name="origin" type="hidden" value="returning_customer_popup"/>
        <input class="form-parent-login form-hidden form-checkout_after_login" id="checkout_after_login" name="checkout_after_login" type="hidden" value="0"/>
        <input class="form-parent-login form-hidden form-redirect_url" id="redirect_url" name="redirect_url" type="hidden" value="/?affiliate_id=389627?utm_content=zid-zid"/>
        <div class="wrapper form-element-wrapper" id="email_address-wrapper">
         <input class="form-parent-login form-element form-text form-email_address boxText validate[required,custom[email],ajax[ajaxIsLoginValid]]" id="login_email_address" name="email_address" placeholder="Email" size="60" tabindex="1" title="Email" type="text" value=""/>
        </div>
        <fieldset class="form-parent-login form-wrapper form-fieldset form-field-pass-wrapper container-inline form-wrapper form-collapsible" id="field-pass-wrapper" name="field-pass-wrapper">
         <div class="fieldset-wrapper">
          <div class="wrapper form-element-wrapper" id="password-wrapper">
           <span class="form-pass-wrapper form-pass-span">
            <input autocomplete="off" class="form-parent-field-pass-wrapper form-element form-password form-password boxText validate[required,minSize[5]]" id="login_password" name="password" placeholder="Password" tabindex="2" title="Password" type="password" value=""/>
           </span>
          </div>
          <a class="forgot-password boxText" href="https://www.dmsguild.com/password_forgotten.php" tabindex="7">
           Forgot password?
          </a>
         </div>
        </fieldset>
        <div class="wrapper form-element-wrapper" id="remember_me-wrapper">
         <input class="form-parent-login form-element form-checkbox form-remember_me form-checkbox" id="login_remember_me" name="remember_me" tabindex="3" type="checkbox" value=""/>
         <label class="label-r" for="login_remember_me">
          Remember me
         </label>
        </div>
        <input class="form-parent-login form-hidden form-field-form-id" id="field-form-id" name="field-form-id" type="hidden" value="login"/>
        <input class="form-parent-login form-hidden form-field-form-time" id="field-form-time" name="field-form-time" type="hidden" value="1751112853"/>
        <input class="form-parent-login form-hidden form-field-form-token" id="field-form-token" name="field-form-token" type="hidden" value="login"/>
       </span>
       <input name="login_csrf_code" type="hidden" value="GqPyxPec1VkqqqBW0KLW1asTr7ZKPWsJ"/>
      </form>
      <div class="submit_button login-button alpha omega last">
       <div class="form-button-wrapper form-button-div site-button rounded-corners-button" id="loginbutton-wrapper" onmouseup="$(this).find('input').click();" ontouchend="$(this).find('input').click();" style="">
        <input class="site-button rounded-corners-button-text" id="loginbutton" name="clicked_element" style="vertical-align:middle" tabindex="4" type="submit" value="Log In"/>
       </div>
      </div>
      <div id="login_failure_warning" style="display: none;">
       <span class="warning">
        <span class="common-error boxText" id="login_error_box">
         Error: No match for email address or password.
        </span>
        <br/>
        <span class="special-error boxText">
        </span>
        <br/>
        <a href="https://www.dmsguild.com/password_forgotten.php">
         Password forgotten? Click here.
        </a>
       </span>
      </div>
     </div>
     <div class="popup-content standardText popup-content-right">
      <div class="last social-buttons-wrapper">
       <a class="site-button btn-facebook" href="https://www.facebook.com/v2.10/dialog/oauth?client_id=1178097535547895&amp;state=4e85d483368b4df5d32aca3125c9d49c&amp;response_type=code&amp;sdk=php-sdk-5.6.1&amp;redirect_uri=https%3A%2F%2Fwww.dmsguild.com%2Ffacebook%2Ffacebook_sign_up_action.php&amp;scope=email%2Cpublic_profile%2Cuser_friends">
        <i class="fa fa-2x fa-facebook">
        </i>
        Log In with Facebook
       </a>
      </div>
     </div>
    </div>
   </div>
  </div>
  <script src="../includes/javascript/iscroll/iscroll.js" type="application/javascript">
  </script>
  <script>
   var ajaxQueue = new AjaxQueue();
	var selected_profile = new Array();

	function submit_form(form_name, form_id) {
		if (!form_id || form_id.length === 0 || /^\s*$/.test(form_id)) {
			form_id = form_name;
		}
		// Go to the chek out by default.
		$('#go_to_checkout').val(1);
		// Unless this is a live product.
		if (parseInt($('#cart_live_products').val()) > 0) {
			// set a variable so that the page will not redirect to checkout
			$('#go_to_checkout').val(0);
			$('#' + form_id).attr('action', "checkout_live_profiles.php");
		}
		// And submit.
		$('#' + form_id).submit();
	}


// begin jQuery functions
	(function($) {
		$(document).ready(function() {
		});
	})(jQuery);

// used for jQuery.find() function
	function get_wid_from_pid(pid) {
		find_wid = pid.replace(/\{/g, "\\{");
		find_wid = find_wid.replace(/\}/g, "\\}");
		return find_wid;
	}

// Catches "enter" keypress on quantity fields, updates quantity appropriately
	function catch_quantity_enter(e, pid) {
		var qty = get_qty_from_pid(pid);

		//get current addon settings
		var addon = get_addon_from_pid(pid);
		var addon_type = get_addon_type(pid);

		var code = e.keyCode || e.which;
		if (code == 13) {
			submit_cart_changes(pid, qty, 0, addon, addon_type);
			e.preventDefault();
			return false;
		}
	}

// get the quantity value associated with the given pid
	function get_qty_from_pid(pid) {
		var find_wid = get_wid_from_pid(pid);
		var qty_field = jQuery.find("#qty_" + find_wid)[0];
		var qty = 0;
		if (qty_field) {
			qty = parseInt($(qty_field).val());
		}

		return qty;
	}

//	get the pwyw price value associated with the given pid
	function get_pwyw_price_from_pid(pid) {
		var find_wid = get_wid_from_pid(pid);
		var pwyw_price_field = jQuery.find('#pwyw_price_' + find_wid)[0];
		var pwyw_price = 0;
		if (pwyw_price_field) {
			pwyw_price = parseFloat($(pwyw_price_field).val());
		}

		return pwyw_price;
	}


// get the old (previous) quantity value associated with the given pid
	function get_oldqty_from_pid(pid) {
		var find_wid = get_wid_from_pid(pid);
		var qty_field = $("#qty_" + find_wid)[0];
		var oldqty = 1;
		if (qty_field) {
			oldqty = $(qty_field).attr('oldval');
		}

		return oldqty;
	}

// get the addon value associated with the given pid
	function get_addon_from_pid(pid) {
		var find_wid = get_wid_from_pid(pid);
		var addon_field = $("#addon_checkbox_" + find_wid)[0];
		var addon = '0';

		if (addon_field) {

			if ($(addon_field).attr('checked')) {
				addon = '1';
			}

		} else {

			//this section handles the addon/tuckbox radio buttons
			var radio_input_name = "addon_radio_" + find_wid;
			var selected_option = $("input[name='" + radio_input_name + "']:checked").val();

			if (selected_option == 'SD' || selected_option == 'LD') {
				addon = '1';
			}

		}

		return addon;
	}


// get the addon type for line item
	function get_addon_type(pid) {
		var find_wid = get_wid_from_pid(pid);
		var addon_field = $("#addon_checkbox_" + find_wid)[0];

		if (addon_field) {
			var addon_type = $(addon_field).val();
		} else {

			//this section handles the addon/tuckbox radio buttons
			var radio_input_name = "addon_radio_" + find_wid;
			var selected_option = $("input[name='" + radio_input_name + "']:checked").val();

			if (selected_option == 'SD' || selected_option == 'LD') {
				addon_type = selected_option;
			}

		}

		return addon_type;
	}

	// get the tuckbox value associated with the given pid
	function get_tuckbox_from_pid(pid) {
		var find_wid = get_wid_from_pid(pid);
		var tuckbox_field = $("#tuckbox_checkbox_" + find_wid)[0];
		var tuckbox = '0';
		if (tuckbox_field) {

			if ($(tuckbox_field).attr('checked')) {
				tuckbox = '1';
			}

		} else {

			//this section handles the addon/tuckbox radio buttons
			var radio_input_name = "addon_radio_" + find_wid;
			var selected_option = $("input[name='" + radio_input_name + "']:checked").val();

			if (selected_option == 'SD' || selected_option == 'LD') {
				tuckbox = '0';
			} else if (selected_option > 0) {
				tuckbox = '1';
			}

		}

		return tuckbox;
	}

// get the tuckbox size for line item
	function get_tuckbox_size(pid) {
		var find_wid = get_wid_from_pid(pid);
		var tuckbox_field = $("#tuckbox_checkbox_" + find_wid)[0];

		if (tuckbox_field) {
			var tuckbox_type = $(tuckbox_field).val();
		} else {

			//this section handles the addon/tuckbox radio buttons
			var radio_input_name = "addon_radio_" + find_wid;
			var selected_option = $("input[name='" + radio_input_name + "']:checked").val();

			if (selected_option == 'SD' || selected_option == 'LD') {
				tuckbox_type = '0';
			} else if (selected_option > 0) {
				tuckbox_type = selected_option;
			}

		}

		return tuckbox_type;
	}

// User has typed a number in a quantity text box
	function set_quantity_directly(pid) {
		var qty = get_qty_from_pid(pid);

		//get current addon settings
		var addon = get_addon_from_pid(pid);
		var addon_type = get_addon_type(pid);
		submit_cart_changes(pid, qty, 0, addon, addon_type);
	}


// User has clicked the "-" icon to decrease the quantity by 1
	function set_quantity_decrease(pid) {
		var find_wid = get_wid_from_pid(pid);
		var qty = get_qty_from_pid(pid);
		var decrease_button = $("#decrease_" + find_wid)[0];
		var button_status = $(decrease_button).attr('disabled');
		qty = qty - 1;

		//get current addon settings
		var addon = get_addon_from_pid(pid);
		var addon_type = get_addon_type(pid);

		submit_cart_changes(pid, qty, 0, addon, addon_type);
	}

// User has clicked the "+" icon to increase the quantity by 1
	function set_quantity_increase(pid) {
		var find_wid = get_wid_from_pid(pid);

		var qty;
		qty = get_qty_from_pid(pid, true);

		var increase_button = $("#increase_" + find_wid)[0];
		var button_status = $(increase_button).attr('disabled');
		qty = qty + 1;
		//get current addon settings
		var addon = get_addon_from_pid(pid);
		var addon_type = get_addon_type(pid);

		submit_cart_changes(pid, qty, 0, addon, addon_type);
	}

	// User has changed the pwyw price
	function set_pwyw_price(pid) {
		console.log('setting pwyw');

		//get values
		var qty = get_qty_from_pid(pid);
		var addon = get_addon_from_pid(pid);
		var addon_type = get_addon_type(pid);
		var pwyw_price = get_pwyw_price_from_pid(pid);
		var wishlist = 0;

		//Show spinner
		var find_wid = get_wid_from_pid(pid);
		var pwyw_price_field = jQuery.find('#pwyw_price_' + find_wid)[0];
		$("#pwyw_loading_"+find_wid).show();

		//submit values
		submit_cart_changes(pid, qty, wishlist, addon, addon_type, pwyw_price);
	}

	// Added by Pablo Garca (2014-08-01): User has added a new product to cart from product_listing module
	// Updated by Pablo Garca (2014-08-04): No need for calculate visible qty
	function set_quantity_hidden_increase(pid, qty, callback) {
		submit_cart_hidden_increase(pid, qty, 0, 0, 0, callback);
	}

// User has clicked addon checkbox
// Set addon to value of checkbox
	function set_addon(pid) {
		var qty = get_qty_from_pid(pid);
		var wishlist = 0;
		var new_addon = get_addon_from_pid(pid);
		var addon_type = get_addon_type(pid);
		submit_cart_changes(pid, qty, wishlist, new_addon, addon_type);
	}

// User has clicked the "X" icon to remove the item from the cart
	function remove_item_from_cart(pid) {
		var find_wid = get_wid_from_pid(pid);
		var remove_button = $("#remove_" + find_wid)[0];
		var button_status = $(remove_button).attr('disabled');
		var qty = 0;

		//get current addon settings
		var addon = get_addon_from_pid(pid);
		var addon_type = get_addon_type(pid);

		submit_cart_changes(pid, qty, 0, addon, addon_type);
	}


// User has clicked the "undo" icon to restore an item previously 
// removed the item from the cart
	function undo_remove_item_from_cart(pid) {
		var qty = get_oldqty_from_pid(pid);
		//ignore wishlist
		var wishlist = 0;

		//restore current addon setting
		var addon = get_addon_from_pid(pid);
		var addon_type = get_addon_type(pid);

		submit_cart_changes(pid, qty, 0, addon, addon_type);
	}


// User has clicked the "list" icon to move the item from the cart 
// to the wishlist
	function move_item_to_wishlist(pid) {
		var find_wid = get_wid_from_pid(pid);
		var wishlist_button = $("#wishlist_" + find_wid)[0];
		var button_status = $(wishlist_button).attr('disabled');
		var qty = 0;
		var wishlist = 1;

		//get current addon settings
		var addon = get_addon_from_pid(pid);
		var addon_type = get_addon_type(pid);

		submit_cart_changes(pid, qty, wishlist, addon, addon_type);
	}


// User has clicked the "undo" icon to restore an item previously 
// moved from the cart to the wishlist
	function undo_move_item_to_wishlist(pid) {
		var qty = get_oldqty_from_pid(pid);
		var wishlist = -1;

		//restore current addon setting
		var addon = get_addon_from_pid(pid);
		var addon_type = get_addon_type(pid);

		submit_cart_changes(pid, qty, wishlist, addon, addon_type);
	}

	function add_sw_to_tuckbox_flag(flag_selector) {
		$(flag_selector).fadeTo('slow', 0, function () { $(flag_selector).html('<div class="pricetag"> <span>In Tuckbox and Shrink-wrapped</span> </div>');});
	}

	function remove_sw_from_tuckbox_flag(flag_selector) {
		$(flag_selector).fadeTo('slow', 0, function () { $(flag_selector).html('<div class="pricetag"> <span>In Tuckbox</span> </div>');});
	}

// Javascript sets display to "waiting"
// Javascript submits data to php:
// * product ID
// * new quantity of item
// * wishlist action (1 == move to, 0 == ignore, -1 == move from)
// * new addon setting (1 == addon added by customer, 0 == no addon selected for this product)
// * type of addon for this item (PS, LS, SD, LD, TB)
// PHP returns data to javascript:
// * product IDs
// * old quantity of each item
// * new quantity of each item
// * new addon setting of each item
// * line-item subtotal
// * cart subtotal
// * if bulk book price is in effect
// * if bulk card price is in effect
// Javascript updates displayed text on page
	function submit_cart_changes(pid, qty, wishlist, addon, addon_type, pwyw_price) {
		console.log('submitting cart changes');
		var find_wid = get_wid_from_pid(pid);
		console.log(find_wid);
		var wishlist_button = $("#wishlist_" + find_wid)[0];
		var wishlist_working = $("#wishlist_working_" + find_wid)[0];
		var wishlist_undo = $("#wishlist_undo_" + find_wid)[0];
		var wishlist_text = $("#wishlist_text_" + find_wid)[0];
		var remove_button = $("#remove_" + find_wid)[0];
		var remove_working = $("#remove_working_" + find_wid)[0];
		var remove_undo = $("#remove_undo_" + find_wid)[0];
		var remove_text = $("#remove_text_" + find_wid)[0];
		var qty_field = $("#qty_" + find_wid)[0];
		var decrease_button = $("#decrease_" + find_wid)[0];
		var increase_button = $("#increase_" + find_wid)[0];
		var addon_checkbox = $("#addon_checkbox_" + find_wid)[0];
		var current_qty = get_qty_from_pid(pid);
		qty = parseInt(qty);
		// wishlist == 1 == move to wishlist
		// wishlist == 0 == ignore
		// wishlist == -1 == move from wishlist
		if (typeof wishlist === 'undefined') {
			wishlist = 0;
		} else {
			wishlist = parseInt(wishlist);
		}

		//check for high count unproofed print card approval
		if($('#pod_card_sans_proof').val() == 1) {
			 var pod_card_sans_proof = 1;
		} else {
			var pod_card_sans_proof = 0;
		}
		console.log('pod_card_sans_proof: ' + pod_card_sans_proof);

		// addon = new addon checkbox setting
		if (typeof addon === 'undefined') {
			addon = '0';
		}

		// Javascript sets display to "waiting"
		if (qty == 0) {
			if (wishlist == 1) {
				// move to wishlist
				$(wishlist_button).hide();
				$(wishlist_working).show();
				$(remove_button).attr('disabled', 'disabled');
			} else if (current_qty > 0) {
				// remove from cart
				$(remove_button).hide();
				$(remove_working).show();
				$(wishlist_button).attr('disabled', 'disabled');
			}

			$(qty_field).attr('disabled', 'disabled');
			$(decrease_button).attr('disabled', 'disabled');
			$(increase_button).attr('disabled', 'disabled');
			$(addon_checkbox).attr('disabled', 'disabled');
		} else {
			if (wishlist == -1) {
				// undo move to wishlist
				$(wishlist_working).show();
				$(wishlist_undo).hide();
				$(wishlist_text).hide();
			} else if (current_qty == 0) {
				// undo remove from cart
				$(remove_working).show();
				$(remove_undo).hide();
				$(remove_text).hide();
			}
		}

		updateCart = {
			// Javascript submits data to php: 			// * product ID
			// * new quantity of item
			// * wishlist action (1 == move to, 0 == ignore, -1 == move from)
			// * new addon setting (1 == on, 0 == off)
			// * current addon setting, for undos
			// * type of eligible addon
			data: {
				inputs: find_wid,
				code: 'update',
				qty: qty,
				pwyw_price: pwyw_price,
				wishlist: wishlist,
				addon: addon,
				addon_type: addon_type,
				pod_card_sans_proof: pod_card_sans_proof
			},
			cbScs: function(result) {
				var subtotal = $('#subtotal')[0];
				// Javascript updates displayed text on page
				updateCartWidget(result.cartsize);
				updateWishWidget(result.wishsize);
				document.forms["cart_contents"].elements["cart_live_products_count"].value = result.livecount;
				if (result.livecount > 0) {
					document.forms["cart_contents"].elements["cart_live_products"].value = "1";
				} else {
					document.forms["cart_contents"].elements["cart_live_products"].value = "0";
				}

				if (result.cart_bulk_book_cost > 0) {
					document.getElementById('bulk_discount_message').innerHTML = "Bulk discount pricing applied. <a href=\"https://www.dmsguild.com/pub_pod_cost.php\">Click here</a> for details.";
				} else if (result.cart_contains_high_volume_card > 0) {
					document.getElementById('bulk_discount_message').innerHTML = "High-volume discount pricing applied. <a href=\"https://help.drivethrupartners.com/hc/en-us/articles/12780747991575-Printed-Card-Formats-Costs\">Click here</a> for details.";
				} else {
					document.getElementById('bulk_discount_message').innerHTML = "";
				}

				$(subtotal).text(result.stotal);
var loopcount = 1;
				// loop through return.lineitems array
				for (var index in result.lineitems) {

					var lineitem = result.lineitems[index];
					var lwishlist_wrapper = $('#wishlist_wrapper_' + lineitem.wid)[0];
					var lwishlist_button = $('#wishlist_' + lineitem.wid)[0];
					var lwishlist_working = $('#wishlist_working_' + lineitem.wid)[0];
					var lwishlist_undo = $('#wishlist_undo_' + lineitem.wid)[0];
					var lwishlist_text = $('#wishlist_text_' + lineitem.wid)[0];
					var lremove_wrapper = $('#remove_wrapper_' + lineitem.wid)[0];
					var lremove_button = $('#remove_' + lineitem.wid)[0];
					var lremove_working = $('#remove_working_' + lineitem.wid)[0];
					var lremove_undo = $('#remove_undo_' + lineitem.wid)[0];
					var lremove_text = $('#remove_text_' + lineitem.wid)[0];
					var lqty_field = $('#qty_' + lineitem.wid)[0];
					var ldecrease_button = $('#decrease_' + lineitem.wid)[0];
					var lincrease_button = $('#increase_' + lineitem.wid)[0];
					var lutotal = $('#lutotal_' + lineitem.wid)[0];
					var pwyw_input = $('#pwyw_price_'+lineitem.wid)[0];
					var pwyw_loading = $('#pwyw_loading_'+lineitem.wid)[0];
					var pwyw_success = $('#pwyw_success_'+lineitem.wid)[0];
					var pwyw_error = $('#pwyw_error_'+lineitem.wid)[0];
					var ltotal = $('#ltotal_' + lineitem.wid)[0];
					var ltotal_discount = $('#ltotal_discount_' + lineitem.wid)[0];
					var ltotal_next_discount = $('#ltotal_next_discount_' + lineitem.wid)[0];
					var laddon_text = $('#laddon_text_' + lineitem.wid)[0];
					var laddon_qty = $('#laddon_qty_' + lineitem.wid)[0];
					var laddon_price = $('#laddon_price_' + lineitem.wid)[0];
					var laddon_end_text = $('#laddon_end_text_' + lineitem.wid)[0];
					var laddon_flag = $("#laddon_flag_" + lineitem.wid)[0];
					var laddon_flag2 = $("#laddon_flag_" + lineitem.wid)[0];
					var laddon_checkbox = $("#addon_checkbox_" + lineitem.wid)[0];
					var laddon_div = $("#addon_" + lineitem.wid)[0];
					var ltuckbox_size = $('input[name=tuckbox_' + lineitem.wid + ']').val();

					// resolve flag text, visibility, and related options
					if (lineitem.addon_eligible == 'SW') { //resolve shrink-wrap addon flags

						//update addon checkbox text
						$(laddon_text).html(lineitem.addontext + ' (+ ');

						if (lineitem.qty > 0 && lineitem.oldqty > 0) { //item was already in the cart

							if (lineitem.item_is_high_volume_card > 0 || lineitem.allow_low_volume_shrinkwrap_checkbox_display == '1') { //item is high-volume card or close enough that adding shrink-wrap would push it over the threshhold

									$(laddon_div).fadeTo('slow', 1);
									if (lineitem.addon == '1' && lineitem.old_addon == '0') {
										$("#laddon_flag_" + lineitem.wid).fadeTo('slow', 1, add_sw_to_tuckbox_flag(laddon_flag));
									} else if (lineitem.addon == '0' && lineitem.old_addon == '1') {
										$("#laddon_flag_" + lineitem.wid).fadeTo('slow', 1, remove_sw_from_tuckbox_flag(laddon_flag));
									}

							} else { //item is not a high-volume card

									//update addon flag text
									$("#laddon_flag_" + lineitem.wid).fadeTo('slow', 1, remove_sw_from_tuckbox_flag(laddon_flag));

									//fade the addon checkbox option and deselect it
									$(laddon_div).fadeTo('slow', 0);
									$(laddon_checkbox).attr('checked', false);

							}

						} else if (lineitem.qty > 0 && lineitem.oldqty == 0) { //item was just restored to cart

							if (lineitem.addon == '1') {
								$("#laddon_flag_" + lineitem.wid).fadeTo('slow', 1, add_sw_to_tuckbox_flag(laddon_flag));
							} else if (lineitem.addon == '0') {
								$("#laddon_flag_" + lineitem.wid).fadeTo('slow', 1, remove_sw_from_tuckbox_flag(laddon_flag2));
							}

						}

					} else { //resolve all other addon flags

						//update addon text
						if (lineitem.qty == 1) {

							if (lineitem.addon_eligible == 'SD' || lineitem.addon_eligible == 'LD') { //deckboxes
								$(laddon_text).html(lineitem.addontext + ' (+');
								$(laddon_qty).html(' ');
								$(laddon_end_text).html(')');
							} else if (lineitem.addon_eligible == 'LS' || lineitem.addon_eligible == 'PS') { //screens
								if (result.aorm == '1') {
									$(laddon_text).html(lineitem.addontext + ' (+ ');
								} else {
									$(laddon_text).html(lineitem.addontext + '<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Total ');
								}
								$(laddon_qty).html(' ');
								$(laddon_end_text).html(')');
							}

						} else if (lineitem.qty > 1) {

							if (lineitem.addon_eligible == 'SD' || lineitem.addon_eligible == 'LD') { //deckboxes

								if (lineitem.qty < 100) { //show on single line if below 100
									$(laddon_text).html(lineitem.addontext + ' (+');
								} else {
									$(laddon_text).html(lineitem.addontext + '<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(+');
								}
								$(laddon_qty).html(' '+lineitem.qty+' ');
								$(laddon_end_text).html(')');

							} else if (lineitem.addon_eligible == 'LS' || lineitem.addon_eligible == 'PS') { //screens

								if (result.aorm == '1') {
									$(laddon_text).html(lineitem.addontext + ' (+ ');
								} else {
									$(laddon_text).html(lineitem.addontext + '<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Total ');
								}
								$(laddon_qty).html(' '+lineitem.qty+' ');
								$(laddon_end_text).html(')');

							}

							if (lineitem.addon == '1' && lineitem.old_addon == '0') {
								$(laddon_flag).fadeTo('slow', 1);
							} else if (lineitem.addon == '0' && lineitem.old_addon == '1') {
								$(laddon_flag).fadeTo('slow', 0);
							}

						}

						if (lineitem.qty == lineitem.oldqty) {

							if (lineitem.addon == '1' && lineitem.old_addon == '0') {
								$(laddon_flag).fadeTo('slow', 1);
							} else if (lineitem.addon == '0' && lineitem.old_addon == '1') {
								$(laddon_flag).fadeTo('slow', 0);
							}

						} else if (lineitem.qty == 0 && lineitem.oldqty > 0) {

							//removed from cart or moved to wishlist
							if (lineitem.addon == '1') {
								$(laddon_flag).fadeTo(0, .2);
							}
							//but hide the addon checkbox if not high-volume
							if (result.cart_high_volume_card_cost == 0) {
								$(laddon_div).hide();
							}

						}

					}

					// update wishlist and remove buttons, and
					// fade row in or out, as appropriate
					if (lineitem.qty == 0) {

						if (lineitem.wishlist == 1) {

							// moved to wishlist
							$(lremove_wrapper).addClass('fade');
							var faded_items = $('#row_' + lineitem.wid + ' div.fade');
							if (lineitem.wisherror) {

								$(faded_items).fadeTo('slow', 1);
								$(lwishlist_working).hide();
								$(lwishlist_button).show();
								$(lqty_field).removeProp('disabled');
								$(laddon_checkbox).removeProp('disabled');
								$(lwishlist_text).html(lineitem.wisherror);
								$(lwishlist_text).show();

							} else {

								$(faded_items).fadeTo(0, .2);

								//rehide addon flag as appropriate (it is inside lwishlist_wrapper div)
								if (lineitem.tuckbox_size == '0') { //for decks without tuckboxes, the addon flag visibility depends on the addon checkbox

									if (lineitem.addon == '1') { //addon was checked, so show the flag faded
										$(laddon_flag).fadeTo(0, .2);
									} else { //addon was not checked, so hide flag entirely
										$(laddon_flag).fadeTo(0, 0);
									}

								} else { //for decks with tuckboxes, the addon flag remains visible

									$(laddon_flag).fadeTo(0, .2);
									//but hide the addon checkbox if not high-volume and still would not be if addon was checked
									if (lineitem.item_is_high_volume_card == '0' || lineitem.allow_low_volume_shrinkwrap_checkbox_display == '0') {
										$(laddon_div).hide();
									}

								}

								$(lwishlist_working).hide();
								$(lwishlist_undo).show();
								$(lwishlist_text).show();

							}

						} else if (lineitem.oldqty > 0 && !lineitem.wisherror) {

							// removed from cart
							$(lwishlist_wrapper).addClass('fade');
							var faded_items = $('#row_' + lineitem.wid + ' div.fade');
							$(faded_items).fadeTo(0, .2);

							//rehide addon flag as appropriate (it is inside lwishlist_wrapper div)
							if (lineitem.tuckbox_size == '0') { //for decks without tuckboxes, the addon flag visibility depends on the addon checkbox

								if (lineitem.addon == '1') { //addon was checked, so show the flag faded
									$(laddon_flag).fadeTo(0, .2);
								} else { //addon was not checked, so hide flag entirely
									$(laddon_flag).fadeTo(0, 0);
								}

							} else { //for decks with tuckboxes, the addon flag remains visible

								$(laddon_flag).fadeTo(0, .2);
								//but hide the addon checkbox if not high-volume and still would not be if addon was checked
								if (lineitem.item_is_high_volume_card == '0' || lineitem.allow_low_volume_shrinkwrap_checkbox_display == '0') {
									$(laddon_div).hide();
								}

							}

							$(lremove_working).hide();
							$(lremove_undo).show();
							$(lremove_text).show();
							$(lwishlist_text).hide();

						}

					} else {

						if (lineitem.wishlist == -1) {

							// undone move to wishlist
							var faded_items = $('#row_' + lineitem.wid + ' div.fade');
							$(lremove_wrapper).removeClass('fade');
							$(faded_items).fadeTo(0, 1);

							$(lwishlist_working).hide();
							$(lwishlist_button).show();
							$(lremove_button).removeAttr('disabled');
							$(lqty_field).removeProp('disabled');
							$(ldecrease_button).removeAttr('disabled');
							$(lincrease_button).removeAttr('disabled');
							$(laddon_checkbox).removeProp('disabled');

							//show addon flag as appropriate (it is inside lwishlist_wrapper div)
							if (lineitem.tuckbox_size == '0') { //for decks without tuckboxes, the addon flag visibility depends on the addon checkbox

								if (lineitem.addon == '1') { //addon was checked, so show the flag faded
									$(laddon_flag).fadeTo(0, 1);
								} else { //addon was not checked, so continue to hide flag entirely
									$(laddon_flag).fadeTo(0, 0);
								}

							} else { //for decks with tuckboxes, the addon is always visible

								//force correct shrink-wrap message if addon = 0
								if (lineitem.addon == '0') {
									$("#laddon_flag_" + lineitem.wid).fadeTo('slow', 1, remove_sw_from_tuckbox_flag(laddon_flag));
								}

								$(laddon_flag).fadeTo(0, 1);
								//but hide the addon checkbox if not high-volume and still would not be if addon was checked
								if (lineitem.item_is_high_volume_card == '0' || lineitem.allow_low_volume_shrinkwrap_checkbox_display == '0') {
									$(laddon_div).hide();
								}


							}

						} else if (lineitem.wishlist == 0 && lineitem.wisherror) {

							//move to wishlist clicked when not logged in
							$(lwishlist_working).hide();
							$(lwishlist_button).show();
							$(lremove_button).removeAttr('disabled');
							$(lqty_field).removeProp('disabled');
							$(ldecrease_button).removeAttr('disabled');
							$(lincrease_button).removeAttr('disabled');
							$(laddon_checkbox).removeProp('disabled');
							if (lineitem.wisherror) {
								$(lwishlist_text).html(lineitem.wisherror);
								$(lwishlist_text).show();
							}

						} else if (lineitem.oldqty == 0) {

							// undone remove from cart
							var faded_items = $('#row_' + lineitem.wid + ' div.fade');
							$(lwishlist_wrapper).removeClass('fade');
							$(faded_items).fadeTo(0, 1);

							//rehide addon flag as appropriate (it is inside lwishlist_wrapper div)
							if (lineitem.tuckbox_size == '0') { //for decks without tuckboxes, the addon flag visibility depends on the addon checkbox

								if (lineitem.addon == '1') { //addon was checked, so show the flag
									$(laddon_flag).fadeTo(0, 1);
								} else { //addon was not checked, so hide flag entirely
									$(laddon_flag).fadeTo(0, 0);
								}

							} else { //for decks with tuckboxes, the addon flag remains visible

								//force correct shrink-wrap message if addon = 0
								if (lineitem.addon == '0') {
									$("#laddon_flag_" + lineitem.wid).fadeTo('slow', 1, remove_sw_from_tuckbox_flag(laddon_flag));
								}

								$(laddon_flag).fadeTo(0, 1);
								//but hide the addon checkbox if not high-volume and still would not be if addon was checked
								if (lineitem.item_is_high_volume_card == '0' || lineitem.allow_low_volume_shrinkwrap_checkbox_display == '0') {
									$(laddon_div).hide();
								}

							}

							$(lremove_working).hide();
							$(lremove_button).show();
							$(lwishlist_button).removeAttr('disabled');
							$(lqty_field).removeProp('disabled');
							$(ldecrease_button).removeAttr('disabled');
							$(lincrease_button).removeAttr('disabled');
							$(laddon_checkbox).removeProp('disabled');

						}

					}

					// store the old quantity into an attribute for later
					if (lineitem.oldqty != lineitem.qty) {
						$(lqty_field).attr('oldval', parseInt(lineitem.oldqty));
					}

					// update addon price
					$(laddon_price).text(lineitem.addontotal);

					// update quantity
					$(lqty_field).val(lineitem.qty);
					// update line-item unit price
					if (pwyw_input) {
						$(lutotal).attr('item_price',parseFloat(/\d*\.?\d+/gm.exec(lineitem.lutotal)));
						var orig_val = parseFloat($(pwyw_input).val());
						$(pwyw_input).val(lineitem.lutotal.substring(1));
						var new_val = parseFloat($(pwyw_input).val());
						if ($(pwyw_loading).is(':visible')) {
							//hide spinner, show checkbox for 1 second, then fade out.
							$(pwyw_loading).hide();
							if (orig_val == new_val) {
								$(pwyw_success).show().delay(1000).fadeOut();
							} else {
								$(pwyw_error).show().delay(1000).fadeOut();
							}
						}
					} else {
						var spaces = '\u00a0\u00a0\u00a0\u00a0';
						var new_lutotal = 'X' + spaces + lineitem.lutotal + spaces + '=';
						$(lutotal).text(new_lutotal);
					}
                    var lutotal_number = parseFloat(/\d*\.?\d+/gm.exec(lineitem.lutotal));
                    if(lutotal_number) {
                        $(lutotal).attr('item_price', lutotal_number);
                    }
					// update line-item subtotal
					$(ltotal).text(lineitem.ltotal);

					// resolve print card discount text
					if (lineitem.item_is_high_volume_card == '1') { // this line item is a print card with high-volume discount applied
						$(ltotal_discount).html(lineitem.high_volume_card_discount_amount_for_display + ' discount<br />(' + lineitem.high_volume_card_discount_percentage + '%)');
					} else {
						$(ltotal_discount).html('');
					}

					// resolve print card next discount level text
					if (lineitem.high_volume_card_next_discount_level > 0) { // this line item is a print card eligible for the next level of high-volume discount
						$(ltotal_next_discount).html('Next high-volume<br />discount level at<br />' + lineitem.high_volume_card_next_discount_level + ' decks');
					} else {
						$(ltotal_next_discount).html('');
					}

                    var ltotal_number = parseFloat(/\d*\.?\d+/gm.exec(lineitem.ltotal));
                    if(ltotal_number) {
                        $(ltotal).attr('item_price', ltotal_number);
                    }

				}
				// Update the checkout form message and buttons.
				if (result.checkout == true) {
					enable_checkout(result.checkout_messages);
				}
				else {
					disable_checkout(result.checkout_messages);
				}

			}
		};
		ajaxQueue.schedule(updateCart);
	}

	function enable_checkout(message) {
		// Set message and div visibility
		$('#card_and_book_message').html(message);

		if (message != '') {
			$('#card_and_book_message').css('display', 'block');
		} else {
			$('#card_and_book_message').css('display', 'none');
		}
		// Show button, enable click.
		$('#cartcheckoutbutton.user-logged-in .site-button').css('cursor', 'pointer').prop('disabled', false);
		$('#cartcheckoutbutton-footer.user-logged-in .site-button').css('cursor', 'pointer').prop('disabled', false);
		$('#cartcheckoutbutton.user-logged-in').click(function() {
			submit_form('cart_contents');
			}).fadeTo(1, 1);
		$('#cartcheckoutbutton-footer.user-logged-in').click(function() {
			submit_form('cart_contents');
			}).fadeTo(1, 1);
	}

	function disable_checkout(message) {
		// Set message.
		$('#card_and_book_message').html(message);

		if (message != '') {
			$('#card_and_book_message').css('display', 'block');
		} else {
			$('#card_and_book_message').css('display', 'none');
		}
		// Show button, disable click.
		$('#cartcheckoutbutton.user-logged-in .site-button').css('cursor', 'auto').prop('disabled', true);
		$('#cartcheckoutbutton-footer.user-logged-in .site-button').css('cursor', 'auto').prop('disabled', true);
		$('#cartcheckoutbutton.user-logged-in').click('').fadeTo(1, 0.4);
		$('#cartcheckoutbutton-footer.user-logged-in').click('').fadeTo(1, 0.4);
	}

	function submit_cart_hidden_increase(pid, qty, wishlist, addon, addon_type, callback) {
		var find_wid = get_wid_from_pid(pid);
		increaseCart = {
			// Javascript submits data to php:
			// * Product ID
			// * Quantity always be increased in +1
			data: {
				inputs: find_wid,
				code: 'increase',
				qty: qty,
				wishlist: wishlist,
				addon: addon,
				addon_type: addon_type
			},
			cbScs: function(result) {
				//if cartsize is undefined or otherwise not a number, set to 1
				// since we presume at least one item has just been added to cart
				if(result.cartsize) {
					if(isNaN(result.cartsize)) {
						result.cartsize = 1;
					}
				} else {
					result.cartsize = 1;
				}
				updateCartWidget(result.cartsize);
				if (typeof callback === "function")
					callback();
			}
		};
		existingConfig = ajaxQueue._config;
		ajaxQueue.init({target:"/includes/ajax/cart_processor.php"});
		ajaxQueue.schedule(increaseCart);
		ajaxQueue.init(existingConfig);	}
  </script>
  <script>
   var iScrollers = {};
	var lazySliders = {};

	var lazySliderBox = function(opts){
		var elem_id = opts.elem_id,
			old_api_compatibility = opts.old_api_compatibility,
			$elem = $('#' + elem_id),
			view_type = opts.view_type,
			hide_if_empty = opts.hide_if_empty ? opts.hide_if_empty:false ,
			old_api_view_type,
			$content,
			item_size = 142,
			force_recache=false;

		//url could already have params
		var split_url = opts.api_url.split('?');
		var params = split_url[1] || '';

		if (location.search.indexOf('force_recache=1') !== -1) {
			console.log('force_recache ON');
			force_recache = true;
		}

		//TODO: This can be adapted after migratting to the new lazySliderBox
		if (old_api_compatibility){
			var api_url = split_url[0];
		} else {
			var api_url = (split_url[0].slice(-1) != '/')?split_url[0] + '/':split_url[0];
		}

		var init_options = {};
		if (params != ''){
			var split_params = params.split('&');
			for(var i in split_params){
				var param_name = split_params[i].split('=')[0];
				var param_value = split_params[i].split('=')[1];
				init_options[param_name] = param_value;

				//Old api compat:
				if(old_api_compatibility && param_name === 'view_strip'){
					old_api_view_type = param_value;
				}
			}
		};

		//Private methods:
		var addClickEvent = function(){
			var iScrollerIndex = $(this).closest('.strip_content').attr("id");
			var iScroller = iScrollers[iScrollerIndex];

			$(this).unbind('click');
			if (!iScroller.busy){
				$(this).hide();
				$(this).parent().find(".owl-next-spinner").show();
				iScroller.busy = true;
				iScroller.loading = false;
				// Supress hard bounces
				var distance = $(iScroller.wrapper).find(".scroller").width() - Math.abs(iScroller.x);
				var wrapperWidth = $(iScroller.wrapper).innerWidth();
				var numItemsWrapper = Math.floor(wrapperWidth / item_size);
				var anchoItemsWrapper = numItemsWrapper * item_size;

				if ((distance - anchoItemsWrapper) < anchoItemsWrapper) {
					iScroller.scrollTo(iScroller.x - (distance - anchoItemsWrapper), 0, 500, IScroll.utils.ease.quadratic);
				} else {
					iScroller.scrollTo(iScroller.x - anchoItemsWrapper, 0, 500, IScroll.utils.ease.quadratic);
				}
				return false;
			}
		}

		var initToolTips = function(){
			$content.find('a[rel*="includes/ajax/tooltip_request_handler.php?products_id="]').each(function () {
				$(this).qtip({
					content: {
						text: '<div style="background: transparent;"><i class="fa fa-spinner fa-pulse" ></i></div>',
						ajax: {
							url: $(this).attr('rel') + '&view_strip=' + view_type,
							type: 'GET',
							data: {},
							success: function (data) {
								content = data;
								this.set('content.text', content);
							}
						}
					},
					position: {
						target: $(this).children()[0],
						my: 'bottom left',
						at: 'top right',
						adjust: {
							method: 'flip',
							x: 5,
							y: 5
						},
						viewport: $(window),
						effect: false
					},
					show: {
						event: 'mouseover',
						solo: true
					},
					hide: {
						event: 'mouseout'
					},
					style: {
						classes: 'qtip-light qtip-shadow qtip-rounded',
						tip: {
							corner: true,
							offset: 5
						}
					}
				})
			});
		};

		var initSliderIScroller = function(){
			var id_index = $elem.attr('id');
			iScrollers[id_index] = new IScroll("#" + $elem.find('.owl-carousel').attr('id'), {
				scrollX: true,
				scrollY: false,
				mouseWheel: false,
				desktopCompatibility: true,
				eventPassthrough: true
			});

			iScrollers[id_index].busy = false;
			iScrollers[id_index].loading = false;

			// PG: We'll use here and into event closures
			var _this = iScrollers[id_index];

			// PG: Initial state of the arrow buttons
			if (Math.abs(_this.x) > 0) {
				$(_this.wrapper).find(".owl-prev").show();
			} else {
				$(_this.wrapper).find(".owl-prev").hide();
			}

			if (Math.abs(_this.x) < Math.abs(_this.maxScrollX)) {
				$(_this.wrapper).find(".owl-prev").hide();
			} else {
				$(_this.wrapper).find(".owl-next").hide();
				$(_this.wrapper).find(".owl-next-spinner").show();
				iScrollers[id_index].busy = true;
			}

			$(_this.wrapper).find('.owl-prev').on('click', function() {
				// Supress bounces
				if (Math.abs(_this.x + $(_this.wrapper).width()) > $(_this.wrapper).width()){
					_this.scrollTo(_this.x + $(_this.wrapper).width(), 0, 500, IScroll.utils.ease.quadratic);
				} else {
					_this.scrollTo(0, 0, 500, IScroll.utils.ease.quadratic);
				}
				return false;
			});

			$(_this.wrapper).find('.owl-next').bind('click', addClickEvent);

			//  PG: Is an event from the object, not of the $(wrapper)
			_this.on("scrollEnd", function() {
				if (Math.abs(this.x) > 0) {
					$(this.wrapper).find(".owl-prev").show();
				} else {
					$(this.wrapper).find(".owl-prev").hide();
				}

				if (Math.abs(_this.x) < Math.abs(_this.maxScrollX)) {
					$(this.wrapper).find(".owl-next").show();
					$(this.wrapper).find(".owl-next-spinner").hide();
					iScrollers[id_index].busy = false;
					$(this.wrapper).find(".owl-next").bind('click', addClickEvent);
				} else {
					if(!iScrollers[id_index].loading){
						var el = this.wrapper,
							li,
							_current_iscroll = this;

						// Pablo Garca (2014-05-20): Item from wich we request
						var item_from = $(el).find('.scroller ul li').length;
						var page_params = {
							index: item_from
						};
						if(old_api_compatibility){
							page_params.item_strip = item_from;
						}

						$(_current_iscroll.wrapper).find(".owl-next").unbind('click').hide();
						$(_current_iscroll.wrapper).find(".owl-next-spinner").show();
						iScrollers[id_index].busy = true;
						iScrollers[id_index].loading = true;

						api_call(page_params, function(new_content){
							if(/\w+/.test(new_content)){
								var $new_content = $(new_content);
								var total_lenght = $new_content.length + $(el).find('.scroller').find('li').length;
								$new_content.each(function(){
									$(el).find('.scroller ul').append($(this));
									_current_iscroll.refresh();
								}).promise().done(function(){
									$(el).find('.scroller').css('width', total_lenght * item_size);
									_current_iscroll.refresh();
									$(_current_iscroll.wrapper).find(".owl-next-spinner").hide();
									$(_current_iscroll.wrapper).find(".owl-next").show();
									iScrollers[id_index].busy = false;
									iScrollers[id_index].loading = false;
									$(_current_iscroll.wrapper).find(".owl-next").bind('click', addClickEvent);
								});

								initToolTips();

								$elem.find('.owl-item').find('h1.smallH1 a').each(function() {
									$(this).ellipsis({
										row: 2
									});
								});
								$elem.find('li.smallText, div.smallText').find('h1.smallH1 a').each(function() {
									$(this).ellipsis({
										row: 2
									});
								});
							} else{
								$(_current_iscroll.wrapper).find(".owl-next").hide();
								$(_current_iscroll.wrapper).find(".owl-next-spinner").hide();
								iScrollers[id_index].busy = false;
								if(iScrollers[id_index].loading) {
									iScrollers[id_index].loading = false;
								}
							}
						});
					}
				}
			});

			$elem.find('.product_price_list_mode').each(function() {
				if ($(this).find('s').length > 0) {
					$(this).parent().find('.product_name_list_mode').css('max-width', '150px');
				}
			});
			$elem.find('a.product_name_list_mode').each(function() {
				var width_price_div = $(this).closest('li').find('.product_price_list_mode').width();
				$(this).css('float', 'right');
				$(this).width(205 - width_price_div);
			});
			$elem.find('.owl-item').find('h1.smallH1 a').each(function() {
				$(this).ellipsis({
					row: 2
				});
			});
			$elem.find('li.smallText, div.smallText').find('h1.smallH1 a').each(function() {
				$(this).ellipsis({
					row: 2
				});
			});
		};

		var api_call = function(opts, callback){
			var page_params = {};
			
			if (force_recache === true) {
				page_params.force_recache = '1';
			}
			var options = jQuery.extend(true, {}, init_options, opts, page_params);

			$.get(api_url + view_type, options, callback);
		};

		//Public methods:

		var object = {};

		object.set_view_type = function(new_view_type){
			if(old_api_compatibility){
				old_api_view_type = new_view_type;
			} else {
				view_type = new_view_type || '';
			}
		};

		object.update = function(opts, callback){
			$elem.css({height: $elem.outerHeight() + 'px'});
			$elem.fadeOut('fast').html('<div class="loader_spinner" style="margin-top: 10px; text-align: center"><img width="150px" src="https://www.dmsguild.com/shared_images/ajax-loader.gif"/></div>').fadeIn('fast').animate({height: '200px'});

			api_call(opts, this.load);
		};

		object.adjust_size = function(){
			if(typeof $content != 'undefined') {
				$content.find('div.owl-products-carousel, div.owl-products-carousel-between-columns').each(function () {
					var $elems = $(this).find('ul li');
					var num_elems = $elems.length;
					$(this).find('.scroller').width(num_elems * $elems.eq(0).outerWidth());
					$(this).outerWidth($elem.prevAll('.infoBoxHeading:first').outerWidth() - 5);

					$(this).attr('id', 'iScroll_' + elem_id);
				});
			}
		};

		object.load = function (content) {
			$content = $(content);

			object.adjust_size();
			initToolTips();

			$elem.html($content);
			$elem.css('height', 'auto');

			if (view_type == 'slider_view'
					|| (old_api_compatibility && old_api_view_type == 'slider_view')) {
				initSliderIScroller();
			}

			$numItems = $content[1].getElementsByTagName('li').length;

			if(hide_if_empty && $numItems == 0){
				$elem.parent().hide();
			}

			$elem.find('.loader_spinner').parent().hide();
		};

		return object;
	}

	$(window).resize(function() {
		if(typeof lazySliders != 'undefined') {
			$.when($('.strip_content').hide(0)).then(function(){
				for (var i in lazySliders){
					lazySliders[i].adjust_size();
				}
				$('.strip_content').show();
			});
		}
	});

	$(window).ready(function() {
		// Changelog feature: When user clicks on read more for a long changelog, show it.
		// Hide all other shown chagelogs.
		$('.changelog_row_show').on('click',function(e) {
			e.preventDefault();
			alert('Found the event');
			var id = $(this).attr('id');
			// Hide all larger texts.
			$('.changelog_row_txt_hide').hide();
			// Show the selected large text.
			$('#' + id + '_hide').show();
			// Show the smaller display for all the others.
			$('.changelog_row_txt_show').show();
			// Hide the smaller display for the selected one.
			$('#' + id + '_show').hide();
			return false;
		});
		// Changelog feature: When user clicks to see the changelog, show it.
		$('.changelog_display_show a').on('click',function() {
			var id = $(this).attr('id');
			// Hide the click to show.
			$('.changelog_display_show').hide();
			// Show the log.
			$('.changelog_display_hide').show();
			return false;
		});
		// Changelog feature: When user clicks to hide the changelog, hide it.
		$('.changelog_display_hide a').on('click',function() {
			var id = $(this).attr('id');
			// Hide the click to show.
			$('.changelog_display_show').show();
			// Show the log.
			$('.changelog_display_hide').hide();
			return false;
		});

		$('body').trigger('scroll');
	});

	function QueryStringToJSON(url) {
		var pairs = url.split('&');
		var result = {};
		if (pairs instanceof Array) {
		  $(pairs).each(function(pair) {
			  pair = $(pair).text();
			  pair = pair.split('=');
			  result[pair[0]] = decodeURIComponent(pair[1] || '');
		  });
		}
		if (!checkQuestioStringToJSON(result)) {
			result = QueryStringToJSONAlternative(url)
		}
	  if ("JSON" in window) {
		return JSON.parse(JSON.stringify(result));
	  }
	  return url;
	}

	/*
		Jos Ignacio 2015-01-16
		In some cases the above function returns {=""}
		This function for now only check that
	 */
	function checkQuestioStringToJSON(object) {
		var object_length = Object.keys(object).length;
		if (object_length == 0) {
			return false;
		} else if (object_length == 1) {
			for(key in object){
				var val = object[key];
				if (key=="" && val=="") {
					return false;
				}
			}
		}

		return true;
	}

	// this is the old function which works fine with several browsers
	function QueryStringToJSONAlternative(url) {
		var pairs = url.split('&');

		var result = {};
		pairs.forEach(function(pair) {
			pair = pair.split('=');
			result[pair[0]] = decodeURIComponent(pair[1] || '');
		});

		return JSON.parse(JSON.stringify(result));
	}

	function switchToMobile(url){
		$.get('/includes/ajax/switch_to_mobile.php',"",function(){
			window.location.href = url;
		});
	}

	var query_string = QueryStringToJSON(window.location.href);
  </script>
  <script src="../includes/javascript/animated_add_to_cart.js">
  </script>
  <script type="text/javascript">
   function ajax_record_sales_analytics_event(data) {
        let url = '/includes/ajax/analytics.php?';
        $.each(data, function(index,value){
            url = url + index + '=' + value + '&';
        });
        //ajax call to record sales analytics event
        $.ajax({
            url: url
        });
    }

    $(function() {
        // Catch clicks on products from inside a titlestrip.
        $('body').on('click', '.titlestrip_link', function(e) {
            let event_tag = 'view-product-from-titlestrip';
            let src = $(this).attr('href').substring($(this).attr('href').indexOf('src=')+4);
            if (src == 'also_purchased' || src == 'cab_col') {
                event_tag = 'view-product-from-alsopurchased';
            }
            ajax_record_sales_analytics_event({
                origin: 'legacy',
                event_tag: event_tag,
                page: '/index.php',
            }); 
        });
    });
  </script>
  <!-- header_eof -->
  <!-- body -->
  <table border="0" cellpadding="3" cellspacing="0" width="100%">
   <tr>
    <td valign="top" width="245">
     <table border="0" cellpadding="2" cellspacing="0" class="left_column_container" width="245">
      <!-- left_navigation -->
      <tr>
       <td class="col_left_content">
        <div class="widget-nav">
         <div class="widget-nav-title">
          Browse Categories
         </div>
         <a href="https://www.dmsguild.com/sale.php?&amp;filters=0_0_0_0_0_1000559">
          <div class="grid_10 alpha omega widget-nav-item">
           <div class="widget-nav-item-title" id="nav-D&amp;D Summer of Adventure">
            <font color="red">
             <strong>
              D&amp;D Summer of Adventure
             </strong>
            </font>
           </div>
          </div>
          <div class="clear">
          </div>
         </a>
         <div class="grid_10 alpha omega widget-nav-item">
          <div class="widget-nav-item-title" id="nav-content" style="">
           Content
           <span class="widget-nav-item-title-icon widget-nav-item-title-icon-close" height="15px" id="nav-icon-content">
           </span>
          </div>
          <div class="widget-nav-item-content">
           <div id="more-hider-f45468" style="min-width: 145px; display: none;">
            <ul class="widget-nav-item-list">
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=45469_0_0_0_0_0_0_0&amp;src=fid45469">
                 DMsGuild
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=45680_0_0_0_0_0_0_0&amp;src=fid45680">
                 Guild Adept
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=45470_0_0_0_0_0_0_0&amp;src=fid45470">
                 D&amp;D Adventurers League
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=45471_0_0_0_0_0_0_0&amp;src=fid45471">
                 D&amp;D Classics
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
            </ul>
           </div>
          </div>
         </div>
         <div class="clear">
         </div>
         <div class="grid_10 alpha omega widget-nav-item">
          <div class="widget-nav-item-title" id="nav-storyline" style="">
           Storyline
           <span class="widget-nav-item-title-icon" height="15px" id="nav-icon-storyline">
           </span>
          </div>
          <div class="widget-nav-item-content">
           <div id="more-hider-f45472" style="min-width: 145px; display: none;">
            <ul class="widget-nav-item-list">
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_1000161_0_0_0_0_0_0&amp;src=fid1000161">
                 Planescape
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_1000159_0_0_0_0_0_0&amp;src=fid1000159">
                 Phandelver &amp; Below
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_1000198_0_0_0_0_0_0&amp;src=fid1000198">
                 Vecna: Eve of Ruin
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_1000068_0_0_0_0_0_0&amp;src=fid1000068">
                 Dragonlance
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_100023_0_0_0_0_0_0&amp;src=fid100023">
                 Rime of the Frostmaiden
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_45728_0_0_0_0_0_0&amp;src=fid45728">
                 Waterdeep
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_45507_0_0_0_0_0_0&amp;src=fid45507">
                 Curse of Strahd / Van Richten
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_1000055_0_0_0_0_0_0&amp;src=fid1000055">
                 Previous Storylines
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
            </ul>
           </div>
          </div>
         </div>
         <div class="clear">
         </div>
         <div class="grid_10 alpha omega widget-nav-item">
          <div class="widget-nav-item-title" id="nav-product-type" style="">
           Product Type
           <span class="widget-nav-item-title-icon widget-nav-item-title-icon-close" height="15px" id="nav-icon-product-type">
           </span>
          </div>
          <div class="widget-nav-item-content">
           <div id="more-hider-f45341" style="min-width: 145px; display: none;">
            <ul class="widget-nav-item-list">
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_45393_0_0_0_0_0&amp;src=fid45393">
                 Adventures
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_45381_0_0_0_0_0&amp;src=fid45381">
                 Core Rules
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_45463_0_0_0_0_0&amp;src=fid45463">
                 Bundles
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_45397_0_0_0_0_0&amp;src=fid45397">
                 Character Options
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_45396_0_0_0_0_0&amp;src=fid45396">
                 Gear/Magic Items
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_45476_0_0_0_0_0&amp;src=fid45476">
                 Resources for DMG Creators
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_45384_0_0_0_0_0&amp;src=fid45384">
                 RPG Media
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_45383_0_0_0_0_0&amp;src=fid45383">
                 Tabletop Essentials
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_45385_0_0_0_0_0&amp;src=fid45385">
                 Board/Miniature Games
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_45386_0_0_0_0_0&amp;src=fid45386">
                 Gift Certificates
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
            </ul>
           </div>
          </div>
         </div>
         <div class="clear">
         </div>
         <div class="grid_10 alpha omega widget-nav-item">
          <div class="widget-nav-item-title" id="nav-theme" style="">
           Theme
           <span class="widget-nav-item-title-icon" height="15px" id="nav-icon-theme">
           </span>
          </div>
          <div class="widget-nav-item-content">
           <div id="more-hider-f45423" style="min-width: 145px; display: none;">
            <ul class="widget-nav-item-list">
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_45531_0_0_0_0&amp;src=fid45531">
                 Aquatic
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_100018_0_0_0_0&amp;src=fid100018">
                 Arctic
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_45747_0_0_0_0&amp;src=fid45747">
                 Dungeon
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_45532_0_0_0_0&amp;src=fid45532">
                 Planar
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_45534_0_0_0_0&amp;src=fid45534">
                 Underdark/Subterranean
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_45422_0_0_0_0&amp;src=fid45422">
                 Urban
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_45535_0_0_0_0&amp;src=fid45535">
                 Wilderness
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_45749_0_0_0_0&amp;src=fid45749">
                 Comedy
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_45748_0_0_0_0&amp;src=fid45748">
                 Family Oriented
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_45751_0_0_0_0&amp;src=fid45751">
                 Festive
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_45744_0_0_0_0&amp;src=fid45744">
                 Horror
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_45745_0_0_0_0&amp;src=fid45745">
                 Intrigue
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_45746_0_0_0_0&amp;src=fid45746">
                 Mystery
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_45750_0_0_0_0&amp;src=fid45750">
                 Pulp Action
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_45752_0_0_0_0&amp;src=fid45752">
                 Solo/Single-Player
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_1000267_0_0_0_0&amp;src=fid1000267">
                 Feywild
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
            </ul>
           </div>
          </div>
         </div>
         <div class="clear">
         </div>
         <div class="grid_10 alpha omega widget-nav-item">
          <div class="widget-nav-item-title" id="nav-setting" style="">
           Setting
           <span class="widget-nav-item-title-icon" height="15px" id="nav-icon-setting">
           </span>
          </div>
          <div class="widget-nav-item-content">
           <div id="more-hider-f45343" style="min-width: 145px; display: none;">
            <ul class="widget-nav-item-list">
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_45536_0_0_0&amp;src=fid45536">
                 Nonspecific/Any Setting
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_45359_0_0_0&amp;src=fid45359">
                 Ravenloft
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_100222_0_0_0&amp;src=fid100222">
                 Arcavios(Strixhaven)
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_45937_0_0_0&amp;src=fid45937">
                 Theros
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_45354_0_0_0&amp;src=fid45354">
                 Dragonlance
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_45355_0_0_0&amp;src=fid45355">
                 Eberron
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_45356_0_0_0&amp;src=fid45356">
                 Forgotten Realms
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_45357_0_0_0&amp;src=fid45357">
                 Greyhawk
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_45360_0_0_0&amp;src=fid45360">
                 More Settings
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_45759_0_0_0&amp;src=fid45759">
                 Ravnica
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_45690_0_0_0&amp;src=fid45690">
                 Plane Shift
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_45358_0_0_0&amp;src=fid45358">
                 Planescape
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_45353_0_0_0&amp;src=fid45353">
                 Dark Sun
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
            </ul>
           </div>
          </div>
         </div>
         <div class="clear">
         </div>
         <div class="grid_10 alpha omega widget-nav-item">
          <div class="widget-nav-item-title" id="nav-edition" style="">
           Edition
           <span class="widget-nav-item-title-icon" height="15px" id="nav-icon-edition">
           </span>
          </div>
          <div class="widget-nav-item-content">
           <div id="more-hider-f45342" style="min-width: 145px; display: none;">
            <ul class="widget-nav-item-list">
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_45344_0_0&amp;src=fid45344">
                 Original Edition (OD&amp;D)
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_45345_0_0&amp;src=fid45345">
                 Basic/Expert
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_45346_0_0&amp;src=fid45346">
                 1st Edition
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_45347_0_0&amp;src=fid45347">
                 2nd Edition
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_45348_0_0&amp;src=fid45348">
                 3rd Edition (d20 System)
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_45349_0_0&amp;src=fid45349">
                 4th Edition
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_1000261_0_0&amp;src=fid1000261">
                 5th Edition
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
            </ul>
           </div>
          </div>
         </div>
         <div class="clear">
         </div>
         <div class="grid_10 alpha omega widget-nav-item">
          <div class="widget-nav-item-title" id="nav-format" style="">
           Format
           <span class="widget-nav-item-title-icon" height="15px" id="nav-icon-format">
           </span>
          </div>
          <div class="widget-nav-item-content">
           <div id="more-hider-f45544" style="min-width: 145px; display: none;">
            <ul class="widget-nav-item-list">
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_0_45546_0&amp;src=fid45546">
                 PDF
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_0_45835_0&amp;src=fid45835">
                 Phone PDF
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_0_45547_0&amp;src=fid45547">
                 Print
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_0_45548_0&amp;src=fid45548">
                 ePub
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_0_100219_0&amp;src=fid100219">
                 Screenreader PDF
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_0_45545_0&amp;src=fid45545">
                 Virtual Tabletop
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_0_1000140_0&amp;src=fid1000140">
                 Creation Method
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
            </ul>
           </div>
          </div>
         </div>
         <div class="clear">
         </div>
         <div class="grid_10 alpha omega widget-nav-item">
          <div class="widget-nav-item-title" id="nav-languages" style="">
           Languages
           <span class="widget-nav-item-title-icon" height="15px" id="nav-icon-languages">
           </span>
          </div>
          <div class="widget-nav-item-content">
           <div id="more-hider-f45477" style="min-width: 145px; display: none;">
            <ul class="widget-nav-item-list">
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_0_0_45483&amp;src=fid45483">
                 English
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_0_0_1000156&amp;src=fid1000156">
                 Japanese 
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_0_0_45481&amp;src=fid45481">
                 Deutsch
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_0_0_45478&amp;src=fid45478">
                 Espaol
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_0_0_45479&amp;src=fid45479">
                 Franais
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_0_0_45480&amp;src=fid45480">
                 Italiano
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_0_0_45485&amp;src=fid45485">
                 Polski
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_0_0_45482&amp;src=fid45482">
                 Portugus
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_0_0_45484&amp;src=fid45484">
                 Svenska
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_0_0_1000109&amp;src=fid1000109">
                 Ukrainian / 
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
             <li>
              <div class="nav-counter-item">
               <div class="nav-counter-text">
                <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_0_0_45699&amp;src=fid45699">
                 Other
                </a>
               </div>
               <div class="clear">
               </div>
              </div>
             </li>
            </ul>
           </div>
          </div>
         </div>
         <div class="clear">
         </div>
         <div class="grid_10 alpha omega widget-nav-item">
          <div class="widget-nav-item-title" id="nav-price" style="cursor: auto;">
           Price
          </div>
          <div class="widget-nav-item-content">
           <form action="browse.php" id="filter_prices_form" name="filter_prices_form">
            <div class="widget_filter_price" style="padding-top: 4px;">
             <a href="https://www.dmsguild.com/browse.php?pwyw=true">
              Pay What You Want
             </a>
            </div>
            <div class="widget_filter_price">
             <a href="https://www.dmsguild.com/browse.php?pto=0&amp;pfrom=0">
              Free
             </a>
            </div>
            <div class="widget_filter_price">
             $
             <label class="sr-only" for="pfromElement">
              Minimum price
             </label>
             <input aria-label="Input field" class="validate[custom[number]]" id="pfromElement" name="pfrom" style="width: 50px;" type="text"/>
             to $
             <label class="sr-only" for="ptoElement">
              Maximum price
             </label>
             <input aria-label="Input field" class="validate[custom[number]]" id="ptoElement" name="pto" style="width: 50px;" type="text"/>
             <span style="vertical-align: middle;">
              <input alt="Search" border="0" src="https://www.dmsguild.com/shared_images/icon_go.png" title=" Search " type="image"/>
             </span>
            </div>
           </form>
          </div>
         </div>
         <div class="clear">
         </div>
         <script type="text/javascript">
          $('#nav-content').click(function() { $('#more-hider-f45468').slideToggle(); $('#nav-icon-content').toggleClass('widget-nav-item-title-icon-close'); }); 
 $('#nav-storyline').click(function() { $('#more-hider-f45472').slideToggle(); $('#nav-icon-storyline').toggleClass('widget-nav-item-title-icon-close'); }); 
 $('#nav-product-type').click(function() { $('#more-hider-f45341').slideToggle(); $('#nav-icon-product-type').toggleClass('widget-nav-item-title-icon-close'); }); 
 $('#nav-theme').click(function() { $('#more-hider-f45423').slideToggle(); $('#nav-icon-theme').toggleClass('widget-nav-item-title-icon-close'); }); 
 $('#nav-setting').click(function() { $('#more-hider-f45343').slideToggle(); $('#nav-icon-setting').toggleClass('widget-nav-item-title-icon-close'); }); 
 $('#nav-edition').click(function() { $('#more-hider-f45342').slideToggle(); $('#nav-icon-edition').toggleClass('widget-nav-item-title-icon-close'); }); 
 $('#nav-format').click(function() { $('#more-hider-f45544').slideToggle(); $('#nav-icon-format').toggleClass('widget-nav-item-title-icon-close'); }); 
 $('#nav-languages').click(function() { $('#more-hider-f45477').slideToggle(); $('#nav-icon-languages').toggleClass('widget-nav-item-title-icon-close'); }); 
 $('#more-hider-f45468').slideToggle();

 $('#more-hider-f45341').slideToggle();
         </script>
        </div>
        <div class="clear">
        </div>
        <!-- storylines //-->
        <table width="100%">
         <tr>
          <td>
           <div class="widget-nav-title storylines">
            Previous Storylines
           </div>
          </td>
         </tr>
         <tr>
          <td align="center">
           <a href="https://www.dmsguild.com/browse.php?filters=100063&amp;site=dmg&amp;src=sid012">
            <img alt="Candlekeep Mysteries" src="../themes/dmg/images/DnD_OBS_CM-Storyline.jpg"/>
           </a>
          </td>
         </tr>
         <tr>
          <td align="center">
           <a href="https://www.dmsguild.com/browse.php?filters=100023&amp;site=dmg&amp;src=sid011">
            <img alt="Icewind Dale: Rime of the Frostmaiden" src="../themes/dmg/images/PrevStoryline_ROF.jpg"/>
           </a>
          </td>
         </tr>
         <tr>
          <td align="center">
           <a href="https://www.dmsguild.com/browse.php?filters=45832&amp;site=dmg&amp;src=sid010">
            <img alt="Baldur's Gate: Descent Into Avernus" src="../themes/dmg/images/PrevStoryline_DIA.jpg"/>
           </a>
          </td>
         </tr>
         <tr>
          <td align="center">
           <a href="https://www.dmsguild.com/browse.php?filters=45796&amp;site=dmg&amp;src=sid009">
            <img alt="Ghosts of Saltmarsh" src="../themes/dmg/images/PrevStoryline_GOS.jpg"/>
           </a>
          </td>
         </tr>
         <tr>
          <td align="center">
           <a href="https://www.dmsguild.com/browse.php?filters=45728&amp;site=dmg&amp;src=sid008">
            <img alt="Waterdeep Dragon Heist" src="../themes/dmg/images/PrevStoryline_WDH.png"/>
           </a>
          </td>
         </tr>
         <tr>
          <td align="center">
           <a href="https://www.dmsguild.com/browse.php?filters=45682&amp;site=dmg&amp;src=sid007">
            <img alt="Tomb of Annihilation" src="../themes/dmg/images/Storyline-TOA.png"/>
           </a>
          </td>
         </tr>
         <tr>
          <td align="center">
           <a href="https://www.dmsguild.com/browse.php?filters=45572&amp;site=dmg&amp;src=sid006">
            <img alt="Tales from the Yawning Portal" src="../themes/dmg/images/Storyline-TYP.png"/>
           </a>
          </td>
         </tr>
         <tr>
          <td align="center">
           <a href="https://www.dmsguild.com/browse.php?filters=45549&amp;site=dmg&amp;src=sid005">
            <img alt="Storm King's Thunder" src="../themes/dmg/images/Storyline-SKT.png"/>
           </a>
          </td>
         </tr>
         <tr>
          <td align="center">
           <a href="https://www.dmsguild.com/browse.php?filters=45507&amp;site=dmg&amp;src=sid004">
            <img alt="Curse of Strahd" src="../themes/dmg/images/Storyline-CoS.png"/>
           </a>
          </td>
         </tr>
         <tr>
          <td align="center">
           <a href="https://www.dmsguild.com/browse.php?filters=45473&amp;site=dmg&amp;src=sid003">
            <img alt="Rage of Demons" src="../themes/dmg/images/Storyline-RoD.png"/>
           </a>
          </td>
         </tr>
         <tr>
          <td align="center">
           <a href="https://www.dmsguild.com/browse.php?filters=45474&amp;site=dmg&amp;src=sid002">
            <img alt="Elemental Evil" src="../themes/dmg/images/Storyline-EE.png"/>
           </a>
          </td>
         </tr>
         <tr>
          <td align="center">
           <a href="https://www.dmsguild.com/browse.php?filters=45475&amp;site=dmg&amp;src=sid001">
            <img alt="Tyranny of Dragons" src="../themes/dmg/images/Storyline-ToD.png"/>
           </a>
          </td>
         </tr>
        </table>
        <!-- storylines_eof //-->
        <!-- other products //-->
        <table width="100%">
         <tr>
          <td>
           <div class="widget-nav-title storylines">
            Other Products
           </div>
          </td>
         </tr>
         <tr>
          <td align="center">
           <a href="https://legacy.drivethrurpg.com/browse/pub/44/Wizards-of-the-Coast/subcategory/9730_9733/d20-Modern-Generic?src=DnDC">
            <img alt="d20 Modern" src="../themes/dmg/images/d20m.gif"/>
           </a>
          </td>
         </tr>
         <tr>
          <td align="center">
           <a href="https://legacy.drivethrurpg.com/browse/pub/44/Wizards-of-the-Coast/subcategory/9730_262/Gamma-World?src=DnDClassicsButton">
            <img alt="Gamma World" src="../themes/dmg/images/gamma_world.jpg"/>
           </a>
          </td>
         </tr>
        </table>
        <!-- other products //-->
        <div style="padding-top: 7px;">
        </div>
        <div>
         <br/>
         <a href="https://www.drivethrurpg.com/en/?src=sistersite" target="_blank">
          <img src="https://www.dmsguild.com/shared_images/dtrpg-logo-245.png" title="DriveThruRPG" width="245"/>
         </a>
         <br/>
         <br/>
         <a href="https://www.drivethrucards.com/index.php?src=sistersite" target="_blank">
          <img src="https://www.dmsguild.com/shared_images/dtcards-logo-245.png" title="DriveThruCards" width="245"/>
         </a>
         <br/>
         <br/>
         <a href="https://www.drivethrucomics.com/index.php?src=sistersite" target="_blank">
          <img src="https://www.dmsguild.com/shared_images/dtcomics-logo-245.png" title="DriveThruComics" width="245"/>
         </a>
         <br/>
         <br/>
         <a href="https://www.drivethrufiction.com/index.php?src=sistersite" target="_blank">
          <img src="https://www.dmsguild.com/shared_images/dtfiction-logo-245.png" title="DriveThruFiction" width="245"/>
         </a>
         <br/>
         <br/>
         <a href="https://www.wargamevault.com/index.php?src=sistersite" target="_blank">
          <img src="https://www.dmsguild.com/shared_images/wgv-logo-245.png" title="WarGameVault" width="245"/>
         </a>
         <br/>
         <br/>
         <a href="https://www.storytellersvault.com/index.php?src=sistersite" target="_blank">
          <img src="https://www.dmsguild.com/shared_images/stvault-logo-245.png" title="Storytellers Vault" width="245"/>
         </a>
         <br/>
         <br/>
         <br/>
         <br/>
         <a href="https://www.pathfinderinfinite.com/index.php?src=sistersite" target="_blank">
          <img src="https://www.dmsguild.com/shared_images/pfi-logo-245.png" title="Pathfinder Infinite" width="245"/>
         </a>
        </div>
       </td>
      </tr>
      <!-- left_navigation_eof -->
     </table>
    </td>
    <td valign="top" width="100%">
     <table border="0" cellpadding="0" cellspacing="0" id="content_table" width="100%">
      <tr>
       <!-- 2011-02-15 Chuck Childers: Staley requested decreased gutters on MS sites, but this affects all sites.  It didn't look bad, so we'll try it for a bit. -->
       <td valign="top">
        <table align="center" border="0" cellpadding="0" cellspacing="0" width="100%">
         <tr>
          <td colspan="2" valign="top">
           <div style="display:table;width:100%;">
            <div style="display: table-cell;vertical-align: top;">
             <div id="search_bar_widget">
              <form action="browse.php" id="search_bar_form" method="get" name="sbf">
               <table cellpadding="0" cellspacing="0" width="100%">
                <tr>
                 <td style="padding: 8px 0px 8px 8px;" width="100%">
                  <input aria-label="Search" autocomplete="off" id="search_bar" name="keywords" onfocus="onfocus_name();" placeholder="Search..." style="font-size: 22px; border-radius: 5px; border: 0px; padding: 5px; color: ;" type="input" value=""/>
                 </td>
                 <td style="padding:  8px 8px 8px 0px ">
                  <input alt="Search" border="0" onclick="return check_search_form();" src="https://www.dmsguild.com/themes/dtrpg/images/buttons/search_button.png" type="image"/>
                 </td>
                </tr>
                <tr>
                 <td colspan="2">
                  <div style="float: right; display: inline">
                   <span class="actionLink" onclick="$('#search_bar_advanced_controls').slideToggle();" style="font-weight: 600; padding: 10px;">
                    Advanced Search
                   </span>
                  </div>
                  <br style="clear: both"/>
                 </td>
                </tr>
               </table>
               <div id="search_bar_advanced_controls" style="display: none;">
                <table cellpadding="0" cellspacing="8" width="100%">
                 <tr>
                  <!-- :KLUDGE: bblackmoor 2010-07-30: This row sets the column widths -->
                  <th align="left" class="main search_bar_control_label">
                   Author:
                   <br/>
                   <img alt="pixel_trans.gif" border="0" class="onestart" height="1" src="https://d1vzi28wh99zvq.cloudfront.net/images/pixel_trans.gif" width="100"/>
                  </th>
                  <td class="main search_bar_control">
                   <input aria-label="Input field" name="author" size="30" type="text">
                    <br/>
                    <img alt="pixel_trans.gif" border="0" class="onestart" height="1" src="https://d1vzi28wh99zvq.cloudfront.net/images/pixel_trans.gif" width="250"/>
                   </input>
                  </td>
                 </tr>
                 <tr>
                  <th align="left" class="main search_bar_control_label">
                   Artist:
                  </th>
                  <td class="main search_bar_control">
                   <input aria-label="Input field" name="artist" size="30" type="text">
                   </input>
                  </td>
                 </tr>
                 <tr>
                  <th align="left" class="main search_bar_control_label">
                   Price:
                  </th>
                  <td class="main search_bar_control_label search_bar_control">
                   $
                   <input aria-label="Input field" name="pfrom" size="10" type="text">
                    to                        $
                    <input aria-label="Input field" name="pto" size="10" type="text"/>
                   </input>
                  </td>
                 </tr>
                </table>
                <div id="submit_button_section">
                 <span class="actionLink">
                  <button class="cssBtn" id="" onclick="return check_search_form();" type="submit">
                   <span>
                    Search
                   </span>
                  </button>
                 </span>
                </div>
               </div>
              </form>
              <script type="text/javascript">
               // 2021-08-30 - OZ-2542 - MK
        function ajax_record_sales_analytics_event(data) {
            let url = '/includes/ajax/analytics.php?';
            $.each(data, function(index,value){
                url = url + index + '=' + value + '&';
            });
            //ajax call to record sales analytics event
            $.ajax({
                url: url
            });
        }

        // Because the date fields are initially hidden,
        // the picker can't be constructed until they are showing.
        // Therefore, the picker is attached to the onfocus event.
        function sdate_from_picker() {
            try {
                AnyTime.picker( "sdate_from", { format: "%Y-%m-%d"} );
            } catch (error) {
                // do nothing
            }
        }

        function sdate_to_picker() {
            try {
                AnyTime.picker( "sdate_to", { format: "%Y-%m-%d"} );
            } catch (error) {
                // do nothing
            }
        }

        // Because the time fields are initially hidden,
        // the picker can't be constructed until they are showing.
        // Therefore, the picker is attached to the onfocus event.
        function stime_from_picker() {
            try {
                // for ease of use, using whole hours in search
                AnyTime.picker( "stime_from", { format: "%l:00 %p"} );
            } catch (error) {
                // do nothing
            }
        }

        function stime_to_picker() {
            try {
                // for ease of use, using whole hours in search
                AnyTime.picker( "stime_to", { format: "%l:00 %p"} );
            } catch (error) {
                // do nothing
            }
        }

        function toggle_live_fields() {
            var has_is_live = document.getElementById('is_live');

            if (has_is_live) {
                var state = document.getElementById('is_live').checked;
                if (state) {
                    $('#live_products_section').slideDown('slow');
                } else {
                    $('#live_products_section').slideUp('slow');
                }
            }
        }

        function check_search_form() {
            var error_message = 'Please correct the following:\n\n';
            var error_found = false;
            var error_field;
            var keywords = document.sbf.keywords.value;
            var has_is_live = document.getElementById('is_live');

            var pfrom = document.sbf.pfrom.value;
            var pto = document.sbf.pto.value;
            var author = document.sbf.author.value;
            var pfrom_float;
            var pto_float;

            if (keywords == 'Search...') {
                document.sbf.keywords.value = '';
            }
            if (keywords == 'Search within results... ') {
                document.sbf.keywords.value = '';
            }

            if ((keywords == '' || keywords.length < 1)
                && (pfrom == '' || pfrom.length < 1)
                && (pto == '' || pto.length < 1)
                && (author == '' || author.length < 1)
                && (artist == '' || artist.length < 1)
                && (!has_is_live)) {

                error_message = error_message + '* At least one of the fields in the search form must be entered.\n';
                error_field = document.sbf.keywords;
                error_found = true;
            }

            if (pfrom.length > 0) {
                pfrom_float = parseFloat(pfrom);

                if (isNaN(pfrom_float)) {
                    error_message = error_message + '* Price "from" must be a number.\n';
                    error_field = document.sbf.pfrom;
                    error_found = true;
                }
            } else {
                pfrom_float = 0;
            }

            if (pto.length > 0) {
                pto_float = parseFloat(pto);

                if (isNaN(pto_float)) {
                    error_message = error_message + '* Price "to" must be a number.\n';
                    error_field = document.sbf.pto;
                    error_found = true;
                }
            } else {
                pto_float = 0;
            }

            if (pfrom.length > 0 && pto.length > 0
                && !isNaN(pfrom_float)
                && !isNaN(pto_float)
                && pto_float < pfrom_float) {

                error_message = error_message + '* Price "to" must be greater than or equal to price "from".\n';
                error_field = document.sbf.pto;
                error_found = true;
            }

            if (error_found == true) {
                alert(error_message);
                error_field.focus();
                return false;
            } else {
                return true;
            }
        }

        function focus_on_search_bar() {
            var search_bar_input = document.getElementById('search_bar');
            if (search_bar_input) {
                var value_filter = (search_bar_input.value != '' && search_bar_input.value != ' ');

                if (search_bar_input && search_bar_input.value != 'Search...' && search_bar_input.value != 'Search within results... ' && value_filter) {
                    search_bar_input.value = search_bar_input.value + ' ';
                    search_bar_input.focus();
                }
            }
        }

        var autocomplete;

        function onfocus_name() {
            var search = $('#search_bar');

            if (search.attr('value') == 'Search...') {
                search.css('color','black');
                search.attr('value','');
            }

            if (search.attr('value') == 'Search within results... ') {
                search.css('color','black');
                search.attr('value','');
            }

            var cache = {},lastXhr;
            var options = {
                source: function(request, response) {
                    var term = request.term;
                    if ( term in cache ) {
                        response( cache[ term ] );
                        return;
                    }
                    $.ajax({
                        url: "includes/ajax/search_autocomplete_jquery.php",
                        dataType: "json",
                        data: {
                            term : request.term,
                            filters : (($('#search_filter')) ? $('#search_filter').val() : ''),
                            manufacturers_id : (($('#search_manufacturer')) ? $('#search_manufacturer').val() : ''),
                            cPath : (($('#search_cPath')) ? $('#search_cPath').val() : '')
                        },
                        success: function(data) {
                            cache[ term ] = data;
                            response(data);
                        }
                    });
                },
                delay: 400,
                minLength: 3,
                html: 'html',
                focus: function(event,ui) {
                    $('#search_bar').val(ui.item.name);
                    return false;
                },
                select: function(event,ui) {
                    let event_tag = 'view-product-from-search';
                    ajax_record_sales_analytics_event({
                        origin: 'legacy',
                        event_tag: 'select-product-option',
                        page: '/index.php',

                    });

                    $('#search_bar').val(ui.item.name);
                    location.replace(ui.item.link);

                    return false;
                }
            };

            autocomplete = $('#search_bar').autocomplete(options);

            return true;
        }
        toggle_live_fields();//start the fields off toggled
        focus_on_search_bar();//move focus to the search bar

        $('.search_parameter').each(function() {
            $( this ).on('click',function() {
                var lnk = $( this ).children().children().attr('href');
                if (lnk) location.href = lnk;
            })
        });

        if (0) {
            // TODO: bblackmoor 2012-06-13: design a min-search form specifically for live products
            //$('#search_bar_advanced_controls').slideDown();
        }
              </script>
             </div>
            </div>
            <!--    begin subheader-->
            <div style="display: table-cell;vertical-align: top;width: 365px;text-align: right;">
             <a href="https://help.dmsguild.com/hc/en-us/categories/12776810252951-Content-Creator-Questions" target="_blank">
              <img alt="What is DMsGuild?" src="../themes/dmg/images/DMsGuild-WhatIsIt_v2.png" style="margin-right: 20px"/>
             </a>
            </div>
            <!--    end subheader-->
           </div>
          </td>
         </tr>
         <!-- body_text -->
         <tr>
          <td>
           <img alt="pixel_trans.gif" border="0" class="onestart" height="10" src="https://d1vzi28wh99zvq.cloudfront.net/images/pixel_trans.gif" width="100%"/>
          </td>
         </tr>
         <tr>
          <td>
           <p align="left">
            <a href="https://www.dmsguild.com/sale.php?src=DnDSummer2025Legacy">
             <img alt="D&amp;D Summer of Adventure sale - up to 30% select titles @ Dungeon Masters Guild" border="0" class="onestart" src="https://www.dmsguild.com/images/site_resources/dmg_DnDSummerSale2025.png" style="max-width:2184px" width="100%"/>
            </a>
           </p>
          </td>
         </tr>
         <tr>
          <td valign="top">
           <img alt="Spacer" border="0" height="10" src="../images/pixel_trans.gif" width="100%"/>
          </td>
         </tr>
         <tr>
          <td valign="top">
           <div class="infoBoxHeading" height="14" style="width: 100%;;min-height:18px;" width="100%">
            <div style="float: left">
             Most Popular DMsGuild Titles
            </div>
            <div class="slider_switcher" elem_id="d258023" style="float: right; line-height: 0px">
             <a class="switch_view_button" href="#" name="slider_view" style="outline:0;">
              <img alt="Slider view" src="../shared_images/icon_slider_view_off.png">
              </img>
             </a>
             <a class="switch_view_button" href="#" name="list_view" style="outline:0;">
              <img alt="List view" src="../shared_images/icon_list_view_off.png">
              </img>
             </a>
             <a class="switch_view_button" href="#" name="grid_view" style="outline:0;">
              <img alt="Grid view" src="../shared_images/icon_grid_view_off.png">
              </img>
             </a>
             <a href="https://www.dmsguild.com/browse.php?filters=45469_0_0_0_0_0&amp;page=1&amp;sort=7a#browselist" style="vertical-align: top; line-height: 19px; font-size: 11px">
              See all
             </a>
            </div>
            <script>
             $(document).ready(function() {
						$('.slider_switcher[elem_id="d258023"]').on('click', 'a.switch_view_button', function(e) {
							e.preventDefault();

							var slider_id = $(this).parent().attr('elem_id');
							var view_type = $(this).attr('name');

							$(this).parent().find('img').each(function(){
								var src = $(this).attr('src');
								$(this).attr('src', src.replace('_on.png', '_off.png'));
							});
							var src = $(this).find('img').attr('src');
							$(this).find('img').attr('src', src.replace('_off.png', '_on.png'));

							if(typeof lazySliders !== 'undefined' && typeof lazySliders[slider_id] !== 'undefined'){
								lazySliders[slider_id].set_view_type(view_type);
								lazySliders[slider_id].update({item_from: 0});
							}
						}).find('a.switch_view_button[name="slider_view"]').find('img').each(function(){
							var src = $(this).attr('src');
							$(this).attr('src', src.replace('_off.png', '_on.png'));
						});
					});
            </script>
           </div>
           <table class="infoBox strip_content" id="d258023" style="overflow:hidden;border:none;width:100%;border-spacing:0;">
            <tr>
             <td>
              <div class="owl-products-carousel owl-carousel" style="height: 200px;">
               <div class="loader_spinner" height="200px" style="margin-top: 10px; text-align: center">
                <img alt="Loading..." src="../shared_images/ajax-loader.gif" width="150px"/>
               </div>
              </div>
             </td>
            </tr>
           </table>
           <script>
            $(document).ready(function() {
					if(typeof lazySliders == 'undefined'){
						lazySliders = [];
					}
					$('#d258023').appear(function(){
						var opts = {
							elem_id: 'd258023',
							view_type: 'slider_view',
							api_url: '/api/products/list/hottest_filtered?filters=45469&include_community_content=1&strip_src=hottest_in_dmg',
							
						};
						lazySliders['d258023'] = lazySliderBox(opts);
						lazySliders['d258023'].update();
					});
				});
           </script>
          </td>
         </tr>
         <tr>
          <td>
           <img alt="pixel_trans.gif" border="0" class="onestart" height="10" src="https://d1vzi28wh99zvq.cloudfront.net/images/pixel_trans.gif" width="100%"/>
          </td>
         </tr>
         <tr>
          <td valign="top">
           <div class="infoBoxHeading" height="14" style="width: 100%;;min-height:18px;" width="100%">
            <div style="float: left">
             Newest DMsGuild Titles
            </div>
            <div class="slider_switcher" elem_id="896e924" style="float: right; line-height: 0px">
             <a class="switch_view_button" href="#" name="slider_view" style="outline:0;">
              <img alt="Slider view" src="../shared_images/icon_slider_view_off.png">
              </img>
             </a>
             <a class="switch_view_button" href="#" name="list_view" style="outline:0;">
              <img alt="List view" src="../shared_images/icon_list_view_off.png">
              </img>
             </a>
             <a class="switch_view_button" href="#" name="grid_view" style="outline:0;">
              <img alt="Grid view" src="../shared_images/icon_grid_view_off.png">
              </img>
             </a>
             <a href="https://www.dmsguild.com/browse.php?filters=45469_0_0_0_0_0&amp;page=1&amp;sort=4a#browselist" style="vertical-align: top; line-height: 19px; font-size: 11px">
              See all
             </a>
            </div>
            <script>
             $(document).ready(function() {
						$('.slider_switcher[elem_id="896e924"]').on('click', 'a.switch_view_button', function(e) {
							e.preventDefault();

							var slider_id = $(this).parent().attr('elem_id');
							var view_type = $(this).attr('name');

							$(this).parent().find('img').each(function(){
								var src = $(this).attr('src');
								$(this).attr('src', src.replace('_on.png', '_off.png'));
							});
							var src = $(this).find('img').attr('src');
							$(this).find('img').attr('src', src.replace('_off.png', '_on.png'));

							if(typeof lazySliders !== 'undefined' && typeof lazySliders[slider_id] !== 'undefined'){
								lazySliders[slider_id].set_view_type(view_type);
								lazySliders[slider_id].update({item_from: 0});
							}
						}).find('a.switch_view_button[name="slider_view"]').find('img').each(function(){
							var src = $(this).attr('src');
							$(this).attr('src', src.replace('_off.png', '_on.png'));
						});
					});
            </script>
           </div>
           <table class="infoBox strip_content" id="896e924" style="overflow:hidden;border:none;width:100%;border-spacing:0;">
            <tr>
             <td>
              <div class="owl-products-carousel owl-carousel" style="height: 200px;">
               <div class="loader_spinner" height="200px" style="margin-top: 10px; text-align: center">
                <img alt="Loading..." src="../shared_images/ajax-loader.gif" width="150px"/>
               </div>
              </div>
             </td>
            </tr>
           </table>
           <script>
            $(document).ready(function() {
					if(typeof lazySliders == 'undefined'){
						lazySliders = [];
					}
					$('#896e924').appear(function(){
						var opts = {
							elem_id: '896e924',
							view_type: 'slider_view',
							api_url: '/api/products/list/newest?filters=45469&include_community_content=1&show_only_community_content=1&max_per_author=3&exclude_filter=100057&strip_src=newest_in_dmg',
							
						};
						lazySliders['896e924'] = lazySliderBox(opts);
						lazySliders['896e924'].update();
					});
				});
           </script>
          </td>
         </tr>
         <tr>
          <td>
           <img alt="pixel_trans.gif" border="0" class="onestart" height="10" src="https://d1vzi28wh99zvq.cloudfront.net/images/pixel_trans.gif" width="100%"/>
          </td>
         </tr>
         <tr>
          <td valign="top">
           <div class="infoBoxHeading" height="14" style="width: 100%;;min-height:18px;" width="100%">
            <div style="float: left">
             Most Popular DMsGuild Titles Under $5
            </div>
            <div class="slider_switcher" elem_id="cbe299b" style="float: right; line-height: 0px">
             <a class="switch_view_button" href="#" name="slider_view" style="outline:0;">
              <img alt="Slider view" src="../shared_images/icon_slider_view_off.png">
              </img>
             </a>
             <a class="switch_view_button" href="#" name="list_view" style="outline:0;">
              <img alt="List view" src="../shared_images/icon_list_view_off.png">
              </img>
             </a>
             <a class="switch_view_button" href="#" name="grid_view" style="outline:0;">
              <img alt="Grid view" src="../shared_images/icon_grid_view_off.png">
              </img>
             </a>
            </div>
            <script>
             $(document).ready(function() {
						$('.slider_switcher[elem_id="cbe299b"]').on('click', 'a.switch_view_button', function(e) {
							e.preventDefault();

							var slider_id = $(this).parent().attr('elem_id');
							var view_type = $(this).attr('name');

							$(this).parent().find('img').each(function(){
								var src = $(this).attr('src');
								$(this).attr('src', src.replace('_on.png', '_off.png'));
							});
							var src = $(this).find('img').attr('src');
							$(this).find('img').attr('src', src.replace('_off.png', '_on.png'));

							if(typeof lazySliders !== 'undefined' && typeof lazySliders[slider_id] !== 'undefined'){
								lazySliders[slider_id].set_view_type(view_type);
								lazySliders[slider_id].update({item_from: 0});
							}
						}).find('a.switch_view_button[name="slider_view"]').find('img').each(function(){
							var src = $(this).attr('src');
							$(this).attr('src', src.replace('_off.png', '_on.png'));
						});
					});
            </script>
           </div>
           <table class="infoBox strip_content" id="cbe299b" style="overflow:hidden;border:none;width:100%;border-spacing:0;">
            <tr>
             <td>
              <div class="owl-products-carousel owl-carousel" style="height: 200px;">
               <div class="loader_spinner" height="200px" style="margin-top: 10px; text-align: center">
                <img alt="Loading..." src="../shared_images/ajax-loader.gif" width="150px"/>
               </div>
              </div>
             </td>
            </tr>
           </table>
           <script>
            $(document).ready(function() {
					if(typeof lazySliders == 'undefined'){
						lazySliders = [];
					}
					$('#cbe299b').appear(function(){
						var opts = {
							elem_id: 'cbe299b',
							view_type: 'slider_view',
							api_url: '/api/products/list/hottest_dmg_under5',
							
						};
						lazySliders['cbe299b'] = lazySliderBox(opts);
						lazySliders['cbe299b'].update();
					});
				});
           </script>
          </td>
         </tr>
         <tr>
          <td>
           <img alt="pixel_trans.gif" border="0" class="onestart" height="10" src="https://d1vzi28wh99zvq.cloudfront.net/images/pixel_trans.gif" width="100%"/>
          </td>
         </tr>
         <tr>
          <td valign="top">
           <div class="infoBoxHeading" height="14" style="width: 100%;;min-height:18px;" width="100%">
            <div style="float: left">
             Hottest Roll20 Enabled Titles
            </div>
            <div class="slider_switcher" elem_id="cb5341b" style="float: right; line-height: 0px">
             <a class="switch_view_button" href="#" name="slider_view" style="outline:0;">
              <img alt="Slider view" src="../shared_images/icon_slider_view_off.png">
              </img>
             </a>
             <a class="switch_view_button" href="#" name="list_view" style="outline:0;">
              <img alt="List view" src="../shared_images/icon_list_view_off.png">
              </img>
             </a>
             <a class="switch_view_button" href="#" name="grid_view" style="outline:0;">
              <img alt="Grid view" src="../shared_images/icon_grid_view_off.png">
              </img>
             </a>
             <a href="https://www.dmsguild.com/browse.php?filters=0_0_0_0_0_0_1000063_0&amp;page=1&amp;sort=7a#browselist" style="vertical-align: top; line-height: 19px; font-size: 11px">
              See all
             </a>
            </div>
            <script>
             $(document).ready(function() {
						$('.slider_switcher[elem_id="cb5341b"]').on('click', 'a.switch_view_button', function(e) {
							e.preventDefault();

							var slider_id = $(this).parent().attr('elem_id');
							var view_type = $(this).attr('name');

							$(this).parent().find('img').each(function(){
								var src = $(this).attr('src');
								$(this).attr('src', src.replace('_on.png', '_off.png'));
							});
							var src = $(this).find('img').attr('src');
							$(this).find('img').attr('src', src.replace('_off.png', '_on.png'));

							if(typeof lazySliders !== 'undefined' && typeof lazySliders[slider_id] !== 'undefined'){
								lazySliders[slider_id].set_view_type(view_type);
								lazySliders[slider_id].update({item_from: 0});
							}
						}).find('a.switch_view_button[name="slider_view"]').find('img').each(function(){
							var src = $(this).attr('src');
							$(this).attr('src', src.replace('_off.png', '_on.png'));
						});
					});
            </script>
           </div>
           <table class="infoBox strip_content" id="cb5341b" style="overflow:hidden;border:none;width:100%;border-spacing:0;">
            <tr>
             <td>
              <div class="owl-products-carousel owl-carousel" style="height: 200px;">
               <div class="loader_spinner" height="200px" style="margin-top: 10px; text-align: center">
                <img alt="Loading..." src="../shared_images/ajax-loader.gif" width="150px"/>
               </div>
              </div>
             </td>
            </tr>
           </table>
           <script>
            $(document).ready(function() {
					if(typeof lazySliders == 'undefined'){
						lazySliders = [];
					}
					$('#cb5341b').appear(function(){
						var opts = {
							elem_id: 'cb5341b',
							view_type: 'slider_view',
							api_url: '/api/products/list/hottest_filtered?filters=1000063&show_only_community_content=1&strip_src=most_popular_roll20_on_dmg',
							
						};
						lazySliders['cb5341b'] = lazySliderBox(opts);
						lazySliders['cb5341b'].update();
					});
				});
           </script>
          </td>
         </tr>
         <tr>
          <td>
           <img alt="pixel_trans.gif" border="0" class="onestart" height="10" src="https://d1vzi28wh99zvq.cloudfront.net/images/pixel_trans.gif" width="100%"/>
          </td>
         </tr>
         <tr>
          <td valign="top">
           <div class="infoBoxHeading" height="14" style="width: 100%;;min-height:18px;" width="100%">
            <div style="float: left">
             Newest D&amp;D Adventurers League Titles
            </div>
            <div class="slider_switcher" elem_id="b3e63ab" style="float: right; line-height: 0px">
             <a class="switch_view_button" href="#" name="slider_view" style="outline:0;">
              <img alt="Slider view" src="../shared_images/icon_slider_view_off.png">
              </img>
             </a>
             <a class="switch_view_button" href="#" name="list_view" style="outline:0;">
              <img alt="List view" src="../shared_images/icon_list_view_off.png">
              </img>
             </a>
             <a class="switch_view_button" href="#" name="grid_view" style="outline:0;">
              <img alt="Grid view" src="../shared_images/icon_grid_view_off.png">
              </img>
             </a>
             <a href="https://www.dmsguild.com/browse.php?filters=45470_0_0_0_0_0&amp;page=1&amp;sort=4a#browselist" style="vertical-align: top; line-height: 19px; font-size: 11px">
              See all
             </a>
            </div>
            <script>
             $(document).ready(function() {
						$('.slider_switcher[elem_id="b3e63ab"]').on('click', 'a.switch_view_button', function(e) {
							e.preventDefault();

							var slider_id = $(this).parent().attr('elem_id');
							var view_type = $(this).attr('name');

							$(this).parent().find('img').each(function(){
								var src = $(this).attr('src');
								$(this).attr('src', src.replace('_on.png', '_off.png'));
							});
							var src = $(this).find('img').attr('src');
							$(this).find('img').attr('src', src.replace('_off.png', '_on.png'));

							if(typeof lazySliders !== 'undefined' && typeof lazySliders[slider_id] !== 'undefined'){
								lazySliders[slider_id].set_view_type(view_type);
								lazySliders[slider_id].update({item_from: 0});
							}
						}).find('a.switch_view_button[name="slider_view"]').find('img').each(function(){
							var src = $(this).attr('src');
							$(this).attr('src', src.replace('_off.png', '_on.png'));
						});
					});
            </script>
           </div>
           <table class="infoBox strip_content" id="b3e63ab" style="overflow:hidden;border:none;width:100%;border-spacing:0;">
            <tr>
             <td>
              <div class="owl-products-carousel owl-carousel" style="height: 200px;">
               <div class="loader_spinner" height="200px" style="margin-top: 10px; text-align: center">
                <img alt="Loading..." src="../shared_images/ajax-loader.gif" width="150px"/>
               </div>
              </div>
             </td>
            </tr>
           </table>
           <script>
            $(document).ready(function() {
					if(typeof lazySliders == 'undefined'){
						lazySliders = [];
					}
					$('#b3e63ab').appear(function(){
						var opts = {
							elem_id: 'b3e63ab',
							view_type: 'slider_view',
							api_url: '/api/products/list/newest_in_al',
							
						};
						lazySliders['b3e63ab'] = lazySliderBox(opts);
						lazySliders['b3e63ab'].update();
					});
				});
           </script>
          </td>
         </tr>
         <tr>
          <td>
           <img alt="pixel_trans.gif" border="0" class="onestart" height="10" src="https://d1vzi28wh99zvq.cloudfront.net/images/pixel_trans.gif" width="100%"/>
          </td>
         </tr>
         <tr>
          <td valign="top">
           <div class="infoBoxHeading" height="14" style="width: 100%;;min-height:18px;" width="100%">
            <div style="float: left">
             Most Popular from Wizards &amp; Guild Adepts
            </div>
            <div class="slider_switcher" elem_id="b7df2e0" style="float: right; line-height: 0px">
             <a class="switch_view_button" href="#" name="slider_view" style="outline:0;">
              <img alt="Slider view" src="../shared_images/icon_slider_view_off.png">
              </img>
             </a>
             <a class="switch_view_button" href="#" name="list_view" style="outline:0;">
              <img alt="List view" src="../shared_images/icon_list_view_off.png">
              </img>
             </a>
             <a class="switch_view_button" href="#" name="grid_view" style="outline:0;">
              <img alt="Grid view" src="../shared_images/icon_grid_view_off.png">
              </img>
             </a>
            </div>
            <script>
             $(document).ready(function() {
						$('.slider_switcher[elem_id="b7df2e0"]').on('click', 'a.switch_view_button', function(e) {
							e.preventDefault();

							var slider_id = $(this).parent().attr('elem_id');
							var view_type = $(this).attr('name');

							$(this).parent().find('img').each(function(){
								var src = $(this).attr('src');
								$(this).attr('src', src.replace('_on.png', '_off.png'));
							});
							var src = $(this).find('img').attr('src');
							$(this).find('img').attr('src', src.replace('_off.png', '_on.png'));

							if(typeof lazySliders !== 'undefined' && typeof lazySliders[slider_id] !== 'undefined'){
								lazySliders[slider_id].set_view_type(view_type);
								lazySliders[slider_id].update({item_from: 0});
							}
						}).find('a.switch_view_button[name="slider_view"]').find('img').each(function(){
							var src = $(this).attr('src');
							$(this).attr('src', src.replace('_off.png', '_on.png'));
						});
					});
            </script>
           </div>
           <table class="infoBox strip_content" id="b7df2e0" style="overflow:hidden;border:none;width:100%;border-spacing:0;">
            <tr>
             <td>
              <div class="owl-products-carousel owl-carousel" style="height: 200px;">
               <div class="loader_spinner" height="200px" style="margin-top: 10px; text-align: center">
                <img alt="Loading..." src="../shared_images/ajax-loader.gif" width="150px"/>
               </div>
              </div>
             </td>
            </tr>
           </table>
           <script>
            $(document).ready(function() {
					if(typeof lazySliders == 'undefined'){
						lazySliders = [];
					}
					$('#b7df2e0').appear(function(){
						var opts = {
							elem_id: 'b7df2e0',
							view_type: 'slider_view',
							api_url: '/api/products/list/hottest_wizards_and_adepts',
							
						};
						lazySliders['b7df2e0'] = lazySliderBox(opts);
						lazySliders['b7df2e0'].update();
					});
				});
           </script>
          </td>
         </tr>
         <tr>
          <td>
           <img alt="pixel_trans.gif" border="0" class="onestart" height="10" src="https://d1vzi28wh99zvq.cloudfront.net/images/pixel_trans.gif" width="100%"/>
          </td>
         </tr>
         <tr>
          <td valign="top">
           <div class="infoBoxHeading" height="14" style="width: 100%;;min-height:18px;" width="100%">
            <div style="float: left">
             Newest D&amp;D from Wizards &amp; Guild Adepts
            </div>
            <div class="slider_switcher" elem_id="83239b5" style="float: right; line-height: 0px">
             <a class="switch_view_button" href="#" name="slider_view" style="outline:0;">
              <img alt="Slider view" src="../shared_images/icon_slider_view_off.png">
              </img>
             </a>
             <a class="switch_view_button" href="#" name="list_view" style="outline:0;">
              <img alt="List view" src="../shared_images/icon_list_view_off.png">
              </img>
             </a>
             <a class="switch_view_button" href="#" name="grid_view" style="outline:0;">
              <img alt="Grid view" src="../shared_images/icon_grid_view_off.png">
              </img>
             </a>
            </div>
            <script>
             $(document).ready(function() {
						$('.slider_switcher[elem_id="83239b5"]').on('click', 'a.switch_view_button', function(e) {
							e.preventDefault();

							var slider_id = $(this).parent().attr('elem_id');
							var view_type = $(this).attr('name');

							$(this).parent().find('img').each(function(){
								var src = $(this).attr('src');
								$(this).attr('src', src.replace('_on.png', '_off.png'));
							});
							var src = $(this).find('img').attr('src');
							$(this).find('img').attr('src', src.replace('_off.png', '_on.png'));

							if(typeof lazySliders !== 'undefined' && typeof lazySliders[slider_id] !== 'undefined'){
								lazySliders[slider_id].set_view_type(view_type);
								lazySliders[slider_id].update({item_from: 0});
							}
						}).find('a.switch_view_button[name="slider_view"]').find('img').each(function(){
							var src = $(this).attr('src');
							$(this).attr('src', src.replace('_off.png', '_on.png'));
						});
					});
            </script>
           </div>
           <table class="infoBox strip_content" id="83239b5" style="overflow:hidden;border:none;width:100%;border-spacing:0;">
            <tr>
             <td>
              <div class="owl-products-carousel owl-carousel" style="height: 200px;">
               <div class="loader_spinner" height="200px" style="margin-top: 10px; text-align: center">
                <img alt="Loading..." src="../shared_images/ajax-loader.gif" width="150px"/>
               </div>
              </div>
             </td>
            </tr>
           </table>
           <script>
            $(document).ready(function() {
					if(typeof lazySliders == 'undefined'){
						lazySliders = [];
					}
					$('#83239b5').appear(function(){
						var opts = {
							elem_id: '83239b5',
							view_type: 'slider_view',
							api_url: '/api/products/list/newest_in_wizards_and_adepts',
							
						};
						lazySliders['83239b5'] = lazySliderBox(opts);
						lazySliders['83239b5'].update();
					});
				});
           </script>
          </td>
         </tr>
         <tr>
          <td>
           <img alt="pixel_trans.gif" border="0" class="onestart" height="10" src="https://d1vzi28wh99zvq.cloudfront.net/images/pixel_trans.gif" width="100%"/>
          </td>
         </tr>
         <tr>
          <td valign="top">
           <div class="infoBoxHeading" height="14" style="width: 100%;;min-height:18px;" width="100%">
            <div style="float: left">
             Newest D&amp;D in Print
            </div>
            <div class="slider_switcher" elem_id="df661e6" style="float: right; line-height: 0px">
             <a class="switch_view_button" href="#" name="slider_view" style="outline:0;">
              <img alt="Slider view" src="../shared_images/icon_slider_view_off.png">
              </img>
             </a>
             <a class="switch_view_button" href="#" name="list_view" style="outline:0;">
              <img alt="List view" src="../shared_images/icon_list_view_off.png">
              </img>
             </a>
             <a class="switch_view_button" href="#" name="grid_view" style="outline:0;">
              <img alt="Grid view" src="../shared_images/icon_grid_view_off.png">
              </img>
             </a>
            </div>
            <script>
             $(document).ready(function() {
						$('.slider_switcher[elem_id="df661e6"]').on('click', 'a.switch_view_button', function(e) {
							e.preventDefault();

							var slider_id = $(this).parent().attr('elem_id');
							var view_type = $(this).attr('name');

							$(this).parent().find('img').each(function(){
								var src = $(this).attr('src');
								$(this).attr('src', src.replace('_on.png', '_off.png'));
							});
							var src = $(this).find('img').attr('src');
							$(this).find('img').attr('src', src.replace('_off.png', '_on.png'));

							if(typeof lazySliders !== 'undefined' && typeof lazySliders[slider_id] !== 'undefined'){
								lazySliders[slider_id].set_view_type(view_type);
								lazySliders[slider_id].update({item_from: 0});
							}
						}).find('a.switch_view_button[name="slider_view"]').find('img').each(function(){
							var src = $(this).attr('src');
							$(this).attr('src', src.replace('_off.png', '_on.png'));
						});
					});
            </script>
           </div>
           <table class="infoBox strip_content" id="df661e6" style="overflow:hidden;border:none;width:100%;border-spacing:0;">
            <tr>
             <td>
              <div class="owl-products-carousel owl-carousel" style="height: 200px;">
               <div class="loader_spinner" height="200px" style="margin-top: 10px; text-align: center">
                <img alt="Loading..." src="../shared_images/ajax-loader.gif" width="150px"/>
               </div>
              </div>
             </td>
            </tr>
           </table>
           <script>
            $(document).ready(function() {
					if(typeof lazySliders == 'undefined'){
						lazySliders = [];
					}
					$('#df661e6').appear(function(){
						var opts = {
							elem_id: 'df661e6',
							view_type: 'slider_view',
							api_url: '/api/products/list/newest_print/?include_community_content=1',
							
						};
						lazySliders['df661e6'] = lazySliderBox(opts);
						lazySliders['df661e6'].update();
					});
				});
           </script>
          </td>
         </tr>
         <tr>
          <td>
           <img alt="pixel_trans.gif" border="0" class="onestart" height="10" src="https://d1vzi28wh99zvq.cloudfront.net/images/pixel_trans.gif" width="100%"/>
          </td>
         </tr>
         <tr>
          <td valign="top">
           <div class="infoBoxHeading" height="14" style="width: 100%;;min-height:18px;" width="100%">
            <div style="float: left">
             Hottest Classic Titles
            </div>
            <div class="slider_switcher" elem_id="7cd5305" style="float: right; line-height: 0px">
             <a class="switch_view_button" href="#" name="slider_view" style="outline:0;">
              <img alt="Slider view" src="../shared_images/icon_slider_view_off.png">
              </img>
             </a>
             <a class="switch_view_button" href="#" name="list_view" style="outline:0;">
              <img alt="List view" src="../shared_images/icon_list_view_off.png">
              </img>
             </a>
             <a class="switch_view_button" href="#" name="grid_view" style="outline:0;">
              <img alt="Grid view" src="../shared_images/icon_grid_view_off.png">
              </img>
             </a>
             <a href="https://www.dmsguild.com/browse.php?filters=45471_0_0_0_0_0&amp;page=1&amp;sort=7a#browselist" style="vertical-align: top; line-height: 19px; font-size: 11px">
              See all
             </a>
            </div>
            <script>
             $(document).ready(function() {
						$('.slider_switcher[elem_id="7cd5305"]').on('click', 'a.switch_view_button', function(e) {
							e.preventDefault();

							var slider_id = $(this).parent().attr('elem_id');
							var view_type = $(this).attr('name');

							$(this).parent().find('img').each(function(){
								var src = $(this).attr('src');
								$(this).attr('src', src.replace('_on.png', '_off.png'));
							});
							var src = $(this).find('img').attr('src');
							$(this).find('img').attr('src', src.replace('_off.png', '_on.png'));

							if(typeof lazySliders !== 'undefined' && typeof lazySliders[slider_id] !== 'undefined'){
								lazySliders[slider_id].set_view_type(view_type);
								lazySliders[slider_id].update({item_from: 0});
							}
						}).find('a.switch_view_button[name="slider_view"]').find('img').each(function(){
							var src = $(this).attr('src');
							$(this).attr('src', src.replace('_off.png', '_on.png'));
						});
					});
            </script>
           </div>
           <table class="infoBox strip_content" id="7cd5305" style="overflow:hidden;border:none;width:100%;border-spacing:0;">
            <tr>
             <td>
              <div class="owl-products-carousel owl-carousel" style="height: 200px;">
               <div class="loader_spinner" height="200px" style="margin-top: 10px; text-align: center">
                <img alt="Loading..." src="../shared_images/ajax-loader.gif" width="150px"/>
               </div>
              </div>
             </td>
            </tr>
           </table>
           <script>
            $(document).ready(function() {
					if(typeof lazySliders == 'undefined'){
						lazySliders = [];
					}
					$('#7cd5305').appear(function(){
						var opts = {
							elem_id: '7cd5305',
							view_type: 'slider_view',
							api_url: '/api/products/list/hottest_filtered?filters=45471',
							
						};
						lazySliders['7cd5305'] = lazySliderBox(opts);
						lazySliders['7cd5305'].update();
					});
				});
           </script>
          </td>
         </tr>
         <tr>
          <td>
           <img alt="pixel_trans.gif" border="0" class="onestart" height="10" src="https://d1vzi28wh99zvq.cloudfront.net/images/pixel_trans.gif" width="100%"/>
          </td>
         </tr>
         <tr>
          <td valign="top">
           <div class="infoBoxHeading" height="14" style="width: 100%;;min-height:18px;" width="100%">
            <div style="float: left">
             Recently Added Classic D&amp;D Titles
            </div>
            <div class="slider_switcher" elem_id="b565c59" style="float: right; line-height: 0px">
             <a class="switch_view_button" href="#" name="slider_view" style="outline:0;">
              <img alt="Slider view" src="../shared_images/icon_slider_view_off.png">
              </img>
             </a>
             <a class="switch_view_button" href="#" name="list_view" style="outline:0;">
              <img alt="List view" src="../shared_images/icon_list_view_off.png"/>
             </a>
             <a class="switch_view_button" href="#" name="grid_view" style="outline:0;">
              <img alt="Grid view" src="../shared_images/icon_grid_view_off.png"/>
             </a>
             <a href="https://www.dmsguild.com/browse.php?filters=45471_0_0_0_0_0&amp;page=1&amp;sort=4a#browselist" style="vertical-align: top; line-height: 19px; font-size: 11px">
              See all
             </a>
            </div>
            <script>
             $(document).ready(function() {
						$('.slider_switcher[elem_id="b565c59"]').on('click', 'a.switch_view_button', function(e) {
							e.preventDefault();

							var slider_id = $(this).parent().attr('elem_id');
							var view_type = $(this).attr('name');

							$(this).parent().find('img').each(function(){
								var src = $(this).attr('src');
								$(this).attr('src', src.replace('_on.png', '_off.png'));
							});
							var src = $(this).find('img').attr('src');
							$(this).find('img').attr('src', src.replace('_off.png', '_on.png'));

							if(typeof lazySliders !== 'undefined' && typeof lazySliders[slider_id] !== 'undefined'){
								lazySliders[slider_id].set_view_type(view_type);
								lazySliders[slider_id].update({item_from: 0});
							}
						}).find('a.switch_view_button[name="slider_view"]').find('img').each(function(){
							var src = $(this).attr('src');
							$(this).attr('src', src.replace('_off.png', '_on.png'));
						});
					});
            </script>
           </div>
           <table class="infoBox strip_content" id="b565c59" style="overflow:hidden;border:none;width:100%;border-spacing:0;">
            <tr>
             <td>
              <div class="owl-products-carousel owl-carousel" style="height: 200px;">
               <div class="loader_spinner" height="200px" style="margin-top: 10px; text-align: center">
                <img alt="Loading..." src="../shared_images/ajax-loader.gif" width="150px"/>
               </div>
              </div>
             </td>
            </tr>
           </table>
           <script>
            $(document).ready(function() {
					if(typeof lazySliders == 'undefined'){
						lazySliders = [];
					}
					$('#b565c59').appear(function(){
						var opts = {
							elem_id: 'b565c59',
							view_type: 'slider_view',
							api_url: '/api/products/list/newest_in_classics',
							
						};
						lazySliders['b565c59'] = lazySliderBox(opts);
						lazySliders['b565c59'].update();
					});
				});
           </script>
          </td>
         </tr>
         <tr>
          <td>
           <img alt="pixel_trans.gif" border="0" class="onestart" height="10" src="https://d1vzi28wh99zvq.cloudfront.net/images/pixel_trans.gif" width="100%"/>
          </td>
         </tr>
         <!-- theme_main_eof -->
         <!-- 2014-01-20 Chuck Childers: Move "New Products" link to new_products_frontpage_rpgnow.com. -->
         <!-- body_text_eof -->
        </table>
       </td>
      </tr>
     </table>
    </td>
   </tr>
   <!-- body_eof -->
   <tr>
    <td>
    </td>
    <td>
     <!-- banner -->
     <!-- banners //-->
     <!-- banners_eof //-->
    </td>
   </tr>
  </table>
  <!-- banner_eof -->
  <!-- footer -->
  <div class="grid" id="footer">
   <div class="grid_2 footer-logo alpha logowrapper">
    <div class="grid_12 alpha">
     <div class="footer-logo-site">
      <a href="../index.html">
       <img alt="Dungeon Masters Guild" border="0" class="onestart" src="https://www.dmsguild.com/themes/dmg/images/site-logo.png" width="100%"/>
      </a>
     </div>
     <div class="footer-logo-r20">
      <a href="https://roll20.net" target="_blank">
       <img alt="Powered By Roll20" border="0" class="onestart" src="https://www.dmsguild.com/shared_images/site_resources/PoweredByRoll20-Footer.png" width="100%"/>
      </a>
     </div>
    </div>
   </div>
   <div class="grid_4 linkswrapper">
    <div class="grid_3 alpha">
     <div class="widget-links-title">
      Need help?
     </div>
     <div class="widget-links-link">
      <a href="http://help.dmsguild.com/hc/en-us" target="_blank">
       Customer Questions (FAQ)
      </a>
     </div>
     <div class="widget-links-link">
      <a href="https://help.dmsguild.com/hc/en-us/categories/12776810252951-Content-Creator-Questions" target="_blank">
       DMsGuild Creator Questions?
      </a>
     </div>
     <div class="widget-links-link">
      <a href="https://docs.google.com/forms/d/e/1FAIpQLSc-vv6jtjp_wDGWNiDtkSpYzL_8KElEWEKtLQGuIpKIg0XG2Q/viewform?usp=pp_url&amp;entry.1569704748=Dungeon Masters Guild" target="_blank">
       Submit Suggestion
      </a>
      <img alt="Opens in new window" border="0" class="onestart" src="https://d1vzi28wh99zvq.cloudfront.net/images/icon_link.png"/>
      <br/>
     </div>
     <div>
      <div array="" class="cart-buttons" id="contact_us_button">
       <a href="../contact_us.php">
        <span class="site-button rounded-corners-button">
         <span class="rounded-corners-button-text" style="white-space:nowrap;">
          Contact us
         </span>
        </span>
       </a>
      </div>
      <br>
       <br/>
       <br/>
      </br>
     </div>
    </div>
    <div class="grid_4">
     <div class="widget-links-title">
      Account
     </div>
     <div class="widget-links-link">
      <a class="login_window" href="https://www.dmsguild.com/login.php">
       Login/Create Account
      </a>
     </div>
     <div class="widget-links-link">
      <a class="login_window" href="https://www.dmsguild.com/account.php" onclick="setRedirect('account.php');">
       Account
      </a>
     </div>
     <div class="widget-links-link">
      <a class="login_window" href="https://www.dmsguild.com/my_library.php" onclick="setRedirect('my_library.php');">
       My Library
      </a>
     </div>
     <div class="widget-links-link">
      <a class="login_window" href="https://www.dmsguild.com/affiliate_faq.php" onclick="setRedirect('affiliate_faq.php');">
       Affiliate System
      </a>
     </div>
     <div class="widget-links-link">
     </div>
     <div class="widget-links-link">
      <a href="https://help.dmsguild.com/hc/en-us/categories/12776810252951-Content-Creator-Questions">
       Create Content for Dungeons &amp; Dragons
      </a>
     </div>
    </div>
    <div class="grid_4 omega links-information">
     <div class="widget-links-title">
      Information
     </div>
     <div class="widget-links-link">
      <a href="https://help.drivethrurpg.com/hc/en-us/articles/12723265845783-About-Roll20" target="_blank">
       About Us
      </a>
     </div>
     <div class="widget-links-link">
      <a href="https://www.dmsguild.com/privacy.php">
       Privacy Policy
      </a>
     </div>
     <div class="widget-links-link">
      <a href="https://www.dmsguild.com/newsletter_current.php">
       Our Latest Newsletter
      </a>
     </div>
     <div class="widget-links-link">
      <a href="https://www.dmsguild.com/reviews.php">
       Product Reviews
      </a>
     </div>
     <div class="widget-links-link">
      <a href="https://www.dmsguild.com/rss.php">
       New Product RSS Feed
      </a>
     </div>
     <div class="widget-links-link">
      <a href="https://www.dmsguild.com/newsletter_rss_feed.php">
       Newsletter RSS Feed
      </a>
     </div>
     <div class="widget-links-link">
      <a href="https://www.dmsguild.com/bounty_policy.php">
       Bug Bounty Program
      </a>
     </div>
    </div>
   </div>
   <div class="grid_4 widget-currency omega">
    <div class="widget-currency-language">
     <select aria-label="Language Selector" class="widget-currency-language-dropdown" id="language" name="language" onchange="navigateTo(this)">
      <label>
       <option class="widget-currency-dropdown-option" selected="selected" value="en">
        English
       </option>
      </label>
      <label>
       <option class="widget-currency-dropdown-option" value="de">
        Deutsch
       </option>
      </label>
      <label>
       <option class="widget-currency-dropdown-option" value="es">
        Espaol
       </option>
      </label>
      <label>
       <option class="widget-currency-dropdown-option" value="fr">
        Franais
       </option>
      </label>
      <label>
       <option class="widget-currency-dropdown-option" value="it">
        Italiano
       </option>
      </label>
      <label>
       <option class="widget-currency-dropdown-option" value="pt">
        Portugus
       </option>
      </label>
      <label>
       <option class="widget-currency-dropdown-option" value="ru">
        Russian
       </option>
      </label>
      <label>
       <option class="widget-currency-dropdown-option" value="ja">
        
       </option>
      </label>
      <label>
       <option class="widget-currency-dropdown-option" value="ko">
        
       </option>
      </label>
      <label>
       <option class="widget-currency-dropdown-option" value="pl">
        Polski
       </option>
      </label>
     </select>
    </div>
    <div class="widget-currency-currency" style="width: 88px;">
     <style>
      #currency_title {width: 95px; }
     </style>
     <form action="index.php" method="get" name="currencies">
      <input name="affiliate_id" type="hidden" value="389627%3Futm_content%3Dzid-zid"/>
      <input name="site" type="hidden" value=""/>
      <select aria-label="Currency" class="widget-currency-currency-dropdown" id="currency" name="currency" onchange="this.form.submit();">
       <option class="widget-currency-dropdown-option" selected="selected" value="USD">
        US $
       </option>
       <option class="widget-currency-dropdown-option" value="EUR">
        
       </option>
       <option class="widget-currency-dropdown-option" value="CAD">
        Can$
       </option>
       <option class="widget-currency-dropdown-option" value="GBP">
        
       </option>
       <option class="widget-currency-dropdown-option" value="JPY">
        
       </option>
       <option class="widget-currency-dropdown-option" value="AUD">
        Au$
       </option>
      </select>
     </form>
    </div>
   </div>
   <div class="grid_12 alpha omega" style="text-align: center; padding-bottom: 8px;">
    <img alt="Accepted payment methods: PayPal, Visa, Mastercard, Discover, American Express" src="../shared_images/pmt_methods.png">
    </img>
   </div>
  </div>
  <div class="clear">
  </div>
  <script type="text/javascript">
   function destroyMobileVersionBanner () {
    var elem = document.getElementById('classic_version');
    elem.parentNode.removeChild(elem);
    
    document.getElementById('footer').classList.remove('banner');
    document.cookie = 'close_mobile_display=1;path='+obs.config.sitesettings.cookiePath+';domain='+obs.config.sitesettings.cookieDomain;
}

function switchToMobileVersion(e) {
    e.preventDefault();
    document.cookie = 'mobile_display=1;path='+obs.config.sitesettings.cookiePath+';domain='+obs.config.sitesettings.cookieDomain;
    
    var language = '&language=en';
    var url = '/' + language;
    
    var queryStringFragments = document.URL.split('/');
    
    if (queryStringFragments.indexOf('pub') != -1) {
        var publisherId = queryStringFragments[queryStringFragments.length - 2];
        
        url = '/m/browser/publisher/' + publisherId;
    }

    window.location.replace(url);
}

function navigateTo(sel) {
    var language = sel.options[sel.selectedIndex].value;
    
    window.location.href = 'index.php?affiliate_id=389627%3Futm_content%3Dzid-zid&site=&language='+ language;
    
}
addLoadEvent(function() {
    
    //$('#language').wrap('<form id="languages" name="languages" method="get" action="" />');
    
    //language and currency arrow activation
    try {
        $("#language").msDropDown({'visibleRows':12});
        $("#currency").msDropDown({'visibleRows':8});
    } catch(e) {
        alert(e.message);
    }
});

addLoadEvent(function() {});
  </script>
  <script src="../includes/javascript/suggestion.js" type="text/javascript">
  </script>
  <script type="text/javascript">
   // 2021-08-30 - OZ-2542 - MK
        function ajax_record_sales_analytics_event(data) {
            let url = '/includes/ajax/analytics.php?';
            $.each(data, function(index,value){
                url = url + index + '=' + value + '&';
            });
            //ajax call to record sales analytics event
            $.ajax({
                url: url
            });
        }

        // Because the date fields are initially hidden,
        // the picker can't be constructed until they are showing.
        // Therefore, the picker is attached to the onfocus event.
        function sdate_from_picker() {
            try {
                AnyTime.picker( "sdate_from", { format: "%Y-%m-%d"} );
            } catch (error) {
                // do nothing
            }
        }

        function sdate_to_picker() {
            try {
                AnyTime.picker( "sdate_to", { format: "%Y-%m-%d"} );
            } catch (error) {
                // do nothing
            }
        }

        // Because the time fields are initially hidden,
        // the picker can't be constructed until they are showing.
        // Therefore, the picker is attached to the onfocus event.
        function stime_from_picker() {
            try {
                // for ease of use, using whole hours in search
                AnyTime.picker( "stime_from", { format: "%l:00 %p"} );
            } catch (error) {
                // do nothing
            }
        }

        function stime_to_picker() {
            try {
                // for ease of use, using whole hours in search
                AnyTime.picker( "stime_to", { format: "%l:00 %p"} );
            } catch (error) {
                // do nothing
            }
        }

        function toggle_live_fields() {
            var has_is_live = document.getElementById('is_live');

            if (has_is_live) {
                var state = document.getElementById('is_live').checked;
                if (state) {
                    $('#live_products_section').slideDown('slow');
                } else {
                    $('#live_products_section').slideUp('slow');
                }
            }
        }

        function check_search_form() {
            var error_message = 'Please correct the following:\n\n';
            var error_found = false;
            var error_field;
            var keywords = document.sbf.keywords.value;
            var has_is_live = document.getElementById('is_live');

            var pfrom = document.sbf.pfrom.value;
            var pto = document.sbf.pto.value;
            var author = document.sbf.author.value;
            var pfrom_float;
            var pto_float;

            if (keywords == 'Search...') {
                document.sbf.keywords.value = '';
            }
            if (keywords == 'Search within results... ') {
                document.sbf.keywords.value = '';
            }

            if ((keywords == '' || keywords.length < 1)
                && (pfrom == '' || pfrom.length < 1)
                && (pto == '' || pto.length < 1)
                && (author == '' || author.length < 1)
                && (artist == '' || artist.length < 1)
                && (!has_is_live)) {

                error_message = error_message + '* At least one of the fields in the search form must be entered.\n';
                error_field = document.sbf.keywords;
                error_found = true;
            }

            if (pfrom.length > 0) {
                pfrom_float = parseFloat(pfrom);

                if (isNaN(pfrom_float)) {
                    error_message = error_message + '* Price "from" must be a number.\n';
                    error_field = document.sbf.pfrom;
                    error_found = true;
                }
            } else {
                pfrom_float = 0;
            }

            if (pto.length > 0) {
                pto_float = parseFloat(pto);

                if (isNaN(pto_float)) {
                    error_message = error_message + '* Price "to" must be a number.\n';
                    error_field = document.sbf.pto;
                    error_found = true;
                }
            } else {
                pto_float = 0;
            }

            if (pfrom.length > 0 && pto.length > 0
                && !isNaN(pfrom_float)
                && !isNaN(pto_float)
                && pto_float < pfrom_float) {

                error_message = error_message + '* Price "to" must be greater than or equal to price "from".\n';
                error_field = document.sbf.pto;
                error_found = true;
            }

            if (error_found == true) {
                alert(error_message);
                error_field.focus();
                return false;
            } else {
                return true;
            }
        }

        function focus_on_search_bar() {
            var search_bar_input = document.getElementById('search_bar');
            if (search_bar_input) {
                var value_filter = (search_bar_input.value != '' && search_bar_input.value != ' ');

                if (search_bar_input && search_bar_input.value != 'Search...' && search_bar_input.value != 'Search within results... ' && value_filter) {
                    search_bar_input.value = search_bar_input.value + ' ';
                    search_bar_input.focus();
                }
            }
        }

        var autocomplete;

        function onfocus_name() {
            var search = $('#search_bar');

            if (search.attr('value') == 'Search...') {
                search.css('color','black');
                search.attr('value','');
            }

            if (search.attr('value') == 'Search within results... ') {
                search.css('color','black');
                search.attr('value','');
            }

            var cache = {},lastXhr;
            var options = {
                source: function(request, response) {
                    var term = request.term;
                    if ( term in cache ) {
                        response( cache[ term ] );
                        return;
                    }
                    $.ajax({
                        url: "includes/ajax/search_autocomplete_jquery.php",
                        dataType: "json",
                        data: {
                            term : request.term,
                            filters : (($('#search_filter')) ? $('#search_filter').val() : ''),
                            manufacturers_id : (($('#search_manufacturer')) ? $('#search_manufacturer').val() : ''),
                            cPath : (($('#search_cPath')) ? $('#search_cPath').val() : '')
                        },
                        success: function(data) {
                            cache[ term ] = data;
                            response(data);
                        }
                    });
                },
                delay: 400,
                minLength: 3,
                html: 'html',
                focus: function(event,ui) {
                    $('#search_bar').val(ui.item.name);
                    return false;
                },
                select: function(event,ui) {
                    let event_tag = 'view-product-from-search';
                    ajax_record_sales_analytics_event({
                        origin: 'legacy',
                        event_tag: 'select-product-option',
                        page: '/index.php',

                    });

                    $('#search_bar').val(ui.item.name);
                    location.replace(ui.item.link);

                    return false;
                }
            };

            autocomplete = $('#search_bar').autocomplete(options);

            return true;
        }
        toggle_live_fields();//start the fields off toggled
        focus_on_search_bar();//move focus to the search bar

        $('.search_parameter').each(function() {
            $( this ).on('click',function() {
                var lnk = $( this ).children().children().attr('href');
                if (lnk) location.href = lnk;
            })
        });

        if (0) {
            // TODO: bblackmoor 2012-06-13: design a min-search form specifically for live products
            //$('#search_bar_advanced_controls').slideDown();
        }
  </script>
  
  <script type="text/javascript">
   obs.config = {
            sitesettings: {
                cookieDomain: "dmsguild.com",
                cookiePath: "\/"            },
            suggestions: {
                default: "How Can We Improve?",
                contactMe: "Can we respond to you about this?",
                submit: "Submit Suggestion",
                thanksNoHTML: "Thanks for helping us improve! Please note we check this suggestion box once a week.  If you need help with an order, use the Contact Us page.",
                submit: "Submit Suggestion",
                enterEmail: "Please enter an email address if you want us to contact you.",
                enterSomething: "Please enter a suggestion before clicking Submit."            },
            text: {
                optional: "(optional)",
                simpleRequired: "required"            }
    }
  </script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=37854911-1">
  </script>
  <script>
   window.dataLayer = window.dataLayer || [];
 function gtag(){ dataLayer.push(arguments); }
  gtag('js', new Date());

  gtag('config', 'UA-37854911-1');
    gtag('config', 'G-7T4PG0XBHN', {'groups': 'GA4'});
  window.ga4 = true;
    gtag('event', 'pageview', {
    send_to: 'UA-37854911-1'
  });
  </script>
  <!-- Google Tag Manager -->
  <!-- Commented out 2025-01-28 per Kenton/Chris
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NDMHLK5');</script>-->
  <!-- End Google Tag Manager -->
  <!-- Google Tag Manager (noscript) -->
  <noscript>
   <iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-TH8CJQV" style="display:none;visibility:hidden" width="0">
   </iframe>
  </noscript>
  <!-- End Google Tag Manager (noscript) -->
  <!-- footer_eof -->
  <br/>
  <script type="text/javascript">
   window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","licenseKey":"NRBR-a792f2982fda854fffd","applicationID":"700862248","transactionName":"ZgcGZEZWW0FSARJbVl9NMUJdGFxcVwceHElZEg==","queueTime":0,"applicationTime":136,"atts":"SkAFEg5MSE8=","errorBeacon":"bam.nr-data.net","agent":""}
  </script>
  <script>
   document.addEventListener('DOMContentLoaded', () => {
    const bookmarkBtn = document.createElement('button');
    bookmarkBtn.textContent = 'Bookmark this Page';
    bookmarkBtn.style.position = 'fixed';
    bookmarkBtn.style.bottom = '10px';
    bookmarkBtn.style.right = '10px';
    bookmarkBtn.style.zIndex = '9999';
    bookmarkBtn.style.padding = '10px';
    bookmarkBtn.style.backgroundColor = '#007bff';
    bookmarkBtn.style.color = 'white';
    bookmarkBtn.style.border = 'none';
    bookmarkBtn.style.borderRadius = '5px';
    bookmarkBtn.style.cursor = 'pointer';
    document.body.appendChild(bookmarkBtn);

    bookmarkBtn.addEventListener('click', () => {
        const pageTitle = document.title;
        const pageUrl = window.location.pathname;
        fetch('/api/add_bookmark', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ title: pageTitle, url: pageUrl }),
        })
        .then(response => response.json())
        .then(data => {
            if (data.status === 'success') {
                alert('Bookmark added!');
            } else {
                alert('Error: ' + (data.error || 'Could not add bookmark.'));
            }
        })
        .catch(error => {
            console.error('Error adding bookmark:', error);
            alert('Failed to add bookmark.');
        });
    });
});
  </script>
 </body>
</html>
